{"ast":null,"code":"var tns = function () {\n  var win = window;\n\n  var raf = win.requestAnimationFrame || win.webkitRequestAnimationFrame || win.mozRequestAnimationFrame || win.msRequestAnimationFrame || function (cb) {\n    return setTimeout(cb, 16);\n  };\n\n  var win$1 = window;\n\n  var caf = win$1.cancelAnimationFrame || win$1.mozCancelAnimationFrame || function (id) {\n    clearTimeout(id);\n  };\n\n  function extend() {\n    var obj,\n        name,\n        copy,\n        target = arguments[0] || {},\n        i = 1,\n        length = arguments.length;\n\n    for (; i < length; i++) {\n      if ((obj = arguments[i]) !== null) {\n        for (name in obj) {\n          copy = obj[name];\n\n          if (target === copy) {\n            continue;\n          } else if (copy !== undefined) {\n            target[name] = copy;\n          }\n        }\n      }\n    }\n\n    return target;\n  }\n\n  function checkStorageValue(value) {\n    return ['true', 'false'].indexOf(value) >= 0 ? JSON.parse(value) : value;\n  }\n\n  function setLocalStorage(storage, key, value, access) {\n    if (access) {\n      try {\n        storage.setItem(key, value);\n      } catch (e) {}\n    }\n\n    return value;\n  }\n\n  function getSlideId() {\n    var id = window.tnsId;\n    window.tnsId = !id ? 1 : id + 1;\n    return 'tns' + window.tnsId;\n  }\n\n  function getBody() {\n    var doc = document,\n        body = doc.body;\n\n    if (!body) {\n      body = doc.createElement('body');\n      body.fake = true;\n    }\n\n    return body;\n  }\n\n  var docElement = document.documentElement;\n\n  function setFakeBody(body) {\n    var docOverflow = '';\n\n    if (body.fake) {\n      docOverflow = docElement.style.overflow; //avoid crashing IE8, if background image is used\n\n      body.style.background = ''; //Safari 5.13/5.1.4 OSX stops loading if ::-webkit-scrollbar is used and scrollbars are visible\n\n      body.style.overflow = docElement.style.overflow = 'hidden';\n      docElement.appendChild(body);\n    }\n\n    return docOverflow;\n  }\n\n  function resetFakeBody(body, docOverflow) {\n    if (body.fake) {\n      body.remove();\n      docElement.style.overflow = docOverflow; // Trigger layout so kinetic scrolling isn't disabled in iOS6+\n      // eslint-disable-next-line\n\n      docElement.offsetHeight;\n    }\n  } // get css-calc \n\n\n  function calc() {\n    var doc = document,\n        body = getBody(),\n        docOverflow = setFakeBody(body),\n        div = doc.createElement('div'),\n        result = false;\n    body.appendChild(div);\n\n    try {\n      var str = '(10px * 10)',\n          vals = ['calc' + str, '-moz-calc' + str, '-webkit-calc' + str],\n          val;\n\n      for (var i = 0; i < 3; i++) {\n        val = vals[i];\n        div.style.width = val;\n\n        if (div.offsetWidth === 100) {\n          result = val.replace(str, '');\n          break;\n        }\n      }\n    } catch (e) {}\n\n    body.fake ? resetFakeBody(body, docOverflow) : div.remove();\n    return result;\n  } // get subpixel support value\n\n\n  function percentageLayout() {\n    // check subpixel layout supporting\n    var doc = document,\n        body = getBody(),\n        docOverflow = setFakeBody(body),\n        wrapper = doc.createElement('div'),\n        outer = doc.createElement('div'),\n        str = '',\n        count = 70,\n        perPage = 3,\n        supported = false;\n    wrapper.className = \"tns-t-subp2\";\n    outer.className = \"tns-t-ct\";\n\n    for (var i = 0; i < count; i++) {\n      str += '<div></div>';\n    }\n\n    outer.innerHTML = str;\n    wrapper.appendChild(outer);\n    body.appendChild(wrapper);\n    supported = Math.abs(wrapper.getBoundingClientRect().left - outer.children[count - perPage].getBoundingClientRect().left) < 2;\n    body.fake ? resetFakeBody(body, docOverflow) : wrapper.remove();\n    return supported;\n  }\n\n  function mediaquerySupport() {\n    if (window.matchMedia || window.msMatchMedia) {\n      return true;\n    }\n\n    var doc = document,\n        body = getBody(),\n        docOverflow = setFakeBody(body),\n        div = doc.createElement('div'),\n        style = doc.createElement('style'),\n        rule = '@media all and (min-width:1px){.tns-mq-test{position:absolute}}',\n        position;\n    style.type = 'text/css';\n    div.className = 'tns-mq-test';\n    body.appendChild(style);\n    body.appendChild(div);\n\n    if (style.styleSheet) {\n      style.styleSheet.cssText = rule;\n    } else {\n      style.appendChild(doc.createTextNode(rule));\n    }\n\n    position = window.getComputedStyle ? window.getComputedStyle(div).position : div.currentStyle['position'];\n    body.fake ? resetFakeBody(body, docOverflow) : div.remove();\n    return position === \"absolute\";\n  } // create and append style sheet\n\n\n  function createStyleSheet(media, nonce) {\n    // Create the <style> tag\n    var style = document.createElement(\"style\"); // style.setAttribute(\"type\", \"text/css\");\n    // Add a media (and/or media query) here if you'd like!\n    // style.setAttribute(\"media\", \"screen\")\n    // style.setAttribute(\"media\", \"only screen and (max-width : 1024px)\")\n\n    if (media) {\n      style.setAttribute(\"media\", media);\n    } // Add nonce attribute for Content Security Policy\n\n\n    if (nonce) {\n      style.setAttribute(\"nonce\", nonce);\n    } // WebKit hack :(\n    // style.appendChild(document.createTextNode(\"\"));\n    // Add the <style> element to the page\n\n\n    document.querySelector('head').appendChild(style);\n    return style.sheet ? style.sheet : style.styleSheet;\n  } // cross browsers addRule method\n\n\n  function addCSSRule(sheet, selector, rules, index) {\n    // return raf(function() {\n    'insertRule' in sheet ? sheet.insertRule(selector + '{' + rules + '}', index) : sheet.addRule(selector, rules, index); // });\n  } // cross browsers addRule method\n\n\n  function removeCSSRule(sheet, index) {\n    // return raf(function() {\n    'deleteRule' in sheet ? sheet.deleteRule(index) : sheet.removeRule(index); // });\n  }\n\n  function getCssRulesLength(sheet) {\n    var rule = 'insertRule' in sheet ? sheet.cssRules : sheet.rules;\n    return rule.length;\n  }\n\n  function toDegree(y, x) {\n    return Math.atan2(y, x) * (180 / Math.PI);\n  }\n\n  function getTouchDirection(angle, range) {\n    var direction = false,\n        gap = Math.abs(90 - Math.abs(angle));\n\n    if (gap >= 90 - range) {\n      direction = 'horizontal';\n    } else if (gap <= range) {\n      direction = 'vertical';\n    }\n\n    return direction;\n  } // https://toddmotto.com/ditch-the-array-foreach-call-nodelist-hack/\n\n\n  function forEach(arr, callback, scope) {\n    for (var i = 0, l = arr.length; i < l; i++) {\n      callback.call(scope, arr[i], i);\n    }\n  }\n\n  var classListSupport = ('classList' in document.createElement('_'));\n  var hasClass = classListSupport ? function (el, str) {\n    return el.classList.contains(str);\n  } : function (el, str) {\n    return el.className.indexOf(str) >= 0;\n  };\n  var addClass = classListSupport ? function (el, str) {\n    if (!hasClass(el, str)) {\n      el.classList.add(str);\n    }\n  } : function (el, str) {\n    if (!hasClass(el, str)) {\n      el.className += ' ' + str;\n    }\n  };\n  var removeClass = classListSupport ? function (el, str) {\n    if (hasClass(el, str)) {\n      el.classList.remove(str);\n    }\n  } : function (el, str) {\n    if (hasClass(el, str)) {\n      el.className = el.className.replace(str, '');\n    }\n  };\n\n  function hasAttr(el, attr) {\n    return el.hasAttribute(attr);\n  }\n\n  function getAttr(el, attr) {\n    return el.getAttribute(attr);\n  }\n\n  function isNodeList(el) {\n    // Only NodeList has the \"item()\" function\n    return typeof el.item !== \"undefined\";\n  }\n\n  function setAttrs(els, attrs) {\n    els = isNodeList(els) || els instanceof Array ? els : [els];\n\n    if (Object.prototype.toString.call(attrs) !== '[object Object]') {\n      return;\n    }\n\n    for (var i = els.length; i--;) {\n      for (var key in attrs) {\n        els[i].setAttribute(key, attrs[key]);\n      }\n    }\n  }\n\n  function removeAttrs(els, attrs) {\n    els = isNodeList(els) || els instanceof Array ? els : [els];\n    attrs = attrs instanceof Array ? attrs : [attrs];\n    var attrLength = attrs.length;\n\n    for (var i = els.length; i--;) {\n      for (var j = attrLength; j--;) {\n        els[i].removeAttribute(attrs[j]);\n      }\n    }\n  }\n\n  function arrayFromNodeList(nl) {\n    var arr = [];\n\n    for (var i = 0, l = nl.length; i < l; i++) {\n      arr.push(nl[i]);\n    }\n\n    return arr;\n  }\n\n  function hideElement(el, forceHide) {\n    if (el.style.display !== 'none') {\n      el.style.display = 'none';\n    }\n  }\n\n  function showElement(el, forceHide) {\n    if (el.style.display === 'none') {\n      el.style.display = '';\n    }\n  }\n\n  function isVisible(el) {\n    return window.getComputedStyle(el).display !== 'none';\n  }\n\n  function whichProperty(props) {\n    if (typeof props === 'string') {\n      var arr = [props],\n          Props = props.charAt(0).toUpperCase() + props.substr(1),\n          prefixes = ['Webkit', 'Moz', 'ms', 'O'];\n      prefixes.forEach(function (prefix) {\n        if (prefix !== 'ms' || props === 'transform') {\n          arr.push(prefix + Props);\n        }\n      });\n      props = arr;\n    }\n\n    var el = document.createElement('fakeelement'),\n        len = props.length;\n\n    for (var i = 0; i < props.length; i++) {\n      var prop = props[i];\n\n      if (el.style[prop] !== undefined) {\n        return prop;\n      }\n    }\n\n    return false; // explicit for ie9-\n  }\n\n  function has3DTransforms(tf) {\n    if (!tf) {\n      return false;\n    }\n\n    if (!window.getComputedStyle) {\n      return false;\n    }\n\n    var doc = document,\n        body = getBody(),\n        docOverflow = setFakeBody(body),\n        el = doc.createElement('p'),\n        has3d,\n        cssTF = tf.length > 9 ? '-' + tf.slice(0, -9).toLowerCase() + '-' : '';\n    cssTF += 'transform'; // Add it to the body to get the computed style\n\n    body.insertBefore(el, null);\n    el.style[tf] = 'translate3d(1px,1px,1px)';\n    has3d = window.getComputedStyle(el).getPropertyValue(cssTF);\n    body.fake ? resetFakeBody(body, docOverflow) : el.remove();\n    return has3d !== undefined && has3d.length > 0 && has3d !== \"none\";\n  } // get transitionend, animationend based on transitionDuration\n  // @propin: string\n  // @propOut: string, first-letter uppercase\n  // Usage: getEndProperty('WebkitTransitionDuration', 'Transition') => webkitTransitionEnd\n\n\n  function getEndProperty(propIn, propOut) {\n    var endProp = false;\n\n    if (/^Webkit/.test(propIn)) {\n      endProp = 'webkit' + propOut + 'End';\n    } else if (/^O/.test(propIn)) {\n      endProp = 'o' + propOut + 'End';\n    } else if (propIn) {\n      endProp = propOut.toLowerCase() + 'end';\n    }\n\n    return endProp;\n  } // Test via a getter in the options object to see if the passive property is accessed\n\n\n  var supportsPassive = false;\n\n  try {\n    var opts = Object.defineProperty({}, 'passive', {\n      get: function () {\n        supportsPassive = true;\n      }\n    });\n    window.addEventListener(\"test\", null, opts);\n  } catch (e) {}\n\n  var passiveOption = supportsPassive ? {\n    passive: true\n  } : false;\n\n  function addEvents(el, obj, preventScrolling) {\n    for (var prop in obj) {\n      var option = ['touchstart', 'touchmove'].indexOf(prop) >= 0 && !preventScrolling ? passiveOption : false;\n      el.addEventListener(prop, obj[prop], option);\n    }\n  }\n\n  function removeEvents(el, obj) {\n    for (var prop in obj) {\n      var option = ['touchstart', 'touchmove'].indexOf(prop) >= 0 ? passiveOption : false;\n      el.removeEventListener(prop, obj[prop], option);\n    }\n  }\n\n  function Events() {\n    return {\n      topics: {},\n      on: function (eventName, fn) {\n        this.topics[eventName] = this.topics[eventName] || [];\n        this.topics[eventName].push(fn);\n      },\n      off: function (eventName, fn) {\n        if (this.topics[eventName]) {\n          for (var i = 0; i < this.topics[eventName].length; i++) {\n            if (this.topics[eventName][i] === fn) {\n              this.topics[eventName].splice(i, 1);\n              break;\n            }\n          }\n        }\n      },\n      emit: function (eventName, data) {\n        data.type = eventName;\n\n        if (this.topics[eventName]) {\n          this.topics[eventName].forEach(function (fn) {\n            fn(data, eventName);\n          });\n        }\n      }\n    };\n  }\n\n  function jsTransform(element, attr, prefix, postfix, to, duration, callback) {\n    var tick = Math.min(duration, 10),\n        unit = to.indexOf('%') >= 0 ? '%' : 'px',\n        to = to.replace(unit, ''),\n        from = Number(element.style[attr].replace(prefix, '').replace(postfix, '').replace(unit, '')),\n        positionTick = (to - from) / duration * tick,\n        running;\n    setTimeout(moveElement, tick);\n\n    function moveElement() {\n      duration -= tick;\n      from += positionTick;\n      element.style[attr] = prefix + from + unit + postfix;\n\n      if (duration > 0) {\n        setTimeout(moveElement, tick);\n      } else {\n        callback();\n      }\n    }\n  } // Object.keys\n\n\n  if (!Object.keys) {\n    Object.keys = function (object) {\n      var keys = [];\n\n      for (var name in object) {\n        if (Object.prototype.hasOwnProperty.call(object, name)) {\n          keys.push(name);\n        }\n      }\n\n      return keys;\n    };\n  } // ChildNode.remove\n\n\n  if (!(\"remove\" in Element.prototype)) {\n    Element.prototype.remove = function () {\n      if (this.parentNode) {\n        this.parentNode.removeChild(this);\n      }\n    };\n  }\n\n  var tns = function (options) {\n    options = extend({\n      container: '.slider',\n      mode: 'carousel',\n      axis: 'horizontal',\n      items: 1,\n      gutter: 0,\n      edgePadding: 0,\n      fixedWidth: false,\n      autoWidth: false,\n      viewportMax: false,\n      slideBy: 1,\n      center: false,\n      controls: true,\n      controlsPosition: 'top',\n      controlsText: ['prev', 'next'],\n      controlsContainer: false,\n      prevButton: false,\n      nextButton: false,\n      nav: true,\n      navPosition: 'top',\n      navContainer: false,\n      navAsThumbnails: false,\n      arrowKeys: false,\n      speed: 300,\n      autoplay: false,\n      autoplayPosition: 'top',\n      autoplayTimeout: 5000,\n      autoplayDirection: 'forward',\n      autoplayText: ['start', 'stop'],\n      autoplayHoverPause: false,\n      autoplayButton: false,\n      autoplayButtonOutput: true,\n      autoplayResetOnVisibility: true,\n      animateIn: 'tns-fadeIn',\n      animateOut: 'tns-fadeOut',\n      animateNormal: 'tns-normal',\n      animateDelay: false,\n      loop: true,\n      rewind: false,\n      autoHeight: false,\n      responsive: false,\n      lazyload: false,\n      lazyloadSelector: '.tns-lazy-img',\n      touch: true,\n      mouseDrag: false,\n      swipeAngle: 15,\n      nested: false,\n      preventActionWhenRunning: false,\n      preventScrollOnTouch: false,\n      freezable: true,\n      onInit: false,\n      useLocalStorage: true,\n      nonce: false\n    }, options || {});\n    var doc = document,\n        win = window,\n        KEYS = {\n      ENTER: 13,\n      SPACE: 32,\n      LEFT: 37,\n      RIGHT: 39\n    },\n        tnsStorage = {},\n        localStorageAccess = options.useLocalStorage;\n\n    if (localStorageAccess) {\n      // check browser version and local storage access\n      var browserInfo = navigator.userAgent;\n      var uid = new Date();\n\n      try {\n        tnsStorage = win.localStorage;\n\n        if (tnsStorage) {\n          tnsStorage.setItem(uid, uid);\n          localStorageAccess = tnsStorage.getItem(uid) == uid;\n          tnsStorage.removeItem(uid);\n        } else {\n          localStorageAccess = false;\n        }\n\n        if (!localStorageAccess) {\n          tnsStorage = {};\n        }\n      } catch (e) {\n        localStorageAccess = false;\n      }\n\n      if (localStorageAccess) {\n        // remove storage when browser version changes\n        if (tnsStorage['tnsApp'] && tnsStorage['tnsApp'] !== browserInfo) {\n          ['tC', 'tPL', 'tMQ', 'tTf', 't3D', 'tTDu', 'tTDe', 'tADu', 'tADe', 'tTE', 'tAE'].forEach(function (item) {\n            tnsStorage.removeItem(item);\n          });\n        } // update browserInfo\n\n\n        localStorage['tnsApp'] = browserInfo;\n      }\n    }\n\n    var CALC = tnsStorage['tC'] ? checkStorageValue(tnsStorage['tC']) : setLocalStorage(tnsStorage, 'tC', calc(), localStorageAccess),\n        PERCENTAGELAYOUT = tnsStorage['tPL'] ? checkStorageValue(tnsStorage['tPL']) : setLocalStorage(tnsStorage, 'tPL', percentageLayout(), localStorageAccess),\n        CSSMQ = tnsStorage['tMQ'] ? checkStorageValue(tnsStorage['tMQ']) : setLocalStorage(tnsStorage, 'tMQ', mediaquerySupport(), localStorageAccess),\n        TRANSFORM = tnsStorage['tTf'] ? checkStorageValue(tnsStorage['tTf']) : setLocalStorage(tnsStorage, 'tTf', whichProperty('transform'), localStorageAccess),\n        HAS3DTRANSFORMS = tnsStorage['t3D'] ? checkStorageValue(tnsStorage['t3D']) : setLocalStorage(tnsStorage, 't3D', has3DTransforms(TRANSFORM), localStorageAccess),\n        TRANSITIONDURATION = tnsStorage['tTDu'] ? checkStorageValue(tnsStorage['tTDu']) : setLocalStorage(tnsStorage, 'tTDu', whichProperty('transitionDuration'), localStorageAccess),\n        TRANSITIONDELAY = tnsStorage['tTDe'] ? checkStorageValue(tnsStorage['tTDe']) : setLocalStorage(tnsStorage, 'tTDe', whichProperty('transitionDelay'), localStorageAccess),\n        ANIMATIONDURATION = tnsStorage['tADu'] ? checkStorageValue(tnsStorage['tADu']) : setLocalStorage(tnsStorage, 'tADu', whichProperty('animationDuration'), localStorageAccess),\n        ANIMATIONDELAY = tnsStorage['tADe'] ? checkStorageValue(tnsStorage['tADe']) : setLocalStorage(tnsStorage, 'tADe', whichProperty('animationDelay'), localStorageAccess),\n        TRANSITIONEND = tnsStorage['tTE'] ? checkStorageValue(tnsStorage['tTE']) : setLocalStorage(tnsStorage, 'tTE', getEndProperty(TRANSITIONDURATION, 'Transition'), localStorageAccess),\n        ANIMATIONEND = tnsStorage['tAE'] ? checkStorageValue(tnsStorage['tAE']) : setLocalStorage(tnsStorage, 'tAE', getEndProperty(ANIMATIONDURATION, 'Animation'), localStorageAccess); // get element nodes from selectors\n\n    var supportConsoleWarn = win.console && typeof win.console.warn === \"function\",\n        tnsList = ['container', 'controlsContainer', 'prevButton', 'nextButton', 'navContainer', 'autoplayButton'],\n        optionsElements = {};\n    tnsList.forEach(function (item) {\n      if (typeof options[item] === 'string') {\n        var str = options[item],\n            el = doc.querySelector(str);\n        optionsElements[item] = str;\n\n        if (el && el.nodeName) {\n          options[item] = el;\n        } else {\n          if (supportConsoleWarn) {\n            console.warn('Can\\'t find', options[item]);\n          }\n\n          return;\n        }\n      }\n    }); // make sure at least 1 slide\n\n    if (options.container.children.length < 1) {\n      if (supportConsoleWarn) {\n        console.warn('No slides found in', options.container);\n      }\n\n      return;\n    } // update options\n\n\n    var responsive = options.responsive,\n        nested = options.nested,\n        carousel = options.mode === 'carousel' ? true : false;\n\n    if (responsive) {\n      // apply responsive[0] to options and remove it\n      if (0 in responsive) {\n        options = extend(options, responsive[0]);\n        delete responsive[0];\n      }\n\n      var responsiveTem = {};\n\n      for (var key in responsive) {\n        var val = responsive[key]; // update responsive\n        // from: 300: 2\n        // to:\n        //   300: {\n        //     items: 2\n        //   }\n\n        val = typeof val === 'number' ? {\n          items: val\n        } : val;\n        responsiveTem[key] = val;\n      }\n\n      responsive = responsiveTem;\n      responsiveTem = null;\n    } // update options\n\n\n    function updateOptions(obj) {\n      for (var key in obj) {\n        if (!carousel) {\n          if (key === 'slideBy') {\n            obj[key] = 'page';\n          }\n\n          if (key === 'edgePadding') {\n            obj[key] = false;\n          }\n\n          if (key === 'autoHeight') {\n            obj[key] = false;\n          }\n        } // update responsive options\n\n\n        if (key === 'responsive') {\n          updateOptions(obj[key]);\n        }\n      }\n    }\n\n    if (!carousel) {\n      updateOptions(options);\n    } // === define and set variables ===\n\n\n    if (!carousel) {\n      options.axis = 'horizontal';\n      options.slideBy = 'page';\n      options.edgePadding = false;\n      var animateIn = options.animateIn,\n          animateOut = options.animateOut,\n          animateDelay = options.animateDelay,\n          animateNormal = options.animateNormal;\n    }\n\n    var horizontal = options.axis === 'horizontal' ? true : false,\n        outerWrapper = doc.createElement('div'),\n        innerWrapper = doc.createElement('div'),\n        middleWrapper,\n        container = options.container,\n        containerParent = container.parentNode,\n        containerHTML = container.outerHTML,\n        slideItems = container.children,\n        slideCount = slideItems.length,\n        breakpointZone,\n        windowWidth = getWindowWidth(),\n        isOn = false;\n\n    if (responsive) {\n      setBreakpointZone();\n    }\n\n    if (carousel) {\n      container.className += ' tns-vpfix';\n    } // fixedWidth: viewport > rightBoundary > indexMax\n\n\n    var autoWidth = options.autoWidth,\n        fixedWidth = getOption('fixedWidth'),\n        edgePadding = getOption('edgePadding'),\n        gutter = getOption('gutter'),\n        viewport = getViewportWidth(),\n        center = getOption('center'),\n        items = !autoWidth ? Math.floor(getOption('items')) : 1,\n        slideBy = getOption('slideBy'),\n        viewportMax = options.viewportMax || options.fixedWidthViewportWidth,\n        arrowKeys = getOption('arrowKeys'),\n        speed = getOption('speed'),\n        rewind = options.rewind,\n        loop = rewind ? false : options.loop,\n        autoHeight = getOption('autoHeight'),\n        controls = getOption('controls'),\n        controlsText = getOption('controlsText'),\n        nav = getOption('nav'),\n        touch = getOption('touch'),\n        mouseDrag = getOption('mouseDrag'),\n        autoplay = getOption('autoplay'),\n        autoplayTimeout = getOption('autoplayTimeout'),\n        autoplayText = getOption('autoplayText'),\n        autoplayHoverPause = getOption('autoplayHoverPause'),\n        autoplayResetOnVisibility = getOption('autoplayResetOnVisibility'),\n        sheet = createStyleSheet(null, getOption('nonce')),\n        lazyload = options.lazyload,\n        lazyloadSelector = options.lazyloadSelector,\n        slidePositions,\n        // collection of slide positions\n    slideItemsOut = [],\n        cloneCount = loop ? getCloneCountForLoop() : 0,\n        slideCountNew = !carousel ? slideCount + cloneCount : slideCount + cloneCount * 2,\n        hasRightDeadZone = (fixedWidth || autoWidth) && !loop ? true : false,\n        rightBoundary = fixedWidth ? getRightBoundary() : null,\n        updateIndexBeforeTransform = !carousel || !loop ? true : false,\n        // transform\n    transformAttr = horizontal ? 'left' : 'top',\n        transformPrefix = '',\n        transformPostfix = '',\n        // index\n    getIndexMax = function () {\n      if (fixedWidth) {\n        return function () {\n          return center && !loop ? slideCount - 1 : Math.ceil(-rightBoundary / (fixedWidth + gutter));\n        };\n      } else if (autoWidth) {\n        return function () {\n          for (var i = 0; i < slideCountNew; i++) {\n            if (slidePositions[i] >= -rightBoundary) {\n              return i;\n            }\n          }\n        };\n      } else {\n        return function () {\n          if (center && carousel && !loop) {\n            return slideCount - 1;\n          } else {\n            return loop || carousel ? Math.max(0, slideCountNew - Math.ceil(items)) : slideCountNew - 1;\n          }\n        };\n      }\n    }(),\n        index = getStartIndex(getOption('startIndex')),\n        indexCached = index,\n        displayIndex = getCurrentSlide(),\n        indexMin = 0,\n        indexMax = !autoWidth ? getIndexMax() : null,\n        // resize\n    resizeTimer,\n        preventActionWhenRunning = options.preventActionWhenRunning,\n        swipeAngle = options.swipeAngle,\n        moveDirectionExpected = swipeAngle ? '?' : true,\n        running = false,\n        onInit = options.onInit,\n        events = new Events(),\n        // id, class\n    newContainerClasses = ' tns-slider tns-' + options.mode,\n        slideId = container.id || getSlideId(),\n        disable = getOption('disable'),\n        disabled = false,\n        freezable = options.freezable,\n        freeze = freezable && !autoWidth ? getFreeze() : false,\n        frozen = false,\n        controlsEvents = {\n      'click': onControlsClick,\n      'keydown': onControlsKeydown\n    },\n        navEvents = {\n      'click': onNavClick,\n      'keydown': onNavKeydown\n    },\n        hoverEvents = {\n      'mouseover': mouseoverPause,\n      'mouseout': mouseoutRestart\n    },\n        visibilityEvent = {\n      'visibilitychange': onVisibilityChange\n    },\n        docmentKeydownEvent = {\n      'keydown': onDocumentKeydown\n    },\n        touchEvents = {\n      'touchstart': onPanStart,\n      'touchmove': onPanMove,\n      'touchend': onPanEnd,\n      'touchcancel': onPanEnd\n    },\n        dragEvents = {\n      'mousedown': onPanStart,\n      'mousemove': onPanMove,\n      'mouseup': onPanEnd,\n      'mouseleave': onPanEnd\n    },\n        hasControls = hasOption('controls'),\n        hasNav = hasOption('nav'),\n        navAsThumbnails = autoWidth ? true : options.navAsThumbnails,\n        hasAutoplay = hasOption('autoplay'),\n        hasTouch = hasOption('touch'),\n        hasMouseDrag = hasOption('mouseDrag'),\n        slideActiveClass = 'tns-slide-active',\n        slideClonedClass = 'tns-slide-cloned',\n        imgCompleteClass = 'tns-complete',\n        imgEvents = {\n      'load': onImgLoaded,\n      'error': onImgFailed\n    },\n        imgsComplete,\n        liveregionCurrent,\n        preventScroll = options.preventScrollOnTouch === 'force' ? true : false; // controls\n\n\n    if (hasControls) {\n      var controlsContainer = options.controlsContainer,\n          controlsContainerHTML = options.controlsContainer ? options.controlsContainer.outerHTML : '',\n          prevButton = options.prevButton,\n          nextButton = options.nextButton,\n          prevButtonHTML = options.prevButton ? options.prevButton.outerHTML : '',\n          nextButtonHTML = options.nextButton ? options.nextButton.outerHTML : '',\n          prevIsButton,\n          nextIsButton;\n    } // nav\n\n\n    if (hasNav) {\n      var navContainer = options.navContainer,\n          navContainerHTML = options.navContainer ? options.navContainer.outerHTML : '',\n          navItems,\n          pages = autoWidth ? slideCount : getPages(),\n          pagesCached = 0,\n          navClicked = -1,\n          navCurrentIndex = getCurrentNavIndex(),\n          navCurrentIndexCached = navCurrentIndex,\n          navActiveClass = 'tns-nav-active',\n          navStr = 'Carousel Page ',\n          navStrCurrent = ' (Current Slide)';\n    } // autoplay\n\n\n    if (hasAutoplay) {\n      var autoplayDirection = options.autoplayDirection === 'forward' ? 1 : -1,\n          autoplayButton = options.autoplayButton,\n          autoplayButtonHTML = options.autoplayButton ? options.autoplayButton.outerHTML : '',\n          autoplayHtmlStrings = ['<span class=\\'tns-visually-hidden\\'>', ' animation</span>'],\n          autoplayTimer,\n          animating,\n          autoplayHoverPaused,\n          autoplayUserPaused,\n          autoplayVisibilityPaused;\n    }\n\n    if (hasTouch || hasMouseDrag) {\n      var initPosition = {},\n          lastPosition = {},\n          translateInit,\n          disX,\n          disY,\n          panStart = false,\n          rafIndex,\n          getDist = horizontal ? function (a, b) {\n        return a.x - b.x;\n      } : function (a, b) {\n        return a.y - b.y;\n      };\n    } // disable slider when slidecount <= items\n\n\n    if (!autoWidth) {\n      resetVariblesWhenDisable(disable || freeze);\n    }\n\n    if (TRANSFORM) {\n      transformAttr = TRANSFORM;\n      transformPrefix = 'translate';\n\n      if (HAS3DTRANSFORMS) {\n        transformPrefix += horizontal ? '3d(' : '3d(0px, ';\n        transformPostfix = horizontal ? ', 0px, 0px)' : ', 0px)';\n      } else {\n        transformPrefix += horizontal ? 'X(' : 'Y(';\n        transformPostfix = ')';\n      }\n    }\n\n    if (carousel) {\n      container.className = container.className.replace('tns-vpfix', '');\n    }\n\n    initStructure();\n    initSheet();\n    initSliderTransform(); // === COMMON FUNCTIONS === //\n\n    function resetVariblesWhenDisable(condition) {\n      if (condition) {\n        controls = nav = touch = mouseDrag = arrowKeys = autoplay = autoplayHoverPause = autoplayResetOnVisibility = false;\n      }\n    }\n\n    function getCurrentSlide() {\n      var tem = carousel ? index - cloneCount : index;\n\n      while (tem < 0) {\n        tem += slideCount;\n      }\n\n      return tem % slideCount + 1;\n    }\n\n    function getStartIndex(ind) {\n      ind = ind ? Math.max(0, Math.min(loop ? slideCount - 1 : slideCount - items, ind)) : 0;\n      return carousel ? ind + cloneCount : ind;\n    }\n\n    function getAbsIndex(i) {\n      if (i == null) {\n        i = index;\n      }\n\n      if (carousel) {\n        i -= cloneCount;\n      }\n\n      while (i < 0) {\n        i += slideCount;\n      }\n\n      return Math.floor(i % slideCount);\n    }\n\n    function getCurrentNavIndex() {\n      var absIndex = getAbsIndex(),\n          result;\n      result = navAsThumbnails ? absIndex : fixedWidth || autoWidth ? Math.ceil((absIndex + 1) * pages / slideCount - 1) : Math.floor(absIndex / items); // set active nav to the last one when reaches the right edge\n\n      if (!loop && carousel && index === indexMax) {\n        result = pages - 1;\n      }\n\n      return result;\n    }\n\n    function getItemsMax() {\n      // fixedWidth or autoWidth while viewportMax is not available\n      if (autoWidth || fixedWidth && !viewportMax) {\n        return slideCount - 1; // most cases\n      } else {\n        var str = fixedWidth ? 'fixedWidth' : 'items',\n            arr = [];\n\n        if (fixedWidth || options[str] < slideCount) {\n          arr.push(options[str]);\n        }\n\n        if (responsive) {\n          for (var bp in responsive) {\n            var tem = responsive[bp][str];\n\n            if (tem && (fixedWidth || tem < slideCount)) {\n              arr.push(tem);\n            }\n          }\n        }\n\n        if (!arr.length) {\n          arr.push(0);\n        }\n\n        return Math.ceil(fixedWidth ? viewportMax / Math.min.apply(null, arr) : Math.max.apply(null, arr));\n      }\n    }\n\n    function getCloneCountForLoop() {\n      var itemsMax = getItemsMax(),\n          result = carousel ? Math.ceil((itemsMax * 5 - slideCount) / 2) : itemsMax * 4 - slideCount;\n      result = Math.max(itemsMax, result);\n      return hasOption('edgePadding') ? result + 1 : result;\n    }\n\n    function getWindowWidth() {\n      return win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;\n    }\n\n    function getInsertPosition(pos) {\n      return pos === 'top' ? 'afterbegin' : 'beforeend';\n    }\n\n    function getClientWidth(el) {\n      if (el == null) {\n        return;\n      }\n\n      var div = doc.createElement('div'),\n          rect,\n          width;\n      el.appendChild(div);\n      rect = div.getBoundingClientRect();\n      width = rect.right - rect.left;\n      div.remove();\n      return width || getClientWidth(el.parentNode);\n    }\n\n    function getViewportWidth() {\n      var gap = edgePadding ? edgePadding * 2 - gutter : 0;\n      return getClientWidth(containerParent) - gap;\n    }\n\n    function hasOption(item) {\n      if (options[item]) {\n        return true;\n      } else {\n        if (responsive) {\n          for (var bp in responsive) {\n            if (responsive[bp][item]) {\n              return true;\n            }\n          }\n        }\n\n        return false;\n      }\n    } // get option:\n    // fixed width: viewport, fixedWidth, gutter => items\n    // others: window width => all variables\n    // all: items => slideBy\n\n\n    function getOption(item, ww) {\n      if (ww == null) {\n        ww = windowWidth;\n      }\n\n      if (item === 'items' && fixedWidth) {\n        return Math.floor((viewport + gutter) / (fixedWidth + gutter)) || 1;\n      } else {\n        var result = options[item];\n\n        if (responsive) {\n          for (var bp in responsive) {\n            // bp: convert string to number\n            if (ww >= parseInt(bp)) {\n              if (item in responsive[bp]) {\n                result = responsive[bp][item];\n              }\n            }\n          }\n        }\n\n        if (item === 'slideBy' && result === 'page') {\n          result = getOption('items');\n        }\n\n        if (!carousel && (item === 'slideBy' || item === 'items')) {\n          result = Math.floor(result);\n        }\n\n        return result;\n      }\n    }\n\n    function getSlideMarginLeft(i) {\n      return CALC ? CALC + '(' + i * 100 + '% / ' + slideCountNew + ')' : i * 100 / slideCountNew + '%';\n    }\n\n    function getInnerWrapperStyles(edgePaddingTem, gutterTem, fixedWidthTem, speedTem, autoHeightBP) {\n      var str = '';\n\n      if (edgePaddingTem !== undefined) {\n        var gap = edgePaddingTem;\n\n        if (gutterTem) {\n          gap -= gutterTem;\n        }\n\n        str = horizontal ? 'margin: 0 ' + gap + 'px 0 ' + edgePaddingTem + 'px;' : 'margin: ' + edgePaddingTem + 'px 0 ' + gap + 'px 0;';\n      } else if (gutterTem && !fixedWidthTem) {\n        var gutterTemUnit = '-' + gutterTem + 'px',\n            dir = horizontal ? gutterTemUnit + ' 0 0' : '0 ' + gutterTemUnit + ' 0';\n        str = 'margin: 0 ' + dir + ';';\n      }\n\n      if (!carousel && autoHeightBP && TRANSITIONDURATION && speedTem) {\n        str += getTransitionDurationStyle(speedTem);\n      }\n\n      return str;\n    }\n\n    function getContainerWidth(fixedWidthTem, gutterTem, itemsTem) {\n      if (fixedWidthTem) {\n        return (fixedWidthTem + gutterTem) * slideCountNew + 'px';\n      } else {\n        return CALC ? CALC + '(' + slideCountNew * 100 + '% / ' + itemsTem + ')' : slideCountNew * 100 / itemsTem + '%';\n      }\n    }\n\n    function getSlideWidthStyle(fixedWidthTem, gutterTem, itemsTem) {\n      var width;\n\n      if (fixedWidthTem) {\n        width = fixedWidthTem + gutterTem + 'px';\n      } else {\n        if (!carousel) {\n          itemsTem = Math.floor(itemsTem);\n        }\n\n        var dividend = carousel ? slideCountNew : itemsTem;\n        width = CALC ? CALC + '(100% / ' + dividend + ')' : 100 / dividend + '%';\n      }\n\n      width = 'width:' + width; // inner slider: overwrite outer slider styles\n\n      return nested !== 'inner' ? width + ';' : width + ' !important;';\n    }\n\n    function getSlideGutterStyle(gutterTem) {\n      var str = ''; // gutter maybe interger || 0\n      // so can't use 'if (gutter)'\n\n      if (gutterTem !== false) {\n        var prop = horizontal ? 'padding-' : 'margin-',\n            dir = horizontal ? 'right' : 'bottom';\n        str = prop + dir + ': ' + gutterTem + 'px;';\n      }\n\n      return str;\n    }\n\n    function getCSSPrefix(name, num) {\n      var prefix = name.substring(0, name.length - num).toLowerCase();\n\n      if (prefix) {\n        prefix = '-' + prefix + '-';\n      }\n\n      return prefix;\n    }\n\n    function getTransitionDurationStyle(speed) {\n      return getCSSPrefix(TRANSITIONDURATION, 18) + 'transition-duration:' + speed / 1000 + 's;';\n    }\n\n    function getAnimationDurationStyle(speed) {\n      return getCSSPrefix(ANIMATIONDURATION, 17) + 'animation-duration:' + speed / 1000 + 's;';\n    }\n\n    function initStructure() {\n      var classOuter = 'tns-outer',\n          classInner = 'tns-inner',\n          hasGutter = hasOption('gutter');\n      outerWrapper.className = classOuter;\n      innerWrapper.className = classInner;\n      outerWrapper.id = slideId + '-ow';\n      innerWrapper.id = slideId + '-iw'; // set container properties\n\n      if (container.id === '') {\n        container.id = slideId;\n      }\n\n      newContainerClasses += PERCENTAGELAYOUT || autoWidth ? ' tns-subpixel' : ' tns-no-subpixel';\n      newContainerClasses += CALC ? ' tns-calc' : ' tns-no-calc';\n\n      if (autoWidth) {\n        newContainerClasses += ' tns-autowidth';\n      }\n\n      newContainerClasses += ' tns-' + options.axis;\n      container.className += newContainerClasses; // add constrain layer for carousel\n\n      if (carousel) {\n        middleWrapper = doc.createElement('div');\n        middleWrapper.id = slideId + '-mw';\n        middleWrapper.className = 'tns-ovh';\n        outerWrapper.appendChild(middleWrapper);\n        middleWrapper.appendChild(innerWrapper);\n      } else {\n        outerWrapper.appendChild(innerWrapper);\n      }\n\n      if (autoHeight) {\n        var wp = middleWrapper ? middleWrapper : innerWrapper;\n        wp.className += ' tns-ah';\n      }\n\n      containerParent.insertBefore(outerWrapper, container);\n      innerWrapper.appendChild(container); // add id, class, aria attributes\n      // before clone slides\n\n      forEach(slideItems, function (item, i) {\n        addClass(item, 'tns-item');\n\n        if (!item.id) {\n          item.id = slideId + '-item' + i;\n        }\n\n        if (!carousel && animateNormal) {\n          addClass(item, animateNormal);\n        }\n\n        setAttrs(item, {\n          'aria-hidden': 'true',\n          'tabindex': '-1'\n        });\n      }); // ## clone slides\n      // carousel: n + slides + n\n      // gallery:      slides + n\n\n      if (cloneCount) {\n        var fragmentBefore = doc.createDocumentFragment(),\n            fragmentAfter = doc.createDocumentFragment();\n\n        for (var j = cloneCount; j--;) {\n          var num = j % slideCount,\n              cloneFirst = slideItems[num].cloneNode(true);\n          addClass(cloneFirst, slideClonedClass);\n          removeAttrs(cloneFirst, 'id');\n          fragmentAfter.insertBefore(cloneFirst, fragmentAfter.firstChild);\n\n          if (carousel) {\n            var cloneLast = slideItems[slideCount - 1 - num].cloneNode(true);\n            addClass(cloneLast, slideClonedClass);\n            removeAttrs(cloneLast, 'id');\n            fragmentBefore.appendChild(cloneLast);\n          }\n        }\n\n        container.insertBefore(fragmentBefore, container.firstChild);\n        container.appendChild(fragmentAfter);\n        slideItems = container.children;\n      }\n    }\n\n    function initSliderTransform() {\n      // ## images loaded/failed\n      if (hasOption('autoHeight') || autoWidth || !horizontal) {\n        var imgs = container.querySelectorAll('img'); // add img load event listener\n\n        forEach(imgs, function (img) {\n          var src = img.src;\n\n          if (!lazyload) {\n            // not data img\n            if (src && src.indexOf('data:image') < 0) {\n              img.src = '';\n              addEvents(img, imgEvents);\n              addClass(img, 'loading');\n              img.src = src; // data img\n            } else {\n              imgLoaded(img);\n            }\n          }\n        }); // set imgsComplete\n\n        raf(function () {\n          imgsLoadedCheck(arrayFromNodeList(imgs), function () {\n            imgsComplete = true;\n          });\n        }); // reset imgs for auto height: check visible imgs only\n\n        if (hasOption('autoHeight')) {\n          imgs = getImageArray(index, Math.min(index + items - 1, slideCountNew - 1));\n        }\n\n        lazyload ? initSliderTransformStyleCheck() : raf(function () {\n          imgsLoadedCheck(arrayFromNodeList(imgs), initSliderTransformStyleCheck);\n        });\n      } else {\n        // set container transform property\n        if (carousel) {\n          doContainerTransformSilent();\n        } // update slider tools and events\n\n\n        initTools();\n        initEvents();\n      }\n    }\n\n    function initSliderTransformStyleCheck() {\n      if (autoWidth && slideCount > 1) {\n        // check styles application\n        var num = loop ? index : slideCount - 1;\n\n        (function stylesApplicationCheck() {\n          var left = slideItems[num].getBoundingClientRect().left;\n          var right = slideItems[num - 1].getBoundingClientRect().right;\n          Math.abs(left - right) <= 1 ? initSliderTransformCore() : setTimeout(function () {\n            stylesApplicationCheck();\n          }, 16);\n        })();\n      } else {\n        initSliderTransformCore();\n      }\n    }\n\n    function initSliderTransformCore() {\n      // run Fn()s which are rely on image loading\n      if (!horizontal || autoWidth) {\n        setSlidePositions();\n\n        if (autoWidth) {\n          rightBoundary = getRightBoundary();\n\n          if (freezable) {\n            freeze = getFreeze();\n          }\n\n          indexMax = getIndexMax(); // <= slidePositions, rightBoundary <=\n\n          resetVariblesWhenDisable(disable || freeze);\n        } else {\n          updateContentWrapperHeight();\n        }\n      } // set container transform property\n\n\n      if (carousel) {\n        doContainerTransformSilent();\n      } // update slider tools and events\n\n\n      initTools();\n      initEvents();\n    }\n\n    function initSheet() {\n      // gallery:\n      // set animation classes and left value for gallery slider\n      if (!carousel) {\n        for (var i = index, l = index + Math.min(slideCount, items); i < l; i++) {\n          var item = slideItems[i];\n          item.style.left = (i - index) * 100 / items + '%';\n          addClass(item, animateIn);\n          removeClass(item, animateNormal);\n        }\n      } // #### LAYOUT\n      // ## INLINE-BLOCK VS FLOAT\n      // ## PercentageLayout:\n      // slides: inline-block\n      // remove blank space between slides by set font-size: 0\n      // ## Non PercentageLayout:\n      // slides: float\n      //         margin-right: -100%\n      //         margin-left: ~\n      // Resource: https://docs.google.com/spreadsheets/d/147up245wwTXeQYve3BRSAD4oVcvQmuGsFteJOeA5xNQ/edit?usp=sharing\n\n\n      if (horizontal) {\n        if (PERCENTAGELAYOUT || autoWidth) {\n          addCSSRule(sheet, '#' + slideId + ' > .tns-item', 'font-size:' + win.getComputedStyle(slideItems[0]).fontSize + ';', getCssRulesLength(sheet));\n          addCSSRule(sheet, '#' + slideId, 'font-size:0;', getCssRulesLength(sheet));\n        } else if (carousel) {\n          forEach(slideItems, function (slide, i) {\n            slide.style.marginLeft = getSlideMarginLeft(i);\n          });\n        }\n      } // ## BASIC STYLES\n\n\n      if (CSSMQ) {\n        // middle wrapper style\n        if (TRANSITIONDURATION) {\n          var str = middleWrapper && options.autoHeight ? getTransitionDurationStyle(options.speed) : '';\n          addCSSRule(sheet, '#' + slideId + '-mw', str, getCssRulesLength(sheet));\n        } // inner wrapper styles\n\n\n        str = getInnerWrapperStyles(options.edgePadding, options.gutter, options.fixedWidth, options.speed, options.autoHeight);\n        addCSSRule(sheet, '#' + slideId + '-iw', str, getCssRulesLength(sheet)); // container styles\n\n        if (carousel) {\n          str = horizontal && !autoWidth ? 'width:' + getContainerWidth(options.fixedWidth, options.gutter, options.items) + ';' : '';\n\n          if (TRANSITIONDURATION) {\n            str += getTransitionDurationStyle(speed);\n          }\n\n          addCSSRule(sheet, '#' + slideId, str, getCssRulesLength(sheet));\n        } // slide styles\n\n\n        str = horizontal && !autoWidth ? getSlideWidthStyle(options.fixedWidth, options.gutter, options.items) : '';\n\n        if (options.gutter) {\n          str += getSlideGutterStyle(options.gutter);\n        } // set gallery items transition-duration\n\n\n        if (!carousel) {\n          if (TRANSITIONDURATION) {\n            str += getTransitionDurationStyle(speed);\n          }\n\n          if (ANIMATIONDURATION) {\n            str += getAnimationDurationStyle(speed);\n          }\n        }\n\n        if (str) {\n          addCSSRule(sheet, '#' + slideId + ' > .tns-item', str, getCssRulesLength(sheet));\n        } // non CSS mediaqueries: IE8\n        // ## update inner wrapper, container, slides if needed\n        // set inline styles for inner wrapper & container\n        // insert stylesheet (one line) for slides only (since slides are many)\n\n      } else {\n        // middle wrapper styles\n        update_carousel_transition_duration(); // inner wrapper styles\n\n        innerWrapper.style.cssText = getInnerWrapperStyles(edgePadding, gutter, fixedWidth, autoHeight); // container styles\n\n        if (carousel && horizontal && !autoWidth) {\n          container.style.width = getContainerWidth(fixedWidth, gutter, items);\n        } // slide styles\n\n\n        var str = horizontal && !autoWidth ? getSlideWidthStyle(fixedWidth, gutter, items) : '';\n\n        if (gutter) {\n          str += getSlideGutterStyle(gutter);\n        } // append to the last line\n\n\n        if (str) {\n          addCSSRule(sheet, '#' + slideId + ' > .tns-item', str, getCssRulesLength(sheet));\n        }\n      } // ## MEDIAQUERIES\n\n\n      if (responsive && CSSMQ) {\n        for (var bp in responsive) {\n          // bp: convert string to number\n          bp = parseInt(bp);\n          var opts = responsive[bp],\n              str = '',\n              middleWrapperStr = '',\n              innerWrapperStr = '',\n              containerStr = '',\n              slideStr = '',\n              itemsBP = !autoWidth ? getOption('items', bp) : null,\n              fixedWidthBP = getOption('fixedWidth', bp),\n              speedBP = getOption('speed', bp),\n              edgePaddingBP = getOption('edgePadding', bp),\n              autoHeightBP = getOption('autoHeight', bp),\n              gutterBP = getOption('gutter', bp); // middle wrapper string\n\n          if (TRANSITIONDURATION && middleWrapper && getOption('autoHeight', bp) && 'speed' in opts) {\n            middleWrapperStr = '#' + slideId + '-mw{' + getTransitionDurationStyle(speedBP) + '}';\n          } // inner wrapper string\n\n\n          if ('edgePadding' in opts || 'gutter' in opts) {\n            innerWrapperStr = '#' + slideId + '-iw{' + getInnerWrapperStyles(edgePaddingBP, gutterBP, fixedWidthBP, speedBP, autoHeightBP) + '}';\n          } // container string\n\n\n          if (carousel && horizontal && !autoWidth && ('fixedWidth' in opts || 'items' in opts || fixedWidth && 'gutter' in opts)) {\n            containerStr = 'width:' + getContainerWidth(fixedWidthBP, gutterBP, itemsBP) + ';';\n          }\n\n          if (TRANSITIONDURATION && 'speed' in opts) {\n            containerStr += getTransitionDurationStyle(speedBP);\n          }\n\n          if (containerStr) {\n            containerStr = '#' + slideId + '{' + containerStr + '}';\n          } // slide string\n\n\n          if ('fixedWidth' in opts || fixedWidth && 'gutter' in opts || !carousel && 'items' in opts) {\n            slideStr += getSlideWidthStyle(fixedWidthBP, gutterBP, itemsBP);\n          }\n\n          if ('gutter' in opts) {\n            slideStr += getSlideGutterStyle(gutterBP);\n          } // set gallery items transition-duration\n\n\n          if (!carousel && 'speed' in opts) {\n            if (TRANSITIONDURATION) {\n              slideStr += getTransitionDurationStyle(speedBP);\n            }\n\n            if (ANIMATIONDURATION) {\n              slideStr += getAnimationDurationStyle(speedBP);\n            }\n          }\n\n          if (slideStr) {\n            slideStr = '#' + slideId + ' > .tns-item{' + slideStr + '}';\n          } // add up\n\n\n          str = middleWrapperStr + innerWrapperStr + containerStr + slideStr;\n\n          if (str) {\n            sheet.insertRule('@media (min-width: ' + bp / 16 + 'em) {' + str + '}', sheet.cssRules.length);\n          }\n        }\n      }\n    }\n\n    function initTools() {\n      // == slides ==\n      updateSlideStatus(); // == live region ==\n\n      outerWrapper.insertAdjacentHTML('afterbegin', '<div class=\"tns-liveregion tns-visually-hidden\" aria-live=\"polite\" aria-atomic=\"true\">slide <span class=\"current\">' + getLiveRegionStr() + '</span>  of ' + slideCount + '</div>');\n      liveregionCurrent = outerWrapper.querySelector('.tns-liveregion .current'); // == autoplayInit ==\n\n      if (hasAutoplay) {\n        var txt = autoplay ? 'stop' : 'start';\n\n        if (autoplayButton) {\n          setAttrs(autoplayButton, {\n            'data-action': txt\n          });\n        } else if (options.autoplayButtonOutput) {\n          outerWrapper.insertAdjacentHTML(getInsertPosition(options.autoplayPosition), '<button type=\"button\" data-action=\"' + txt + '\">' + autoplayHtmlStrings[0] + txt + autoplayHtmlStrings[1] + autoplayText[0] + '</button>');\n          autoplayButton = outerWrapper.querySelector('[data-action]');\n        } // add event\n\n\n        if (autoplayButton) {\n          addEvents(autoplayButton, {\n            'click': toggleAutoplay\n          });\n        }\n\n        if (autoplay) {\n          startAutoplay();\n\n          if (autoplayHoverPause) {\n            addEvents(container, hoverEvents);\n          }\n\n          if (autoplayResetOnVisibility) {\n            addEvents(container, visibilityEvent);\n          }\n        }\n      } // == navInit ==\n\n\n      if (hasNav) {\n        var initIndex = !carousel ? 0 : cloneCount; // customized nav\n        // will not hide the navs in case they're thumbnails\n\n        if (navContainer) {\n          setAttrs(navContainer, {\n            'aria-label': 'Carousel Pagination'\n          });\n          navItems = navContainer.children;\n          forEach(navItems, function (item, i) {\n            setAttrs(item, {\n              'data-nav': i,\n              'tabindex': '-1',\n              'aria-label': navStr + (i + 1),\n              'aria-controls': slideId\n            });\n          }); // generated nav\n        } else {\n          var navHtml = '',\n              hiddenStr = navAsThumbnails ? '' : 'style=\"display:none\"';\n\n          for (var i = 0; i < slideCount; i++) {\n            // hide nav items by default\n            navHtml += '<button type=\"button\" data-nav=\"' + i + '\" tabindex=\"-1\" aria-controls=\"' + slideId + '\" ' + hiddenStr + ' aria-label=\"' + navStr + (i + 1) + '\"></button>';\n          }\n\n          navHtml = '<div class=\"tns-nav\" aria-label=\"Carousel Pagination\">' + navHtml + '</div>';\n          outerWrapper.insertAdjacentHTML(getInsertPosition(options.navPosition), navHtml);\n          navContainer = outerWrapper.querySelector('.tns-nav');\n          navItems = navContainer.children;\n        }\n\n        updateNavVisibility(); // add transition\n\n        if (TRANSITIONDURATION) {\n          var prefix = TRANSITIONDURATION.substring(0, TRANSITIONDURATION.length - 18).toLowerCase(),\n              str = 'transition: all ' + speed / 1000 + 's';\n\n          if (prefix) {\n            str = '-' + prefix + '-' + str;\n          }\n\n          addCSSRule(sheet, '[aria-controls^=' + slideId + '-item]', str, getCssRulesLength(sheet));\n        }\n\n        setAttrs(navItems[navCurrentIndex], {\n          'aria-label': navStr + (navCurrentIndex + 1) + navStrCurrent\n        });\n        removeAttrs(navItems[navCurrentIndex], 'tabindex');\n        addClass(navItems[navCurrentIndex], navActiveClass); // add events\n\n        addEvents(navContainer, navEvents);\n      } // == controlsInit ==\n\n\n      if (hasControls) {\n        if (!controlsContainer && (!prevButton || !nextButton)) {\n          outerWrapper.insertAdjacentHTML(getInsertPosition(options.controlsPosition), '<div class=\"tns-controls\" aria-label=\"Carousel Navigation\" tabindex=\"0\"><button type=\"button\" data-controls=\"prev\" tabindex=\"-1\" aria-controls=\"' + slideId + '\">' + controlsText[0] + '</button><button type=\"button\" data-controls=\"next\" tabindex=\"-1\" aria-controls=\"' + slideId + '\">' + controlsText[1] + '</button></div>');\n          controlsContainer = outerWrapper.querySelector('.tns-controls');\n        }\n\n        if (!prevButton || !nextButton) {\n          prevButton = controlsContainer.children[0];\n          nextButton = controlsContainer.children[1];\n        }\n\n        if (options.controlsContainer) {\n          setAttrs(controlsContainer, {\n            'aria-label': 'Carousel Navigation',\n            'tabindex': '0'\n          });\n        }\n\n        if (options.controlsContainer || options.prevButton && options.nextButton) {\n          setAttrs([prevButton, nextButton], {\n            'aria-controls': slideId,\n            'tabindex': '-1'\n          });\n        }\n\n        if (options.controlsContainer || options.prevButton && options.nextButton) {\n          setAttrs(prevButton, {\n            'data-controls': 'prev'\n          });\n          setAttrs(nextButton, {\n            'data-controls': 'next'\n          });\n        }\n\n        prevIsButton = isButton(prevButton);\n        nextIsButton = isButton(nextButton);\n        updateControlsStatus(); // add events\n\n        if (controlsContainer) {\n          addEvents(controlsContainer, controlsEvents);\n        } else {\n          addEvents(prevButton, controlsEvents);\n          addEvents(nextButton, controlsEvents);\n        }\n      } // hide tools if needed\n\n\n      disableUI();\n    }\n\n    function initEvents() {\n      // add events\n      if (carousel && TRANSITIONEND) {\n        var eve = {};\n        eve[TRANSITIONEND] = onTransitionEnd;\n        addEvents(container, eve);\n      }\n\n      if (touch) {\n        addEvents(container, touchEvents, options.preventScrollOnTouch);\n      }\n\n      if (mouseDrag) {\n        addEvents(container, dragEvents);\n      }\n\n      if (arrowKeys) {\n        addEvents(doc, docmentKeydownEvent);\n      }\n\n      if (nested === 'inner') {\n        events.on('outerResized', function () {\n          resizeTasks();\n          events.emit('innerLoaded', info());\n        });\n      } else if (responsive || fixedWidth || autoWidth || autoHeight || !horizontal) {\n        addEvents(win, {\n          'resize': onResize\n        });\n      }\n\n      if (autoHeight) {\n        if (nested === 'outer') {\n          events.on('innerLoaded', doAutoHeight);\n        } else if (!disable) {\n          doAutoHeight();\n        }\n      }\n\n      doLazyLoad();\n\n      if (disable) {\n        disableSlider();\n      } else if (freeze) {\n        freezeSlider();\n      }\n\n      events.on('indexChanged', additionalUpdates);\n\n      if (nested === 'inner') {\n        events.emit('innerLoaded', info());\n      }\n\n      if (typeof onInit === 'function') {\n        onInit(info());\n      }\n\n      isOn = true;\n    }\n\n    function destroy() {\n      // sheet\n      sheet.disabled = true;\n\n      if (sheet.ownerNode) {\n        sheet.ownerNode.remove();\n      } // remove win event listeners\n\n\n      removeEvents(win, {\n        'resize': onResize\n      }); // arrowKeys, controls, nav\n\n      if (arrowKeys) {\n        removeEvents(doc, docmentKeydownEvent);\n      }\n\n      if (controlsContainer) {\n        removeEvents(controlsContainer, controlsEvents);\n      }\n\n      if (navContainer) {\n        removeEvents(navContainer, navEvents);\n      } // autoplay\n\n\n      removeEvents(container, hoverEvents);\n      removeEvents(container, visibilityEvent);\n\n      if (autoplayButton) {\n        removeEvents(autoplayButton, {\n          'click': toggleAutoplay\n        });\n      }\n\n      if (autoplay) {\n        clearInterval(autoplayTimer);\n      } // container\n\n\n      if (carousel && TRANSITIONEND) {\n        var eve = {};\n        eve[TRANSITIONEND] = onTransitionEnd;\n        removeEvents(container, eve);\n      }\n\n      if (touch) {\n        removeEvents(container, touchEvents);\n      }\n\n      if (mouseDrag) {\n        removeEvents(container, dragEvents);\n      } // cache Object values in options && reset HTML\n\n\n      var htmlList = [containerHTML, controlsContainerHTML, prevButtonHTML, nextButtonHTML, navContainerHTML, autoplayButtonHTML];\n      tnsList.forEach(function (item, i) {\n        var el = item === 'container' ? outerWrapper : options[item];\n\n        if (typeof el === 'object' && el) {\n          var prevEl = el.previousElementSibling ? el.previousElementSibling : false,\n              parentEl = el.parentNode;\n          el.outerHTML = htmlList[i];\n          options[item] = prevEl ? prevEl.nextElementSibling : parentEl.firstElementChild;\n        }\n      }); // reset variables\n\n      tnsList = animateIn = animateOut = animateDelay = animateNormal = horizontal = outerWrapper = innerWrapper = container = containerParent = containerHTML = slideItems = slideCount = breakpointZone = windowWidth = autoWidth = fixedWidth = edgePadding = gutter = viewport = items = slideBy = viewportMax = arrowKeys = speed = rewind = loop = autoHeight = sheet = lazyload = slidePositions = slideItemsOut = cloneCount = slideCountNew = hasRightDeadZone = rightBoundary = updateIndexBeforeTransform = transformAttr = transformPrefix = transformPostfix = getIndexMax = index = indexCached = indexMin = indexMax = resizeTimer = swipeAngle = moveDirectionExpected = running = onInit = events = newContainerClasses = slideId = disable = disabled = freezable = freeze = frozen = controlsEvents = navEvents = hoverEvents = visibilityEvent = docmentKeydownEvent = touchEvents = dragEvents = hasControls = hasNav = navAsThumbnails = hasAutoplay = hasTouch = hasMouseDrag = slideActiveClass = imgCompleteClass = imgEvents = imgsComplete = controls = controlsText = controlsContainer = controlsContainerHTML = prevButton = nextButton = prevIsButton = nextIsButton = nav = navContainer = navContainerHTML = navItems = pages = pagesCached = navClicked = navCurrentIndex = navCurrentIndexCached = navActiveClass = navStr = navStrCurrent = autoplay = autoplayTimeout = autoplayDirection = autoplayText = autoplayHoverPause = autoplayButton = autoplayButtonHTML = autoplayResetOnVisibility = autoplayHtmlStrings = autoplayTimer = animating = autoplayHoverPaused = autoplayUserPaused = autoplayVisibilityPaused = initPosition = lastPosition = translateInit = disX = disY = panStart = rafIndex = getDist = touch = mouseDrag = null; // check variables\n      // [animateIn, animateOut, animateDelay, animateNormal, horizontal, outerWrapper, innerWrapper, container, containerParent, containerHTML, slideItems, slideCount, breakpointZone, windowWidth, autoWidth, fixedWidth, edgePadding, gutter, viewport, items, slideBy, viewportMax, arrowKeys, speed, rewind, loop, autoHeight, sheet, lazyload, slidePositions, slideItemsOut, cloneCount, slideCountNew, hasRightDeadZone, rightBoundary, updateIndexBeforeTransform, transformAttr, transformPrefix, transformPostfix, getIndexMax, index, indexCached, indexMin, indexMax, resizeTimer, swipeAngle, moveDirectionExpected, running, onInit, events, newContainerClasses, slideId, disable, disabled, freezable, freeze, frozen, controlsEvents, navEvents, hoverEvents, visibilityEvent, docmentKeydownEvent, touchEvents, dragEvents, hasControls, hasNav, navAsThumbnails, hasAutoplay, hasTouch, hasMouseDrag, slideActiveClass, imgCompleteClass, imgEvents, imgsComplete, controls, controlsText, controlsContainer, controlsContainerHTML, prevButton, nextButton, prevIsButton, nextIsButton, nav, navContainer, navContainerHTML, navItems, pages, pagesCached, navClicked, navCurrentIndex, navCurrentIndexCached, navActiveClass, navStr, navStrCurrent, autoplay, autoplayTimeout, autoplayDirection, autoplayText, autoplayHoverPause, autoplayButton, autoplayButtonHTML, autoplayResetOnVisibility, autoplayHtmlStrings, autoplayTimer, animating, autoplayHoverPaused, autoplayUserPaused, autoplayVisibilityPaused, initPosition, lastPosition, translateInit, disX, disY, panStart, rafIndex, getDist, touch, mouseDrag ].forEach(function(item) { if (item !== null) { console.log(item); } });\n\n      for (var a in this) {\n        if (a !== 'rebuild') {\n          this[a] = null;\n        }\n      }\n\n      isOn = false;\n    } // === ON RESIZE ===\n    // responsive || fixedWidth || autoWidth || !horizontal\n\n\n    function onResize(e) {\n      raf(function () {\n        resizeTasks(getEvent(e));\n      });\n    }\n\n    function resizeTasks(e) {\n      if (!isOn) {\n        return;\n      }\n\n      if (nested === 'outer') {\n        events.emit('outerResized', info(e));\n      }\n\n      windowWidth = getWindowWidth();\n      var bpChanged,\n          breakpointZoneTem = breakpointZone,\n          needContainerTransform = false;\n\n      if (responsive) {\n        setBreakpointZone();\n        bpChanged = breakpointZoneTem !== breakpointZone; // if (hasRightDeadZone) { needContainerTransform = true; } // *?\n\n        if (bpChanged) {\n          events.emit('newBreakpointStart', info(e));\n        }\n      }\n\n      var indChanged,\n          itemsChanged,\n          itemsTem = items,\n          disableTem = disable,\n          freezeTem = freeze,\n          arrowKeysTem = arrowKeys,\n          controlsTem = controls,\n          navTem = nav,\n          touchTem = touch,\n          mouseDragTem = mouseDrag,\n          autoplayTem = autoplay,\n          autoplayHoverPauseTem = autoplayHoverPause,\n          autoplayResetOnVisibilityTem = autoplayResetOnVisibility,\n          indexTem = index;\n\n      if (bpChanged) {\n        var fixedWidthTem = fixedWidth,\n            autoHeightTem = autoHeight,\n            controlsTextTem = controlsText,\n            centerTem = center,\n            autoplayTextTem = autoplayText;\n\n        if (!CSSMQ) {\n          var gutterTem = gutter,\n              edgePaddingTem = edgePadding;\n        }\n      } // get option:\n      // fixed width: viewport, fixedWidth, gutter => items\n      // others: window width => all variables\n      // all: items => slideBy\n\n\n      arrowKeys = getOption('arrowKeys');\n      controls = getOption('controls');\n      nav = getOption('nav');\n      touch = getOption('touch');\n      center = getOption('center');\n      mouseDrag = getOption('mouseDrag');\n      autoplay = getOption('autoplay');\n      autoplayHoverPause = getOption('autoplayHoverPause');\n      autoplayResetOnVisibility = getOption('autoplayResetOnVisibility');\n\n      if (bpChanged) {\n        disable = getOption('disable');\n        fixedWidth = getOption('fixedWidth');\n        speed = getOption('speed');\n        autoHeight = getOption('autoHeight');\n        controlsText = getOption('controlsText');\n        autoplayText = getOption('autoplayText');\n        autoplayTimeout = getOption('autoplayTimeout');\n\n        if (!CSSMQ) {\n          edgePadding = getOption('edgePadding');\n          gutter = getOption('gutter');\n        }\n      } // update options\n\n\n      resetVariblesWhenDisable(disable);\n      viewport = getViewportWidth(); // <= edgePadding, gutter\n\n      if ((!horizontal || autoWidth) && !disable) {\n        setSlidePositions();\n\n        if (!horizontal) {\n          updateContentWrapperHeight(); // <= setSlidePositions\n\n          needContainerTransform = true;\n        }\n      }\n\n      if (fixedWidth || autoWidth) {\n        rightBoundary = getRightBoundary(); // autoWidth: <= viewport, slidePositions, gutter\n        // fixedWidth: <= viewport, fixedWidth, gutter\n\n        indexMax = getIndexMax(); // autoWidth: <= rightBoundary, slidePositions\n        // fixedWidth: <= rightBoundary, fixedWidth, gutter\n      }\n\n      if (bpChanged || fixedWidth) {\n        items = getOption('items');\n        slideBy = getOption('slideBy');\n        itemsChanged = items !== itemsTem;\n\n        if (itemsChanged) {\n          if (!fixedWidth && !autoWidth) {\n            indexMax = getIndexMax();\n          } // <= items\n          // check index before transform in case\n          // slider reach the right edge then items become bigger\n\n\n          updateIndex();\n        }\n      }\n\n      if (bpChanged) {\n        if (disable !== disableTem) {\n          if (disable) {\n            disableSlider();\n          } else {\n            enableSlider(); // <= slidePositions, rightBoundary, indexMax\n          }\n        }\n      }\n\n      if (freezable && (bpChanged || fixedWidth || autoWidth)) {\n        freeze = getFreeze(); // <= autoWidth: slidePositions, gutter, viewport, rightBoundary\n        // <= fixedWidth: fixedWidth, gutter, rightBoundary\n        // <= others: items\n\n        if (freeze !== freezeTem) {\n          if (freeze) {\n            doContainerTransform(getContainerTransformValue(getStartIndex(0)));\n            freezeSlider();\n          } else {\n            unfreezeSlider();\n            needContainerTransform = true;\n          }\n        }\n      }\n\n      resetVariblesWhenDisable(disable || freeze); // controls, nav, touch, mouseDrag, arrowKeys, autoplay, autoplayHoverPause, autoplayResetOnVisibility\n\n      if (!autoplay) {\n        autoplayHoverPause = autoplayResetOnVisibility = false;\n      }\n\n      if (arrowKeys !== arrowKeysTem) {\n        arrowKeys ? addEvents(doc, docmentKeydownEvent) : removeEvents(doc, docmentKeydownEvent);\n      }\n\n      if (controls !== controlsTem) {\n        if (controls) {\n          if (controlsContainer) {\n            showElement(controlsContainer);\n          } else {\n            if (prevButton) {\n              showElement(prevButton);\n            }\n\n            if (nextButton) {\n              showElement(nextButton);\n            }\n          }\n        } else {\n          if (controlsContainer) {\n            hideElement(controlsContainer);\n          } else {\n            if (prevButton) {\n              hideElement(prevButton);\n            }\n\n            if (nextButton) {\n              hideElement(nextButton);\n            }\n          }\n        }\n      }\n\n      if (nav !== navTem) {\n        if (nav) {\n          showElement(navContainer);\n          updateNavVisibility();\n        } else {\n          hideElement(navContainer);\n        }\n      }\n\n      if (touch !== touchTem) {\n        touch ? addEvents(container, touchEvents, options.preventScrollOnTouch) : removeEvents(container, touchEvents);\n      }\n\n      if (mouseDrag !== mouseDragTem) {\n        mouseDrag ? addEvents(container, dragEvents) : removeEvents(container, dragEvents);\n      }\n\n      if (autoplay !== autoplayTem) {\n        if (autoplay) {\n          if (autoplayButton) {\n            showElement(autoplayButton);\n          }\n\n          if (!animating && !autoplayUserPaused) {\n            startAutoplay();\n          }\n        } else {\n          if (autoplayButton) {\n            hideElement(autoplayButton);\n          }\n\n          if (animating) {\n            stopAutoplay();\n          }\n        }\n      }\n\n      if (autoplayHoverPause !== autoplayHoverPauseTem) {\n        autoplayHoverPause ? addEvents(container, hoverEvents) : removeEvents(container, hoverEvents);\n      }\n\n      if (autoplayResetOnVisibility !== autoplayResetOnVisibilityTem) {\n        autoplayResetOnVisibility ? addEvents(doc, visibilityEvent) : removeEvents(doc, visibilityEvent);\n      }\n\n      if (bpChanged) {\n        if (fixedWidth !== fixedWidthTem || center !== centerTem) {\n          needContainerTransform = true;\n        }\n\n        if (autoHeight !== autoHeightTem) {\n          if (!autoHeight) {\n            innerWrapper.style.height = '';\n          }\n        }\n\n        if (controls && controlsText !== controlsTextTem) {\n          prevButton.innerHTML = controlsText[0];\n          nextButton.innerHTML = controlsText[1];\n        }\n\n        if (autoplayButton && autoplayText !== autoplayTextTem) {\n          var i = autoplay ? 1 : 0,\n              html = autoplayButton.innerHTML,\n              len = html.length - autoplayTextTem[i].length;\n\n          if (html.substring(len) === autoplayTextTem[i]) {\n            autoplayButton.innerHTML = html.substring(0, len) + autoplayText[i];\n          }\n        }\n      } else {\n        if (center && (fixedWidth || autoWidth)) {\n          needContainerTransform = true;\n        }\n      }\n\n      if (itemsChanged || fixedWidth && !autoWidth) {\n        pages = getPages();\n        updateNavVisibility();\n      }\n\n      indChanged = index !== indexTem;\n\n      if (indChanged) {\n        events.emit('indexChanged', info());\n        needContainerTransform = true;\n      } else if (itemsChanged) {\n        if (!indChanged) {\n          additionalUpdates();\n        }\n      } else if (fixedWidth || autoWidth) {\n        doLazyLoad();\n        updateSlideStatus();\n        updateLiveRegion();\n      }\n\n      if (itemsChanged && !carousel) {\n        updateGallerySlidePositions();\n      }\n\n      if (!disable && !freeze) {\n        // non-mediaqueries: IE8\n        if (bpChanged && !CSSMQ) {\n          // middle wrapper styles\n          // inner wrapper styles\n          if (edgePadding !== edgePaddingTem || gutter !== gutterTem) {\n            innerWrapper.style.cssText = getInnerWrapperStyles(edgePadding, gutter, fixedWidth, speed, autoHeight);\n          }\n\n          if (horizontal) {\n            // container styles\n            if (carousel) {\n              container.style.width = getContainerWidth(fixedWidth, gutter, items);\n            } // slide styles\n\n\n            var str = getSlideWidthStyle(fixedWidth, gutter, items) + getSlideGutterStyle(gutter); // remove the last line and\n            // add new styles\n\n            removeCSSRule(sheet, getCssRulesLength(sheet) - 1);\n            addCSSRule(sheet, '#' + slideId + ' > .tns-item', str, getCssRulesLength(sheet));\n          }\n        } // auto height\n\n\n        if (autoHeight) {\n          doAutoHeight();\n        }\n\n        if (needContainerTransform) {\n          doContainerTransformSilent();\n          indexCached = index;\n        }\n      }\n\n      if (bpChanged) {\n        events.emit('newBreakpointEnd', info(e));\n      }\n    } // === INITIALIZATION FUNCTIONS === //\n\n\n    function getFreeze() {\n      if (!fixedWidth && !autoWidth) {\n        var a = center ? items - (items - 1) / 2 : items;\n        return slideCount <= a;\n      }\n\n      var width = fixedWidth ? (fixedWidth + gutter) * slideCount : slidePositions[slideCount],\n          vp = edgePadding ? viewport + edgePadding * 2 : viewport + gutter;\n\n      if (center) {\n        vp -= fixedWidth ? (viewport - fixedWidth) / 2 : (viewport - (slidePositions[index + 1] - slidePositions[index] - gutter)) / 2;\n      }\n\n      return width <= vp;\n    }\n\n    function setBreakpointZone() {\n      breakpointZone = 0;\n\n      for (var bp in responsive) {\n        bp = parseInt(bp); // convert string to number\n\n        if (windowWidth >= bp) {\n          breakpointZone = bp;\n        }\n      }\n    } // (slideBy, indexMin, indexMax) => index\n\n\n    var updateIndex = function () {\n      return loop ? carousel ? // loop + carousel\n      function () {\n        var leftEdge = indexMin,\n            rightEdge = indexMax;\n        leftEdge += slideBy;\n        rightEdge -= slideBy; // adjust edges when has edge paddings\n        // or fixed-width slider with extra space on the right side\n\n        if (edgePadding) {\n          leftEdge += 1;\n          rightEdge -= 1;\n        } else if (fixedWidth) {\n          if ((viewport + gutter) % (fixedWidth + gutter)) {\n            rightEdge -= 1;\n          }\n        }\n\n        if (cloneCount) {\n          if (index > rightEdge) {\n            index -= slideCount;\n          } else if (index < leftEdge) {\n            index += slideCount;\n          }\n        }\n      } : // loop + gallery\n      function () {\n        if (index > indexMax) {\n          while (index >= indexMin + slideCount) {\n            index -= slideCount;\n          }\n        } else if (index < indexMin) {\n          while (index <= indexMax - slideCount) {\n            index += slideCount;\n          }\n        }\n      } : // non-loop\n      function () {\n        index = Math.max(indexMin, Math.min(indexMax, index));\n      };\n    }();\n\n    function disableUI() {\n      if (!autoplay && autoplayButton) {\n        hideElement(autoplayButton);\n      }\n\n      if (!nav && navContainer) {\n        hideElement(navContainer);\n      }\n\n      if (!controls) {\n        if (controlsContainer) {\n          hideElement(controlsContainer);\n        } else {\n          if (prevButton) {\n            hideElement(prevButton);\n          }\n\n          if (nextButton) {\n            hideElement(nextButton);\n          }\n        }\n      }\n    }\n\n    function enableUI() {\n      if (autoplay && autoplayButton) {\n        showElement(autoplayButton);\n      }\n\n      if (nav && navContainer) {\n        showElement(navContainer);\n      }\n\n      if (controls) {\n        if (controlsContainer) {\n          showElement(controlsContainer);\n        } else {\n          if (prevButton) {\n            showElement(prevButton);\n          }\n\n          if (nextButton) {\n            showElement(nextButton);\n          }\n        }\n      }\n    }\n\n    function freezeSlider() {\n      if (frozen) {\n        return;\n      } // remove edge padding from inner wrapper\n\n\n      if (edgePadding) {\n        innerWrapper.style.margin = '0px';\n      } // add class tns-transparent to cloned slides\n\n\n      if (cloneCount) {\n        var str = 'tns-transparent';\n\n        for (var i = cloneCount; i--;) {\n          if (carousel) {\n            addClass(slideItems[i], str);\n          }\n\n          addClass(slideItems[slideCountNew - i - 1], str);\n        }\n      } // update tools\n\n\n      disableUI();\n      frozen = true;\n    }\n\n    function unfreezeSlider() {\n      if (!frozen) {\n        return;\n      } // restore edge padding for inner wrapper\n      // for mordern browsers\n\n\n      if (edgePadding && CSSMQ) {\n        innerWrapper.style.margin = '';\n      } // remove class tns-transparent to cloned slides\n\n\n      if (cloneCount) {\n        var str = 'tns-transparent';\n\n        for (var i = cloneCount; i--;) {\n          if (carousel) {\n            removeClass(slideItems[i], str);\n          }\n\n          removeClass(slideItems[slideCountNew - i - 1], str);\n        }\n      } // update tools\n\n\n      enableUI();\n      frozen = false;\n    }\n\n    function disableSlider() {\n      if (disabled) {\n        return;\n      }\n\n      sheet.disabled = true;\n      container.className = container.className.replace(newContainerClasses.substring(1), '');\n      removeAttrs(container, ['style']);\n\n      if (loop) {\n        for (var j = cloneCount; j--;) {\n          if (carousel) {\n            hideElement(slideItems[j]);\n          }\n\n          hideElement(slideItems[slideCountNew - j - 1]);\n        }\n      } // vertical slider\n\n\n      if (!horizontal || !carousel) {\n        removeAttrs(innerWrapper, ['style']);\n      } // gallery\n\n\n      if (!carousel) {\n        for (var i = index, l = index + slideCount; i < l; i++) {\n          var item = slideItems[i];\n          removeAttrs(item, ['style']);\n          removeClass(item, animateIn);\n          removeClass(item, animateNormal);\n        }\n      } // update tools\n\n\n      disableUI();\n      disabled = true;\n    }\n\n    function enableSlider() {\n      if (!disabled) {\n        return;\n      }\n\n      sheet.disabled = false;\n      container.className += newContainerClasses;\n      doContainerTransformSilent();\n\n      if (loop) {\n        for (var j = cloneCount; j--;) {\n          if (carousel) {\n            showElement(slideItems[j]);\n          }\n\n          showElement(slideItems[slideCountNew - j - 1]);\n        }\n      } // gallery\n\n\n      if (!carousel) {\n        for (var i = index, l = index + slideCount; i < l; i++) {\n          var item = slideItems[i],\n              classN = i < index + items ? animateIn : animateNormal;\n          item.style.left = (i - index) * 100 / items + '%';\n          addClass(item, classN);\n        }\n      } // update tools\n\n\n      enableUI();\n      disabled = false;\n    }\n\n    function updateLiveRegion() {\n      var str = getLiveRegionStr();\n\n      if (liveregionCurrent.innerHTML !== str) {\n        liveregionCurrent.innerHTML = str;\n      }\n    }\n\n    function getLiveRegionStr() {\n      var arr = getVisibleSlideRange(),\n          start = arr[0] + 1,\n          end = arr[1] + 1;\n      return start === end ? start + '' : start + ' to ' + end;\n    }\n\n    function getVisibleSlideRange(val) {\n      if (val == null) {\n        val = getContainerTransformValue();\n      }\n\n      var start = index,\n          end,\n          rangestart,\n          rangeend; // get range start, range end for autoWidth and fixedWidth\n\n      if (center || edgePadding) {\n        if (autoWidth || fixedWidth) {\n          rangestart = -(parseFloat(val) + edgePadding);\n          rangeend = rangestart + viewport + edgePadding * 2;\n        }\n      } else {\n        if (autoWidth) {\n          rangestart = slidePositions[index];\n          rangeend = rangestart + viewport;\n        }\n      } // get start, end\n      // - check auto width\n\n\n      if (autoWidth) {\n        slidePositions.forEach(function (point, i) {\n          if (i < slideCountNew) {\n            if ((center || edgePadding) && point <= rangestart + 0.5) {\n              start = i;\n            }\n\n            if (rangeend - point >= 0.5) {\n              end = i;\n            }\n          }\n        }); // - check percentage width, fixed width\n      } else {\n        if (fixedWidth) {\n          var cell = fixedWidth + gutter;\n\n          if (center || edgePadding) {\n            start = Math.floor(rangestart / cell);\n            end = Math.ceil(rangeend / cell - 1);\n          } else {\n            end = start + Math.ceil(viewport / cell) - 1;\n          }\n        } else {\n          if (center || edgePadding) {\n            var a = items - 1;\n\n            if (center) {\n              start -= a / 2;\n              end = index + a / 2;\n            } else {\n              end = index + a;\n            }\n\n            if (edgePadding) {\n              var b = edgePadding * items / viewport;\n              start -= b;\n              end += b;\n            }\n\n            start = Math.floor(start);\n            end = Math.ceil(end);\n          } else {\n            end = start + items - 1;\n          }\n        }\n\n        start = Math.max(start, 0);\n        end = Math.min(end, slideCountNew - 1);\n      }\n\n      return [start, end];\n    }\n\n    function doLazyLoad() {\n      if (lazyload && !disable) {\n        var arg = getVisibleSlideRange();\n        arg.push(lazyloadSelector);\n        getImageArray.apply(null, arg).forEach(function (img) {\n          if (!hasClass(img, imgCompleteClass)) {\n            // stop propagation transitionend event to container\n            var eve = {};\n\n            eve[TRANSITIONEND] = function (e) {\n              e.stopPropagation();\n            };\n\n            addEvents(img, eve);\n            addEvents(img, imgEvents); // update src\n\n            img.src = getAttr(img, 'data-src'); // update srcset\n\n            var srcset = getAttr(img, 'data-srcset');\n\n            if (srcset) {\n              img.srcset = srcset;\n            }\n\n            addClass(img, 'loading');\n          }\n        });\n      }\n    }\n\n    function onImgLoaded(e) {\n      imgLoaded(getTarget(e));\n    }\n\n    function onImgFailed(e) {\n      imgFailed(getTarget(e));\n    }\n\n    function imgLoaded(img) {\n      addClass(img, 'loaded');\n      imgCompleted(img);\n    }\n\n    function imgFailed(img) {\n      addClass(img, 'failed');\n      imgCompleted(img);\n    }\n\n    function imgCompleted(img) {\n      addClass(img, imgCompleteClass);\n      removeClass(img, 'loading');\n      removeEvents(img, imgEvents);\n    }\n\n    function getImageArray(start, end, imgSelector) {\n      var imgs = [];\n\n      if (!imgSelector) {\n        imgSelector = 'img';\n      }\n\n      while (start <= end) {\n        forEach(slideItems[start].querySelectorAll(imgSelector), function (img) {\n          imgs.push(img);\n        });\n        start++;\n      }\n\n      return imgs;\n    } // check if all visible images are loaded\n    // and update container height if it's done\n\n\n    function doAutoHeight() {\n      var imgs = getImageArray.apply(null, getVisibleSlideRange());\n      raf(function () {\n        imgsLoadedCheck(imgs, updateInnerWrapperHeight);\n      });\n    }\n\n    function imgsLoadedCheck(imgs, cb) {\n      // execute callback function if all images are complete\n      if (imgsComplete) {\n        return cb();\n      } // check image classes\n\n\n      imgs.forEach(function (img, index) {\n        if (!lazyload && img.complete) {\n          imgCompleted(img);\n        } // Check image.complete\n\n\n        if (hasClass(img, imgCompleteClass)) {\n          imgs.splice(index, 1);\n        }\n      }); // execute callback function if selected images are all complete\n\n      if (!imgs.length) {\n        return cb();\n      } // otherwise execute this functiona again\n\n\n      raf(function () {\n        imgsLoadedCheck(imgs, cb);\n      });\n    }\n\n    function additionalUpdates() {\n      doLazyLoad();\n      updateSlideStatus();\n      updateLiveRegion();\n      updateControlsStatus();\n      updateNavStatus();\n    }\n\n    function update_carousel_transition_duration() {\n      if (carousel && autoHeight) {\n        middleWrapper.style[TRANSITIONDURATION] = speed / 1000 + 's';\n      }\n    }\n\n    function getMaxSlideHeight(slideStart, slideRange) {\n      var heights = [];\n\n      for (var i = slideStart, l = Math.min(slideStart + slideRange, slideCountNew); i < l; i++) {\n        heights.push(slideItems[i].offsetHeight);\n      }\n\n      return Math.max.apply(null, heights);\n    } // update inner wrapper height\n    // 1. get the max-height of the visible slides\n    // 2. set transitionDuration to speed\n    // 3. update inner wrapper height to max-height\n    // 4. set transitionDuration to 0s after transition done\n\n\n    function updateInnerWrapperHeight() {\n      var maxHeight = autoHeight ? getMaxSlideHeight(index, items) : getMaxSlideHeight(cloneCount, slideCount),\n          wp = middleWrapper ? middleWrapper : innerWrapper;\n\n      if (wp.style.height !== maxHeight) {\n        wp.style.height = maxHeight + 'px';\n      }\n    } // get the distance from the top edge of the first slide to each slide\n    // (init) => slidePositions\n\n\n    function setSlidePositions() {\n      slidePositions = [0];\n      var attr = horizontal ? 'left' : 'top',\n          attr2 = horizontal ? 'right' : 'bottom',\n          base = slideItems[0].getBoundingClientRect()[attr];\n      forEach(slideItems, function (item, i) {\n        // skip the first slide\n        if (i) {\n          slidePositions.push(item.getBoundingClientRect()[attr] - base);\n        } // add the end edge\n\n\n        if (i === slideCountNew - 1) {\n          slidePositions.push(item.getBoundingClientRect()[attr2] - base);\n        }\n      });\n    } // update slide\n\n\n    function updateSlideStatus() {\n      var range = getVisibleSlideRange(),\n          start = range[0],\n          end = range[1];\n      forEach(slideItems, function (item, i) {\n        // show slides\n        if (i >= start && i <= end) {\n          if (hasAttr(item, 'aria-hidden')) {\n            removeAttrs(item, ['aria-hidden', 'tabindex']);\n            addClass(item, slideActiveClass);\n          } // hide slides\n\n        } else {\n          if (!hasAttr(item, 'aria-hidden')) {\n            setAttrs(item, {\n              'aria-hidden': 'true',\n              'tabindex': '-1'\n            });\n            removeClass(item, slideActiveClass);\n          }\n        }\n      });\n    } // gallery: update slide position\n\n\n    function updateGallerySlidePositions() {\n      var l = index + Math.min(slideCount, items);\n\n      for (var i = slideCountNew; i--;) {\n        var item = slideItems[i];\n\n        if (i >= index && i < l) {\n          // add transitions to visible slides when adjusting their positions\n          addClass(item, 'tns-moving');\n          item.style.left = (i - index) * 100 / items + '%';\n          addClass(item, animateIn);\n          removeClass(item, animateNormal);\n        } else if (item.style.left) {\n          item.style.left = '';\n          addClass(item, animateNormal);\n          removeClass(item, animateIn);\n        } // remove outlet animation\n\n\n        removeClass(item, animateOut);\n      } // removing '.tns-moving'\n\n\n      setTimeout(function () {\n        forEach(slideItems, function (el) {\n          removeClass(el, 'tns-moving');\n        });\n      }, 300);\n    } // set tabindex on Nav\n\n\n    function updateNavStatus() {\n      // get current nav\n      if (nav) {\n        navCurrentIndex = navClicked >= 0 ? navClicked : getCurrentNavIndex();\n        navClicked = -1;\n\n        if (navCurrentIndex !== navCurrentIndexCached) {\n          var navPrev = navItems[navCurrentIndexCached],\n              navCurrent = navItems[navCurrentIndex];\n          setAttrs(navPrev, {\n            'tabindex': '-1',\n            'aria-label': navStr + (navCurrentIndexCached + 1)\n          });\n          removeClass(navPrev, navActiveClass);\n          setAttrs(navCurrent, {\n            'aria-label': navStr + (navCurrentIndex + 1) + navStrCurrent\n          });\n          removeAttrs(navCurrent, 'tabindex');\n          addClass(navCurrent, navActiveClass);\n          navCurrentIndexCached = navCurrentIndex;\n        }\n      }\n    }\n\n    function getLowerCaseNodeName(el) {\n      return el.nodeName.toLowerCase();\n    }\n\n    function isButton(el) {\n      return getLowerCaseNodeName(el) === 'button';\n    }\n\n    function isAriaDisabled(el) {\n      return el.getAttribute('aria-disabled') === 'true';\n    }\n\n    function disEnableElement(isButton, el, val) {\n      if (isButton) {\n        el.disabled = val;\n      } else {\n        el.setAttribute('aria-disabled', val.toString());\n      }\n    } // set 'disabled' to true on controls when reach the edges\n\n\n    function updateControlsStatus() {\n      if (!controls || rewind || loop) {\n        return;\n      }\n\n      var prevDisabled = prevIsButton ? prevButton.disabled : isAriaDisabled(prevButton),\n          nextDisabled = nextIsButton ? nextButton.disabled : isAriaDisabled(nextButton),\n          disablePrev = index <= indexMin ? true : false,\n          disableNext = !rewind && index >= indexMax ? true : false;\n\n      if (disablePrev && !prevDisabled) {\n        disEnableElement(prevIsButton, prevButton, true);\n      }\n\n      if (!disablePrev && prevDisabled) {\n        disEnableElement(prevIsButton, prevButton, false);\n      }\n\n      if (disableNext && !nextDisabled) {\n        disEnableElement(nextIsButton, nextButton, true);\n      }\n\n      if (!disableNext && nextDisabled) {\n        disEnableElement(nextIsButton, nextButton, false);\n      }\n    } // set duration\n\n\n    function resetDuration(el, str) {\n      if (TRANSITIONDURATION) {\n        el.style[TRANSITIONDURATION] = str;\n      }\n    }\n\n    function getSliderWidth() {\n      return fixedWidth ? (fixedWidth + gutter) * slideCountNew : slidePositions[slideCountNew];\n    }\n\n    function getCenterGap(num) {\n      if (num == null) {\n        num = index;\n      }\n\n      var gap = edgePadding ? gutter : 0;\n      return autoWidth ? (viewport - gap - (slidePositions[num + 1] - slidePositions[num] - gutter)) / 2 : fixedWidth ? (viewport - fixedWidth) / 2 : (items - 1) / 2;\n    }\n\n    function getRightBoundary() {\n      var gap = edgePadding ? gutter : 0,\n          result = viewport + gap - getSliderWidth();\n\n      if (center && !loop) {\n        result = fixedWidth ? -(fixedWidth + gutter) * (slideCountNew - 1) - getCenterGap() : getCenterGap(slideCountNew - 1) - slidePositions[slideCountNew - 1];\n      }\n\n      if (result > 0) {\n        result = 0;\n      }\n\n      return result;\n    }\n\n    function getContainerTransformValue(num) {\n      if (num == null) {\n        num = index;\n      }\n\n      var val;\n\n      if (horizontal && !autoWidth) {\n        if (fixedWidth) {\n          val = -(fixedWidth + gutter) * num;\n\n          if (center) {\n            val += getCenterGap();\n          }\n        } else {\n          var denominator = TRANSFORM ? slideCountNew : items;\n\n          if (center) {\n            num -= getCenterGap();\n          }\n\n          val = -num * 100 / denominator;\n        }\n      } else {\n        val = -slidePositions[num];\n\n        if (center && autoWidth) {\n          val += getCenterGap();\n        }\n      }\n\n      if (hasRightDeadZone) {\n        val = Math.max(val, rightBoundary);\n      }\n\n      val += horizontal && !autoWidth && !fixedWidth ? '%' : 'px';\n      return val;\n    }\n\n    function doContainerTransformSilent(val) {\n      resetDuration(container, '0s');\n      doContainerTransform(val);\n    }\n\n    function doContainerTransform(val) {\n      if (val == null) {\n        val = getContainerTransformValue();\n      }\n\n      container.style[transformAttr] = transformPrefix + val + transformPostfix;\n    }\n\n    function animateSlide(number, classOut, classIn, isOut) {\n      var l = number + items;\n\n      if (!loop) {\n        l = Math.min(l, slideCountNew);\n      }\n\n      for (var i = number; i < l; i++) {\n        var item = slideItems[i]; // set item positions\n\n        if (!isOut) {\n          item.style.left = (i - index) * 100 / items + '%';\n        }\n\n        if (animateDelay && TRANSITIONDELAY) {\n          item.style[TRANSITIONDELAY] = item.style[ANIMATIONDELAY] = animateDelay * (i - number) / 1000 + 's';\n        }\n\n        removeClass(item, classOut);\n        addClass(item, classIn);\n\n        if (isOut) {\n          slideItemsOut.push(item);\n        }\n      }\n    } // make transfer after click/drag:\n    // 1. change 'transform' property for mordern browsers\n    // 2. change 'left' property for legacy browsers\n\n\n    var transformCore = function () {\n      return carousel ? function () {\n        resetDuration(container, '');\n\n        if (TRANSITIONDURATION || !speed) {\n          // for morden browsers with non-zero duration or\n          // zero duration for all browsers\n          doContainerTransform(); // run fallback function manually\n          // when duration is 0 / container is hidden\n\n          if (!speed || !isVisible(container)) {\n            onTransitionEnd();\n          }\n        } else {\n          // for old browser with non-zero duration\n          jsTransform(container, transformAttr, transformPrefix, transformPostfix, getContainerTransformValue(), speed, onTransitionEnd);\n        }\n\n        if (!horizontal) {\n          updateContentWrapperHeight();\n        }\n      } : function () {\n        slideItemsOut = [];\n        var eve = {};\n        eve[TRANSITIONEND] = eve[ANIMATIONEND] = onTransitionEnd;\n        removeEvents(slideItems[indexCached], eve);\n        addEvents(slideItems[index], eve);\n        animateSlide(indexCached, animateIn, animateOut, true);\n        animateSlide(index, animateNormal, animateIn); // run fallback function manually\n        // when transition or animation not supported / duration is 0\n\n        if (!TRANSITIONEND || !ANIMATIONEND || !speed || !isVisible(container)) {\n          onTransitionEnd();\n        }\n      };\n    }();\n\n    function render(e, sliderMoved) {\n      if (updateIndexBeforeTransform) {\n        updateIndex();\n      } // render when slider was moved (touch or drag) even though index may not change\n\n\n      if (index !== indexCached || sliderMoved) {\n        // events\n        events.emit('indexChanged', info());\n        events.emit('transitionStart', info());\n\n        if (autoHeight) {\n          doAutoHeight();\n        } // pause autoplay when click or keydown from user\n\n\n        if (animating && e && ['click', 'keydown'].indexOf(e.type) >= 0) {\n          stopAutoplay();\n        }\n\n        running = true;\n        transformCore();\n      }\n    }\n    /*\n     * Transfer prefixed properties to the same format\n     * CSS: -Webkit-Transform => webkittransform\n     * JS: WebkitTransform => webkittransform\n     * @param {string} str - property\n     *\n     */\n\n\n    function strTrans(str) {\n      return str.toLowerCase().replace(/-/g, '');\n    } // AFTER TRANSFORM\n    // Things need to be done after a transfer:\n    // 1. check index\n    // 2. add classes to visible slide\n    // 3. disable controls buttons when reach the first/last slide in non-loop slider\n    // 4. update nav status\n    // 5. lazyload images\n    // 6. update container height\n\n\n    function onTransitionEnd(event) {\n      // check running on gallery mode\n      // make sure trantionend/animationend events run only once\n      if (carousel || running) {\n        events.emit('transitionEnd', info(event));\n\n        if (!carousel && slideItemsOut.length > 0) {\n          for (var i = 0; i < slideItemsOut.length; i++) {\n            var item = slideItemsOut[i]; // set item positions\n\n            item.style.left = '';\n\n            if (ANIMATIONDELAY && TRANSITIONDELAY) {\n              item.style[ANIMATIONDELAY] = '';\n              item.style[TRANSITIONDELAY] = '';\n            }\n\n            removeClass(item, animateOut);\n            addClass(item, animateNormal);\n          }\n        }\n        /* update slides, nav, controls after checking ...\n         * => legacy browsers who don't support 'event'\n         *    have to check event first, otherwise event.target will cause an error\n         * => or 'gallery' mode:\n         *   + event target is slide item\n         * => or 'carousel' mode:\n         *   + event target is container,\n         *   + event.property is the same with transform attribute\n         */\n\n\n        if (!event || !carousel && event.target.parentNode === container || event.target === container && strTrans(event.propertyName) === strTrans(transformAttr)) {\n          if (!updateIndexBeforeTransform) {\n            var indexTem = index;\n            updateIndex();\n\n            if (index !== indexTem) {\n              events.emit('indexChanged', info());\n              doContainerTransformSilent();\n            }\n          }\n\n          if (nested === 'inner') {\n            events.emit('innerLoaded', info());\n          }\n\n          running = false;\n          indexCached = index;\n        }\n      }\n    } // # ACTIONS\n\n\n    function goTo(targetIndex, e) {\n      if (freeze) {\n        return;\n      } // prev slideBy\n\n\n      if (targetIndex === 'prev') {\n        onControlsClick(e, -1); // next slideBy\n      } else if (targetIndex === 'next') {\n        onControlsClick(e, 1); // go to exact slide\n      } else {\n        if (running) {\n          if (preventActionWhenRunning) {\n            return;\n          } else {\n            onTransitionEnd();\n          }\n        }\n\n        var absIndex = getAbsIndex(),\n            indexGap = 0;\n\n        if (targetIndex === 'first') {\n          indexGap = -absIndex;\n        } else if (targetIndex === 'last') {\n          indexGap = carousel ? slideCount - items - absIndex : slideCount - 1 - absIndex;\n        } else {\n          if (typeof targetIndex !== 'number') {\n            targetIndex = parseInt(targetIndex);\n          }\n\n          if (!isNaN(targetIndex)) {\n            // from directly called goTo function\n            if (!e) {\n              targetIndex = Math.max(0, Math.min(slideCount - 1, targetIndex));\n            }\n\n            indexGap = targetIndex - absIndex;\n          }\n        } // gallery: make sure new page won't overlap with current page\n\n\n        if (!carousel && indexGap && Math.abs(indexGap) < items) {\n          var factor = indexGap > 0 ? 1 : -1;\n          indexGap += index + indexGap - slideCount >= indexMin ? slideCount * factor : slideCount * 2 * factor * -1;\n        }\n\n        index += indexGap; // make sure index is in range\n\n        if (carousel && loop) {\n          if (index < indexMin) {\n            index += slideCount;\n          }\n\n          if (index > indexMax) {\n            index -= slideCount;\n          }\n        } // if index is changed, start rendering\n\n\n        if (getAbsIndex(index) !== getAbsIndex(indexCached)) {\n          render(e);\n        }\n      }\n    } // on controls click\n\n\n    function onControlsClick(e, dir) {\n      if (running) {\n        if (preventActionWhenRunning) {\n          return;\n        } else {\n          onTransitionEnd();\n        }\n      }\n\n      var passEventObject;\n\n      if (!dir) {\n        e = getEvent(e);\n        var target = getTarget(e);\n\n        while (target !== controlsContainer && [prevButton, nextButton].indexOf(target) < 0) {\n          target = target.parentNode;\n        }\n\n        var targetIn = [prevButton, nextButton].indexOf(target);\n\n        if (targetIn >= 0) {\n          passEventObject = true;\n          dir = targetIn === 0 ? -1 : 1;\n        }\n      }\n\n      if (rewind) {\n        if (index === indexMin && dir === -1) {\n          goTo('last', e);\n          return;\n        } else if (index === indexMax && dir === 1) {\n          goTo('first', e);\n          return;\n        }\n      }\n\n      if (dir) {\n        index += slideBy * dir;\n\n        if (autoWidth) {\n          index = Math.floor(index);\n        } // pass e when click control buttons or keydown\n\n\n        render(passEventObject || e && e.type === 'keydown' ? e : null);\n      }\n    } // on nav click\n\n\n    function onNavClick(e) {\n      if (running) {\n        if (preventActionWhenRunning) {\n          return;\n        } else {\n          onTransitionEnd();\n        }\n      }\n\n      e = getEvent(e);\n      var target = getTarget(e),\n          navIndex; // find the clicked nav item\n\n      while (target !== navContainer && !hasAttr(target, 'data-nav')) {\n        target = target.parentNode;\n      }\n\n      if (hasAttr(target, 'data-nav')) {\n        var navIndex = navClicked = Number(getAttr(target, 'data-nav')),\n            targetIndexBase = fixedWidth || autoWidth ? navIndex * slideCount / pages : navIndex * items,\n            targetIndex = navAsThumbnails ? navIndex : Math.min(Math.ceil(targetIndexBase), slideCount - 1);\n        goTo(targetIndex, e);\n\n        if (navCurrentIndex === navIndex) {\n          if (animating) {\n            stopAutoplay();\n          }\n\n          navClicked = -1; // reset navClicked\n        }\n      }\n    } // autoplay functions\n\n\n    function setAutoplayTimer() {\n      autoplayTimer = setInterval(function () {\n        onControlsClick(null, autoplayDirection);\n      }, autoplayTimeout);\n      animating = true;\n    }\n\n    function stopAutoplayTimer() {\n      clearInterval(autoplayTimer);\n      animating = false;\n    }\n\n    function updateAutoplayButton(action, txt) {\n      setAttrs(autoplayButton, {\n        'data-action': action\n      });\n      autoplayButton.innerHTML = autoplayHtmlStrings[0] + action + autoplayHtmlStrings[1] + txt;\n    }\n\n    function startAutoplay() {\n      setAutoplayTimer();\n\n      if (autoplayButton) {\n        updateAutoplayButton('stop', autoplayText[1]);\n      }\n    }\n\n    function stopAutoplay() {\n      stopAutoplayTimer();\n\n      if (autoplayButton) {\n        updateAutoplayButton('start', autoplayText[0]);\n      }\n    } // programaitcally play/pause the slider\n\n\n    function play() {\n      if (autoplay && !animating) {\n        startAutoplay();\n        autoplayUserPaused = false;\n      }\n    }\n\n    function pause() {\n      if (animating) {\n        stopAutoplay();\n        autoplayUserPaused = true;\n      }\n    }\n\n    function toggleAutoplay() {\n      if (animating) {\n        stopAutoplay();\n        autoplayUserPaused = true;\n      } else {\n        startAutoplay();\n        autoplayUserPaused = false;\n      }\n    }\n\n    function onVisibilityChange() {\n      if (doc.hidden) {\n        if (animating) {\n          stopAutoplayTimer();\n          autoplayVisibilityPaused = true;\n        }\n      } else if (autoplayVisibilityPaused) {\n        setAutoplayTimer();\n        autoplayVisibilityPaused = false;\n      }\n    }\n\n    function mouseoverPause() {\n      if (animating) {\n        stopAutoplayTimer();\n        autoplayHoverPaused = true;\n      }\n    }\n\n    function mouseoutRestart() {\n      if (autoplayHoverPaused) {\n        setAutoplayTimer();\n        autoplayHoverPaused = false;\n      }\n    } // keydown events on document\n\n\n    function onDocumentKeydown(e) {\n      e = getEvent(e);\n      var keyIndex = [KEYS.LEFT, KEYS.RIGHT].indexOf(e.keyCode);\n\n      if (keyIndex >= 0) {\n        onControlsClick(e, keyIndex === 0 ? -1 : 1);\n      }\n    } // on key control\n\n\n    function onControlsKeydown(e) {\n      e = getEvent(e);\n      var keyIndex = [KEYS.LEFT, KEYS.RIGHT].indexOf(e.keyCode);\n\n      if (keyIndex >= 0) {\n        if (keyIndex === 0) {\n          if (!prevButton.disabled) {\n            onControlsClick(e, -1);\n          }\n        } else if (!nextButton.disabled) {\n          onControlsClick(e, 1);\n        }\n      }\n    } // set focus\n\n\n    function setFocus(el) {\n      el.focus();\n    } // on key nav\n\n\n    function onNavKeydown(e) {\n      e = getEvent(e);\n      var curElement = doc.activeElement;\n\n      if (!hasAttr(curElement, 'data-nav')) {\n        return;\n      } // var code = e.keyCode,\n\n\n      var keyIndex = [KEYS.LEFT, KEYS.RIGHT, KEYS.ENTER, KEYS.SPACE].indexOf(e.keyCode),\n          navIndex = Number(getAttr(curElement, 'data-nav'));\n\n      if (keyIndex >= 0) {\n        if (keyIndex === 0) {\n          if (navIndex > 0) {\n            setFocus(navItems[navIndex - 1]);\n          }\n        } else if (keyIndex === 1) {\n          if (navIndex < pages - 1) {\n            setFocus(navItems[navIndex + 1]);\n          }\n        } else {\n          navClicked = navIndex;\n          goTo(navIndex, e);\n        }\n      }\n    }\n\n    function getEvent(e) {\n      e = e || win.event;\n      return isTouchEvent(e) ? e.changedTouches[0] : e;\n    }\n\n    function getTarget(e) {\n      return e.target || win.event.srcElement;\n    }\n\n    function isTouchEvent(e) {\n      return e.type.indexOf('touch') >= 0;\n    }\n\n    function preventDefaultBehavior(e) {\n      e.preventDefault ? e.preventDefault() : e.returnValue = false;\n    }\n\n    function getMoveDirectionExpected() {\n      return getTouchDirection(toDegree(lastPosition.y - initPosition.y, lastPosition.x - initPosition.x), swipeAngle) === options.axis;\n    }\n\n    function onPanStart(e) {\n      if (running) {\n        if (preventActionWhenRunning) {\n          return;\n        } else {\n          onTransitionEnd();\n        }\n      }\n\n      if (autoplay && animating) {\n        stopAutoplayTimer();\n      }\n\n      panStart = true;\n\n      if (rafIndex) {\n        caf(rafIndex);\n        rafIndex = null;\n      }\n\n      var $ = getEvent(e);\n      events.emit(isTouchEvent(e) ? 'touchStart' : 'dragStart', info(e));\n\n      if (!isTouchEvent(e) && ['img', 'a'].indexOf(getLowerCaseNodeName(getTarget(e))) >= 0) {\n        preventDefaultBehavior(e);\n      }\n\n      lastPosition.x = initPosition.x = $.clientX;\n      lastPosition.y = initPosition.y = $.clientY;\n\n      if (carousel) {\n        translateInit = parseFloat(container.style[transformAttr].replace(transformPrefix, ''));\n        resetDuration(container, '0s');\n      }\n    }\n\n    function onPanMove(e) {\n      if (panStart) {\n        var $ = getEvent(e);\n        lastPosition.x = $.clientX;\n        lastPosition.y = $.clientY;\n\n        if (carousel) {\n          if (!rafIndex) {\n            rafIndex = raf(function () {\n              panUpdate(e);\n            });\n          }\n        } else {\n          if (moveDirectionExpected === '?') {\n            moveDirectionExpected = getMoveDirectionExpected();\n          }\n\n          if (moveDirectionExpected) {\n            preventScroll = true;\n          }\n        }\n\n        if ((typeof e.cancelable !== 'boolean' || e.cancelable) && preventScroll) {\n          e.preventDefault();\n        }\n      }\n    }\n\n    function panUpdate(e) {\n      if (!moveDirectionExpected) {\n        panStart = false;\n        return;\n      }\n\n      caf(rafIndex);\n\n      if (panStart) {\n        rafIndex = raf(function () {\n          panUpdate(e);\n        });\n      }\n\n      if (moveDirectionExpected === '?') {\n        moveDirectionExpected = getMoveDirectionExpected();\n      }\n\n      if (moveDirectionExpected) {\n        if (!preventScroll && isTouchEvent(e)) {\n          preventScroll = true;\n        }\n\n        try {\n          if (e.type) {\n            events.emit(isTouchEvent(e) ? 'touchMove' : 'dragMove', info(e));\n          }\n        } catch (err) {}\n\n        var x = translateInit,\n            dist = getDist(lastPosition, initPosition);\n\n        if (!horizontal || fixedWidth || autoWidth) {\n          x += dist;\n          x += 'px';\n        } else {\n          var percentageX = TRANSFORM ? dist * items * 100 / ((viewport + gutter) * slideCountNew) : dist * 100 / (viewport + gutter);\n          x += percentageX;\n          x += '%';\n        }\n\n        container.style[transformAttr] = transformPrefix + x + transformPostfix;\n      }\n    }\n\n    function onPanEnd(e) {\n      if (panStart) {\n        if (rafIndex) {\n          caf(rafIndex);\n          rafIndex = null;\n        }\n\n        if (carousel) {\n          resetDuration(container, '');\n        }\n\n        panStart = false;\n        var $ = getEvent(e);\n        lastPosition.x = $.clientX;\n        lastPosition.y = $.clientY;\n        var dist = getDist(lastPosition, initPosition);\n\n        if (Math.abs(dist)) {\n          // drag vs click\n          if (!isTouchEvent(e)) {\n            // prevent \"click\"\n            var target = getTarget(e);\n            addEvents(target, {\n              'click': function preventClick(e) {\n                preventDefaultBehavior(e);\n                removeEvents(target, {\n                  'click': preventClick\n                });\n              }\n            });\n          }\n\n          if (carousel) {\n            rafIndex = raf(function () {\n              if (horizontal && !autoWidth) {\n                var indexMoved = -dist * items / (viewport + gutter);\n                indexMoved = dist > 0 ? Math.floor(indexMoved) : Math.ceil(indexMoved);\n                index += indexMoved;\n              } else {\n                var moved = -(translateInit + dist);\n\n                if (moved <= 0) {\n                  index = indexMin;\n                } else if (moved >= slidePositions[slideCountNew - 1]) {\n                  index = indexMax;\n                } else {\n                  var i = 0;\n\n                  while (i < slideCountNew && moved >= slidePositions[i]) {\n                    index = i;\n\n                    if (moved > slidePositions[i] && dist < 0) {\n                      index += 1;\n                    }\n\n                    i++;\n                  }\n                }\n              }\n\n              render(e, dist);\n              events.emit(isTouchEvent(e) ? 'touchEnd' : 'dragEnd', info(e));\n            });\n          } else {\n            if (moveDirectionExpected) {\n              onControlsClick(e, dist > 0 ? -1 : 1);\n            }\n          }\n        }\n      } // reset\n\n\n      if (options.preventScrollOnTouch === 'auto') {\n        preventScroll = false;\n      }\n\n      if (swipeAngle) {\n        moveDirectionExpected = '?';\n      }\n\n      if (autoplay && !animating) {\n        setAutoplayTimer();\n      }\n    } // === RESIZE FUNCTIONS === //\n    // (slidePositions, index, items) => vertical_conentWrapper.height\n\n\n    function updateContentWrapperHeight() {\n      var wp = middleWrapper ? middleWrapper : innerWrapper;\n      wp.style.height = slidePositions[index + items] - slidePositions[index] + 'px';\n    }\n\n    function getPages() {\n      var rough = fixedWidth ? (fixedWidth + gutter) * slideCount / viewport : slideCount / items;\n      return Math.min(Math.ceil(rough), slideCount);\n    }\n    /*\n     * 1. update visible nav items list\n     * 2. add \"hidden\" attributes to previous visible nav items\n     * 3. remove \"hidden\" attrubutes to new visible nav items\n     */\n\n\n    function updateNavVisibility() {\n      if (!nav || navAsThumbnails) {\n        return;\n      }\n\n      if (pages !== pagesCached) {\n        var min = pagesCached,\n            max = pages,\n            fn = showElement;\n\n        if (pagesCached > pages) {\n          min = pages;\n          max = pagesCached;\n          fn = hideElement;\n        }\n\n        while (min < max) {\n          fn(navItems[min]);\n          min++;\n        } // cache pages\n\n\n        pagesCached = pages;\n      }\n    }\n\n    function info(e) {\n      return {\n        container: container,\n        slideItems: slideItems,\n        navContainer: navContainer,\n        navItems: navItems,\n        controlsContainer: controlsContainer,\n        hasControls: hasControls,\n        prevButton: prevButton,\n        nextButton: nextButton,\n        items: items,\n        slideBy: slideBy,\n        cloneCount: cloneCount,\n        slideCount: slideCount,\n        slideCountNew: slideCountNew,\n        index: index,\n        indexCached: indexCached,\n        displayIndex: getCurrentSlide(),\n        navCurrentIndex: navCurrentIndex,\n        navCurrentIndexCached: navCurrentIndexCached,\n        pages: pages,\n        pagesCached: pagesCached,\n        sheet: sheet,\n        isOn: isOn,\n        event: e || {}\n      };\n    }\n\n    return {\n      version: '2.9.3',\n      getInfo: info,\n      events: events,\n      goTo: goTo,\n      play: play,\n      pause: pause,\n      isOn: isOn,\n      updateSliderHeight: updateInnerWrapperHeight,\n      refresh: initSliderTransform,\n      destroy: destroy,\n      rebuild: function () {\n        return tns(extend(options, optionsElements));\n      }\n    };\n  };\n\n  return tns;\n}();","map":{"version":3,"sources":["C:/Users/Matheus/Desktop/ProjetoDotDigital/ProjetoReact/projeto-react/node_modules/tiny-slider/dist/tiny-slider.js"],"names":["tns","win","window","raf","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","msRequestAnimationFrame","cb","setTimeout","win$1","caf","cancelAnimationFrame","mozCancelAnimationFrame","id","clearTimeout","extend","obj","name","copy","target","arguments","i","length","undefined","checkStorageValue","value","indexOf","JSON","parse","setLocalStorage","storage","key","access","setItem","e","getSlideId","tnsId","getBody","doc","document","body","createElement","fake","docElement","documentElement","setFakeBody","docOverflow","style","overflow","background","appendChild","resetFakeBody","remove","offsetHeight","calc","div","result","str","vals","val","width","offsetWidth","replace","percentageLayout","wrapper","outer","count","perPage","supported","className","innerHTML","Math","abs","getBoundingClientRect","left","children","mediaquerySupport","matchMedia","msMatchMedia","rule","position","type","styleSheet","cssText","createTextNode","getComputedStyle","currentStyle","createStyleSheet","media","nonce","setAttribute","querySelector","sheet","addCSSRule","selector","rules","index","insertRule","addRule","removeCSSRule","deleteRule","removeRule","getCssRulesLength","cssRules","toDegree","y","x","atan2","PI","getTouchDirection","angle","range","direction","gap","forEach","arr","callback","scope","l","call","classListSupport","hasClass","el","classList","contains","addClass","add","removeClass","hasAttr","attr","hasAttribute","getAttr","getAttribute","isNodeList","item","setAttrs","els","attrs","Array","Object","prototype","toString","removeAttrs","attrLength","j","removeAttribute","arrayFromNodeList","nl","push","hideElement","forceHide","display","showElement","isVisible","whichProperty","props","Props","charAt","toUpperCase","substr","prefixes","prefix","len","prop","has3DTransforms","tf","has3d","cssTF","slice","toLowerCase","insertBefore","getPropertyValue","getEndProperty","propIn","propOut","endProp","test","supportsPassive","opts","defineProperty","get","addEventListener","passiveOption","passive","addEvents","preventScrolling","option","removeEvents","removeEventListener","Events","topics","on","eventName","fn","off","splice","emit","data","jsTransform","element","postfix","to","duration","tick","min","unit","from","Number","positionTick","running","moveElement","keys","object","hasOwnProperty","Element","parentNode","removeChild","options","container","mode","axis","items","gutter","edgePadding","fixedWidth","autoWidth","viewportMax","slideBy","center","controls","controlsPosition","controlsText","controlsContainer","prevButton","nextButton","nav","navPosition","navContainer","navAsThumbnails","arrowKeys","speed","autoplay","autoplayPosition","autoplayTimeout","autoplayDirection","autoplayText","autoplayHoverPause","autoplayButton","autoplayButtonOutput","autoplayResetOnVisibility","animateIn","animateOut","animateNormal","animateDelay","loop","rewind","autoHeight","responsive","lazyload","lazyloadSelector","touch","mouseDrag","swipeAngle","nested","preventActionWhenRunning","preventScrollOnTouch","freezable","onInit","useLocalStorage","KEYS","ENTER","SPACE","LEFT","RIGHT","tnsStorage","localStorageAccess","browserInfo","navigator","userAgent","uid","Date","localStorage","getItem","removeItem","CALC","PERCENTAGELAYOUT","CSSMQ","TRANSFORM","HAS3DTRANSFORMS","TRANSITIONDURATION","TRANSITIONDELAY","ANIMATIONDURATION","ANIMATIONDELAY","TRANSITIONEND","ANIMATIONEND","supportConsoleWarn","console","warn","tnsList","optionsElements","nodeName","carousel","responsiveTem","updateOptions","horizontal","outerWrapper","innerWrapper","middleWrapper","containerParent","containerHTML","outerHTML","slideItems","slideCount","breakpointZone","windowWidth","getWindowWidth","isOn","setBreakpointZone","getOption","viewport","getViewportWidth","floor","fixedWidthViewportWidth","slidePositions","slideItemsOut","cloneCount","getCloneCountForLoop","slideCountNew","hasRightDeadZone","rightBoundary","getRightBoundary","updateIndexBeforeTransform","transformAttr","transformPrefix","transformPostfix","getIndexMax","ceil","max","getStartIndex","indexCached","displayIndex","getCurrentSlide","indexMin","indexMax","resizeTimer","moveDirectionExpected","events","newContainerClasses","slideId","disable","disabled","freeze","getFreeze","frozen","controlsEvents","onControlsClick","onControlsKeydown","navEvents","onNavClick","onNavKeydown","hoverEvents","mouseoverPause","mouseoutRestart","visibilityEvent","onVisibilityChange","docmentKeydownEvent","onDocumentKeydown","touchEvents","onPanStart","onPanMove","onPanEnd","dragEvents","hasControls","hasOption","hasNav","hasAutoplay","hasTouch","hasMouseDrag","slideActiveClass","slideClonedClass","imgCompleteClass","imgEvents","onImgLoaded","onImgFailed","imgsComplete","liveregionCurrent","preventScroll","controlsContainerHTML","prevButtonHTML","nextButtonHTML","prevIsButton","nextIsButton","navContainerHTML","navItems","pages","getPages","pagesCached","navClicked","navCurrentIndex","getCurrentNavIndex","navCurrentIndexCached","navActiveClass","navStr","navStrCurrent","autoplayButtonHTML","autoplayHtmlStrings","autoplayTimer","animating","autoplayHoverPaused","autoplayUserPaused","autoplayVisibilityPaused","initPosition","lastPosition","translateInit","disX","disY","panStart","rafIndex","getDist","a","b","resetVariblesWhenDisable","initStructure","initSheet","initSliderTransform","condition","tem","ind","getAbsIndex","absIndex","getItemsMax","bp","apply","itemsMax","innerWidth","clientWidth","getInsertPosition","pos","getClientWidth","rect","right","ww","parseInt","getSlideMarginLeft","getInnerWrapperStyles","edgePaddingTem","gutterTem","fixedWidthTem","speedTem","autoHeightBP","gutterTemUnit","dir","getTransitionDurationStyle","getContainerWidth","itemsTem","getSlideWidthStyle","dividend","getSlideGutterStyle","getCSSPrefix","num","substring","getAnimationDurationStyle","classOuter","classInner","hasGutter","wp","fragmentBefore","createDocumentFragment","fragmentAfter","cloneFirst","cloneNode","firstChild","cloneLast","imgs","querySelectorAll","img","src","imgLoaded","imgsLoadedCheck","getImageArray","initSliderTransformStyleCheck","doContainerTransformSilent","initTools","initEvents","stylesApplicationCheck","initSliderTransformCore","setSlidePositions","updateContentWrapperHeight","fontSize","slide","marginLeft","update_carousel_transition_duration","middleWrapperStr","innerWrapperStr","containerStr","slideStr","itemsBP","fixedWidthBP","speedBP","edgePaddingBP","gutterBP","updateSlideStatus","insertAdjacentHTML","getLiveRegionStr","txt","toggleAutoplay","startAutoplay","initIndex","navHtml","hiddenStr","updateNavVisibility","isButton","updateControlsStatus","disableUI","eve","onTransitionEnd","resizeTasks","info","onResize","doAutoHeight","doLazyLoad","disableSlider","freezeSlider","additionalUpdates","destroy","ownerNode","clearInterval","htmlList","prevEl","previousElementSibling","parentEl","nextElementSibling","firstElementChild","getEvent","bpChanged","breakpointZoneTem","needContainerTransform","indChanged","itemsChanged","disableTem","freezeTem","arrowKeysTem","controlsTem","navTem","touchTem","mouseDragTem","autoplayTem","autoplayHoverPauseTem","autoplayResetOnVisibilityTem","indexTem","autoHeightTem","controlsTextTem","centerTem","autoplayTextTem","updateIndex","enableSlider","doContainerTransform","getContainerTransformValue","unfreezeSlider","stopAutoplay","height","html","updateLiveRegion","updateGallerySlidePositions","vp","leftEdge","rightEdge","enableUI","margin","classN","getVisibleSlideRange","start","end","rangestart","rangeend","parseFloat","point","cell","arg","stopPropagation","srcset","getTarget","imgFailed","imgCompleted","imgSelector","updateInnerWrapperHeight","complete","updateNavStatus","getMaxSlideHeight","slideStart","slideRange","heights","maxHeight","attr2","base","navPrev","navCurrent","getLowerCaseNodeName","isAriaDisabled","disEnableElement","prevDisabled","nextDisabled","disablePrev","disableNext","resetDuration","getSliderWidth","getCenterGap","denominator","animateSlide","number","classOut","classIn","isOut","transformCore","render","sliderMoved","strTrans","event","propertyName","goTo","targetIndex","indexGap","isNaN","factor","passEventObject","targetIn","navIndex","targetIndexBase","setAutoplayTimer","setInterval","stopAutoplayTimer","updateAutoplayButton","action","play","pause","hidden","keyIndex","keyCode","setFocus","focus","curElement","activeElement","isTouchEvent","changedTouches","srcElement","preventDefaultBehavior","preventDefault","returnValue","getMoveDirectionExpected","$","clientX","clientY","panUpdate","cancelable","err","dist","percentageX","preventClick","indexMoved","moved","rough","version","getInfo","updateSliderHeight","refresh","rebuild"],"mappings":"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","sourcesContent":["var tns = (function (){\nvar win = window;\n\nvar raf = win.requestAnimationFrame\n  || win.webkitRequestAnimationFrame\n  || win.mozRequestAnimationFrame\n  || win.msRequestAnimationFrame\n  || function(cb) { return setTimeout(cb, 16); };\n\nvar win$1 = window;\n\nvar caf = win$1.cancelAnimationFrame\n  || win$1.mozCancelAnimationFrame\n  || function(id){ clearTimeout(id); };\n\nfunction extend() {\n  var obj, name, copy,\n      target = arguments[0] || {},\n      i = 1,\n      length = arguments.length;\n\n  for (; i < length; i++) {\n    if ((obj = arguments[i]) !== null) {\n      for (name in obj) {\n        copy = obj[name];\n\n        if (target === copy) {\n          continue;\n        } else if (copy !== undefined) {\n          target[name] = copy;\n        }\n      }\n    }\n  }\n  return target;\n}\n\nfunction checkStorageValue (value) {\n  return ['true', 'false'].indexOf(value) >= 0 ? JSON.parse(value) : value;\n}\n\nfunction setLocalStorage(storage, key, value, access) {\n  if (access) {\n    try { storage.setItem(key, value); } catch (e) {}\n  }\n  return value;\n}\n\nfunction getSlideId() {\n  var id = window.tnsId;\n  window.tnsId = !id ? 1 : id + 1;\n  \n  return 'tns' + window.tnsId;\n}\n\nfunction getBody () {\n  var doc = document,\n      body = doc.body;\n\n  if (!body) {\n    body = doc.createElement('body');\n    body.fake = true;\n  }\n\n  return body;\n}\n\nvar docElement = document.documentElement;\n\nfunction setFakeBody (body) {\n  var docOverflow = '';\n  if (body.fake) {\n    docOverflow = docElement.style.overflow;\n    //avoid crashing IE8, if background image is used\n    body.style.background = '';\n    //Safari 5.13/5.1.4 OSX stops loading if ::-webkit-scrollbar is used and scrollbars are visible\n    body.style.overflow = docElement.style.overflow = 'hidden';\n    docElement.appendChild(body);\n  }\n\n  return docOverflow;\n}\n\nfunction resetFakeBody (body, docOverflow) {\n  if (body.fake) {\n    body.remove();\n    docElement.style.overflow = docOverflow;\n    // Trigger layout so kinetic scrolling isn't disabled in iOS6+\n    // eslint-disable-next-line\n    docElement.offsetHeight;\n  }\n}\n\n// get css-calc \n\nfunction calc() {\n  var doc = document, \n      body = getBody(),\n      docOverflow = setFakeBody(body),\n      div = doc.createElement('div'), \n      result = false;\n\n  body.appendChild(div);\n  try {\n    var str = '(10px * 10)',\n        vals = ['calc' + str, '-moz-calc' + str, '-webkit-calc' + str],\n        val;\n    for (var i = 0; i < 3; i++) {\n      val = vals[i];\n      div.style.width = val;\n      if (div.offsetWidth === 100) { \n        result = val.replace(str, ''); \n        break;\n      }\n    }\n  } catch (e) {}\n  \n  body.fake ? resetFakeBody(body, docOverflow) : div.remove();\n\n  return result;\n}\n\n// get subpixel support value\n\nfunction percentageLayout() {\n  // check subpixel layout supporting\n  var doc = document,\n      body = getBody(),\n      docOverflow = setFakeBody(body),\n      wrapper = doc.createElement('div'),\n      outer = doc.createElement('div'),\n      str = '',\n      count = 70,\n      perPage = 3,\n      supported = false;\n\n  wrapper.className = \"tns-t-subp2\";\n  outer.className = \"tns-t-ct\";\n\n  for (var i = 0; i < count; i++) {\n    str += '<div></div>';\n  }\n\n  outer.innerHTML = str;\n  wrapper.appendChild(outer);\n  body.appendChild(wrapper);\n\n  supported = Math.abs(wrapper.getBoundingClientRect().left - outer.children[count - perPage].getBoundingClientRect().left) < 2;\n\n  body.fake ? resetFakeBody(body, docOverflow) : wrapper.remove();\n\n  return supported;\n}\n\nfunction mediaquerySupport () {\n  if (window.matchMedia || window.msMatchMedia) {\n    return true;\n  }\n  \n  var doc = document,\n      body = getBody(),\n      docOverflow = setFakeBody(body),\n      div = doc.createElement('div'),\n      style = doc.createElement('style'),\n      rule = '@media all and (min-width:1px){.tns-mq-test{position:absolute}}',\n      position;\n\n  style.type = 'text/css';\n  div.className = 'tns-mq-test';\n\n  body.appendChild(style);\n  body.appendChild(div);\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = rule;\n  } else {\n    style.appendChild(doc.createTextNode(rule));\n  }\n\n  position = window.getComputedStyle ? window.getComputedStyle(div).position : div.currentStyle['position'];\n\n  body.fake ? resetFakeBody(body, docOverflow) : div.remove();\n\n  return position === \"absolute\";\n}\n\n// create and append style sheet\nfunction createStyleSheet (media, nonce) {\n  // Create the <style> tag\n  var style = document.createElement(\"style\");\n  // style.setAttribute(\"type\", \"text/css\");\n\n  // Add a media (and/or media query) here if you'd like!\n  // style.setAttribute(\"media\", \"screen\")\n  // style.setAttribute(\"media\", \"only screen and (max-width : 1024px)\")\n  if (media) { style.setAttribute(\"media\", media); }\n\n  // Add nonce attribute for Content Security Policy\n  if (nonce) { style.setAttribute(\"nonce\", nonce); }\n\n  // WebKit hack :(\n  // style.appendChild(document.createTextNode(\"\"));\n\n  // Add the <style> element to the page\n  document.querySelector('head').appendChild(style);\n\n  return style.sheet ? style.sheet : style.styleSheet;\n}\n\n// cross browsers addRule method\nfunction addCSSRule(sheet, selector, rules, index) {\n  // return raf(function() {\n    'insertRule' in sheet ?\n      sheet.insertRule(selector + '{' + rules + '}', index) :\n      sheet.addRule(selector, rules, index);\n  // });\n}\n\n// cross browsers addRule method\nfunction removeCSSRule(sheet, index) {\n  // return raf(function() {\n    'deleteRule' in sheet ?\n      sheet.deleteRule(index) :\n      sheet.removeRule(index);\n  // });\n}\n\nfunction getCssRulesLength(sheet) {\n  var rule = ('insertRule' in sheet) ? sheet.cssRules : sheet.rules;\n  return rule.length;\n}\n\nfunction toDegree (y, x) {\n  return Math.atan2(y, x) * (180 / Math.PI);\n}\n\nfunction getTouchDirection(angle, range) {\n  var direction = false,\n      gap = Math.abs(90 - Math.abs(angle));\n      \n  if (gap >= 90 - range) {\n    direction = 'horizontal';\n  } else if (gap <= range) {\n    direction = 'vertical';\n  }\n\n  return direction;\n}\n\n// https://toddmotto.com/ditch-the-array-foreach-call-nodelist-hack/\nfunction forEach (arr, callback, scope) {\n  for (var i = 0, l = arr.length; i < l; i++) {\n    callback.call(scope, arr[i], i);\n  }\n}\n\nvar classListSupport = 'classList' in document.createElement('_');\n\nvar hasClass = classListSupport ?\n    function (el, str) { return el.classList.contains(str); } :\n    function (el, str) { return el.className.indexOf(str) >= 0; };\n\nvar addClass = classListSupport ?\n    function (el, str) {\n      if (!hasClass(el,  str)) { el.classList.add(str); }\n    } :\n    function (el, str) {\n      if (!hasClass(el,  str)) { el.className += ' ' + str; }\n    };\n\nvar removeClass = classListSupport ?\n    function (el, str) {\n      if (hasClass(el,  str)) { el.classList.remove(str); }\n    } :\n    function (el, str) {\n      if (hasClass(el, str)) { el.className = el.className.replace(str, ''); }\n    };\n\nfunction hasAttr(el, attr) {\n  return el.hasAttribute(attr);\n}\n\nfunction getAttr(el, attr) {\n  return el.getAttribute(attr);\n}\n\nfunction isNodeList(el) {\n  // Only NodeList has the \"item()\" function\n  return typeof el.item !== \"undefined\"; \n}\n\nfunction setAttrs(els, attrs) {\n  els = (isNodeList(els) || els instanceof Array) ? els : [els];\n  if (Object.prototype.toString.call(attrs) !== '[object Object]') { return; }\n\n  for (var i = els.length; i--;) {\n    for(var key in attrs) {\n      els[i].setAttribute(key, attrs[key]);\n    }\n  }\n}\n\nfunction removeAttrs(els, attrs) {\n  els = (isNodeList(els) || els instanceof Array) ? els : [els];\n  attrs = (attrs instanceof Array) ? attrs : [attrs];\n\n  var attrLength = attrs.length;\n  for (var i = els.length; i--;) {\n    for (var j = attrLength; j--;) {\n      els[i].removeAttribute(attrs[j]);\n    }\n  }\n}\n\nfunction arrayFromNodeList (nl) {\n  var arr = [];\n  for (var i = 0, l = nl.length; i < l; i++) {\n    arr.push(nl[i]);\n  }\n  return arr;\n}\n\nfunction hideElement(el, forceHide) {\n  if (el.style.display !== 'none') { el.style.display = 'none'; }\n}\n\nfunction showElement(el, forceHide) {\n  if (el.style.display === 'none') { el.style.display = ''; }\n}\n\nfunction isVisible(el) {\n  return window.getComputedStyle(el).display !== 'none';\n}\n\nfunction whichProperty(props){\n  if (typeof props === 'string') {\n    var arr = [props],\n        Props = props.charAt(0).toUpperCase() + props.substr(1),\n        prefixes = ['Webkit', 'Moz', 'ms', 'O'];\n        \n    prefixes.forEach(function(prefix) {\n      if (prefix !== 'ms' || props === 'transform') {\n        arr.push(prefix + Props);\n      }\n    });\n\n    props = arr;\n  }\n\n  var el = document.createElement('fakeelement'),\n      len = props.length;\n  for(var i = 0; i < props.length; i++){\n    var prop = props[i];\n    if( el.style[prop] !== undefined ){ return prop; }\n  }\n\n  return false; // explicit for ie9-\n}\n\nfunction has3DTransforms(tf){\n  if (!tf) { return false; }\n  if (!window.getComputedStyle) { return false; }\n  \n  var doc = document,\n      body = getBody(),\n      docOverflow = setFakeBody(body),\n      el = doc.createElement('p'),\n      has3d,\n      cssTF = tf.length > 9 ? '-' + tf.slice(0, -9).toLowerCase() + '-' : '';\n\n  cssTF += 'transform';\n\n  // Add it to the body to get the computed style\n  body.insertBefore(el, null);\n\n  el.style[tf] = 'translate3d(1px,1px,1px)';\n  has3d = window.getComputedStyle(el).getPropertyValue(cssTF);\n\n  body.fake ? resetFakeBody(body, docOverflow) : el.remove();\n\n  return (has3d !== undefined && has3d.length > 0 && has3d !== \"none\");\n}\n\n// get transitionend, animationend based on transitionDuration\n// @propin: string\n// @propOut: string, first-letter uppercase\n// Usage: getEndProperty('WebkitTransitionDuration', 'Transition') => webkitTransitionEnd\nfunction getEndProperty(propIn, propOut) {\n  var endProp = false;\n  if (/^Webkit/.test(propIn)) {\n    endProp = 'webkit' + propOut + 'End';\n  } else if (/^O/.test(propIn)) {\n    endProp = 'o' + propOut + 'End';\n  } else if (propIn) {\n    endProp = propOut.toLowerCase() + 'end';\n  }\n  return endProp;\n}\n\n// Test via a getter in the options object to see if the passive property is accessed\nvar supportsPassive = false;\ntry {\n  var opts = Object.defineProperty({}, 'passive', {\n    get: function() {\n      supportsPassive = true;\n    }\n  });\n  window.addEventListener(\"test\", null, opts);\n} catch (e) {}\nvar passiveOption = supportsPassive ? { passive: true } : false;\n\nfunction addEvents(el, obj, preventScrolling) {\n  for (var prop in obj) {\n    var option = ['touchstart', 'touchmove'].indexOf(prop) >= 0 && !preventScrolling ? passiveOption : false;\n    el.addEventListener(prop, obj[prop], option);\n  }\n}\n\nfunction removeEvents(el, obj) {\n  for (var prop in obj) {\n    var option = ['touchstart', 'touchmove'].indexOf(prop) >= 0 ? passiveOption : false;\n    el.removeEventListener(prop, obj[prop], option);\n  }\n}\n\nfunction Events() {\n  return {\n    topics: {},\n    on: function (eventName, fn) {\n      this.topics[eventName] = this.topics[eventName] || [];\n      this.topics[eventName].push(fn);\n    },\n    off: function(eventName, fn) {\n      if (this.topics[eventName]) {\n        for (var i = 0; i < this.topics[eventName].length; i++) {\n          if (this.topics[eventName][i] === fn) {\n            this.topics[eventName].splice(i, 1);\n            break;\n          }\n        }\n      }\n    },\n    emit: function (eventName, data) {\n      data.type = eventName;\n      if (this.topics[eventName]) {\n        this.topics[eventName].forEach(function(fn) {\n          fn(data, eventName);\n        });\n      }\n    }\n  };\n}\n\nfunction jsTransform(element, attr, prefix, postfix, to, duration, callback) {\n  var tick = Math.min(duration, 10),\n      unit = (to.indexOf('%') >= 0) ? '%' : 'px',\n      to = to.replace(unit, ''),\n      from = Number(element.style[attr].replace(prefix, '').replace(postfix, '').replace(unit, '')),\n      positionTick = (to - from) / duration * tick,\n      running;\n\n  setTimeout(moveElement, tick);\n  function moveElement() {\n    duration -= tick;\n    from += positionTick;\n    element.style[attr] = prefix + from + unit + postfix;\n    if (duration > 0) { \n      setTimeout(moveElement, tick); \n    } else {\n      callback();\n    }\n  }\n}\n\n// Object.keys\nif (!Object.keys) {\n  Object.keys = function(object) {\n    var keys = [];\n    for (var name in object) {\n      if (Object.prototype.hasOwnProperty.call(object, name)) {\n        keys.push(name);\n      }\n    }\n    return keys;\n  };\n}\n\n// ChildNode.remove\nif(!(\"remove\" in Element.prototype)){\n  Element.prototype.remove = function(){\n    if(this.parentNode) {\n      this.parentNode.removeChild(this);\n    }\n  };\n}\n\nvar tns = function(options) {\n  options = extend({\n    container: '.slider',\n    mode: 'carousel',\n    axis: 'horizontal',\n    items: 1,\n    gutter: 0,\n    edgePadding: 0,\n    fixedWidth: false,\n    autoWidth: false,\n    viewportMax: false,\n    slideBy: 1,\n    center: false,\n    controls: true,\n    controlsPosition: 'top',\n    controlsText: ['prev', 'next'],\n    controlsContainer: false,\n    prevButton: false,\n    nextButton: false,\n    nav: true,\n    navPosition: 'top',\n    navContainer: false,\n    navAsThumbnails: false,\n    arrowKeys: false,\n    speed: 300,\n    autoplay: false,\n    autoplayPosition: 'top',\n    autoplayTimeout: 5000,\n    autoplayDirection: 'forward',\n    autoplayText: ['start', 'stop'],\n    autoplayHoverPause: false,\n    autoplayButton: false,\n    autoplayButtonOutput: true,\n    autoplayResetOnVisibility: true,\n    animateIn: 'tns-fadeIn',\n    animateOut: 'tns-fadeOut',\n    animateNormal: 'tns-normal',\n    animateDelay: false,\n    loop: true,\n    rewind: false,\n    autoHeight: false,\n    responsive: false,\n    lazyload: false,\n    lazyloadSelector: '.tns-lazy-img',\n    touch: true,\n    mouseDrag: false,\n    swipeAngle: 15,\n    nested: false,\n    preventActionWhenRunning: false,\n    preventScrollOnTouch: false,\n    freezable: true,\n    onInit: false,\n    useLocalStorage: true,\n    nonce: false\n  }, options || {});\n\n  var doc = document,\n      win = window,\n      KEYS = {\n        ENTER: 13,\n        SPACE: 32,\n        LEFT: 37,\n        RIGHT: 39\n      },\n      tnsStorage = {},\n      localStorageAccess = options.useLocalStorage;\n\n  if (localStorageAccess) {\n    // check browser version and local storage access\n    var browserInfo = navigator.userAgent;\n    var uid = new Date;\n\n    try {\n      tnsStorage = win.localStorage;\n      if (tnsStorage) {\n        tnsStorage.setItem(uid, uid);\n        localStorageAccess = tnsStorage.getItem(uid) == uid;\n        tnsStorage.removeItem(uid);\n      } else {\n        localStorageAccess = false;\n      }\n      if (!localStorageAccess) { tnsStorage = {}; }\n    } catch(e) {\n      localStorageAccess = false;\n    }\n\n    if (localStorageAccess) {\n      // remove storage when browser version changes\n      if (tnsStorage['tnsApp'] && tnsStorage['tnsApp'] !== browserInfo) {\n        ['tC', 'tPL', 'tMQ', 'tTf', 't3D', 'tTDu', 'tTDe', 'tADu', 'tADe', 'tTE', 'tAE'].forEach(function(item) { tnsStorage.removeItem(item); });\n      }\n      // update browserInfo\n      localStorage['tnsApp'] = browserInfo;\n    }\n  }\n\n  var CALC = tnsStorage['tC'] ? checkStorageValue(tnsStorage['tC']) : setLocalStorage(tnsStorage, 'tC', calc(), localStorageAccess),\n      PERCENTAGELAYOUT = tnsStorage['tPL'] ? checkStorageValue(tnsStorage['tPL']) : setLocalStorage(tnsStorage, 'tPL', percentageLayout(), localStorageAccess),\n      CSSMQ = tnsStorage['tMQ'] ? checkStorageValue(tnsStorage['tMQ']) : setLocalStorage(tnsStorage, 'tMQ', mediaquerySupport(), localStorageAccess),\n      TRANSFORM = tnsStorage['tTf'] ? checkStorageValue(tnsStorage['tTf']) : setLocalStorage(tnsStorage, 'tTf', whichProperty('transform'), localStorageAccess),\n      HAS3DTRANSFORMS = tnsStorage['t3D'] ? checkStorageValue(tnsStorage['t3D']) : setLocalStorage(tnsStorage, 't3D', has3DTransforms(TRANSFORM), localStorageAccess),\n      TRANSITIONDURATION = tnsStorage['tTDu'] ? checkStorageValue(tnsStorage['tTDu']) : setLocalStorage(tnsStorage, 'tTDu', whichProperty('transitionDuration'), localStorageAccess),\n      TRANSITIONDELAY = tnsStorage['tTDe'] ? checkStorageValue(tnsStorage['tTDe']) : setLocalStorage(tnsStorage, 'tTDe', whichProperty('transitionDelay'), localStorageAccess),\n      ANIMATIONDURATION = tnsStorage['tADu'] ? checkStorageValue(tnsStorage['tADu']) : setLocalStorage(tnsStorage, 'tADu', whichProperty('animationDuration'), localStorageAccess),\n      ANIMATIONDELAY = tnsStorage['tADe'] ? checkStorageValue(tnsStorage['tADe']) : setLocalStorage(tnsStorage, 'tADe', whichProperty('animationDelay'), localStorageAccess),\n      TRANSITIONEND = tnsStorage['tTE'] ? checkStorageValue(tnsStorage['tTE']) : setLocalStorage(tnsStorage, 'tTE', getEndProperty(TRANSITIONDURATION, 'Transition'), localStorageAccess),\n      ANIMATIONEND = tnsStorage['tAE'] ? checkStorageValue(tnsStorage['tAE']) : setLocalStorage(tnsStorage, 'tAE', getEndProperty(ANIMATIONDURATION, 'Animation'), localStorageAccess);\n\n  // get element nodes from selectors\n  var supportConsoleWarn = win.console && typeof win.console.warn === \"function\",\n      tnsList = ['container', 'controlsContainer', 'prevButton', 'nextButton', 'navContainer', 'autoplayButton'],\n      optionsElements = {};\n\n  tnsList.forEach(function(item) {\n    if (typeof options[item] === 'string') {\n      var str = options[item],\n          el = doc.querySelector(str);\n      optionsElements[item] = str;\n\n      if (el && el.nodeName) {\n        options[item] = el;\n      } else {\n        if (supportConsoleWarn) { console.warn('Can\\'t find', options[item]); }\n        return;\n      }\n    }\n  });\n\n  // make sure at least 1 slide\n  if (options.container.children.length < 1) {\n    if (supportConsoleWarn) { console.warn('No slides found in', options.container); }\n    return;\n   }\n\n  // update options\n  var responsive = options.responsive,\n      nested = options.nested,\n      carousel = options.mode === 'carousel' ? true : false;\n\n  if (responsive) {\n    // apply responsive[0] to options and remove it\n    if (0 in responsive) {\n      options = extend(options, responsive[0]);\n      delete responsive[0];\n    }\n\n    var responsiveTem = {};\n    for (var key in responsive) {\n      var val = responsive[key];\n      // update responsive\n      // from: 300: 2\n      // to:\n      //   300: {\n      //     items: 2\n      //   }\n      val = typeof val === 'number' ? {items: val} : val;\n      responsiveTem[key] = val;\n    }\n    responsive = responsiveTem;\n    responsiveTem = null;\n  }\n\n  // update options\n  function updateOptions (obj) {\n    for (var key in obj) {\n      if (!carousel) {\n        if (key === 'slideBy') { obj[key] = 'page'; }\n        if (key === 'edgePadding') { obj[key] = false; }\n        if (key === 'autoHeight') { obj[key] = false; }\n      }\n\n      // update responsive options\n      if (key === 'responsive') { updateOptions(obj[key]); }\n    }\n  }\n  if (!carousel) { updateOptions(options); }\n\n\n  // === define and set variables ===\n  if (!carousel) {\n    options.axis = 'horizontal';\n    options.slideBy = 'page';\n    options.edgePadding = false;\n\n    var animateIn = options.animateIn,\n        animateOut = options.animateOut,\n        animateDelay = options.animateDelay,\n        animateNormal = options.animateNormal;\n  }\n\n  var horizontal = options.axis === 'horizontal' ? true : false,\n      outerWrapper = doc.createElement('div'),\n      innerWrapper = doc.createElement('div'),\n      middleWrapper,\n      container = options.container,\n      containerParent = container.parentNode,\n      containerHTML = container.outerHTML,\n      slideItems = container.children,\n      slideCount = slideItems.length,\n      breakpointZone,\n      windowWidth = getWindowWidth(),\n      isOn = false;\n  if (responsive) { setBreakpointZone(); }\n  if (carousel) { container.className += ' tns-vpfix'; }\n\n  // fixedWidth: viewport > rightBoundary > indexMax\n  var autoWidth = options.autoWidth,\n      fixedWidth = getOption('fixedWidth'),\n      edgePadding = getOption('edgePadding'),\n      gutter = getOption('gutter'),\n      viewport = getViewportWidth(),\n      center = getOption('center'),\n      items = !autoWidth ? Math.floor(getOption('items')) : 1,\n      slideBy = getOption('slideBy'),\n      viewportMax = options.viewportMax || options.fixedWidthViewportWidth,\n      arrowKeys = getOption('arrowKeys'),\n      speed = getOption('speed'),\n      rewind = options.rewind,\n      loop = rewind ? false : options.loop,\n      autoHeight = getOption('autoHeight'),\n      controls = getOption('controls'),\n      controlsText = getOption('controlsText'),\n      nav = getOption('nav'),\n      touch = getOption('touch'),\n      mouseDrag = getOption('mouseDrag'),\n      autoplay = getOption('autoplay'),\n      autoplayTimeout = getOption('autoplayTimeout'),\n      autoplayText = getOption('autoplayText'),\n      autoplayHoverPause = getOption('autoplayHoverPause'),\n      autoplayResetOnVisibility = getOption('autoplayResetOnVisibility'),\n      sheet = createStyleSheet(null, getOption('nonce')),\n      lazyload = options.lazyload,\n      lazyloadSelector = options.lazyloadSelector,\n      slidePositions, // collection of slide positions\n      slideItemsOut = [],\n      cloneCount = loop ? getCloneCountForLoop() : 0,\n      slideCountNew = !carousel ? slideCount + cloneCount : slideCount + cloneCount * 2,\n      hasRightDeadZone = (fixedWidth || autoWidth) && !loop ? true : false,\n      rightBoundary = fixedWidth ? getRightBoundary() : null,\n      updateIndexBeforeTransform = (!carousel || !loop) ? true : false,\n      // transform\n      transformAttr = horizontal ? 'left' : 'top',\n      transformPrefix = '',\n      transformPostfix = '',\n      // index\n      getIndexMax = (function () {\n        if (fixedWidth) {\n          return function() { return center && !loop ? slideCount - 1 : Math.ceil(- rightBoundary / (fixedWidth + gutter)); };\n        } else if (autoWidth) {\n          return function() {\n            for (var i = 0; i < slideCountNew; i++) {\n              if (slidePositions[i] >= - rightBoundary) { return i; }\n            }\n          };\n        } else {\n          return function() {\n            if (center && carousel && !loop) {\n              return slideCount - 1;\n            } else {\n              return loop || carousel ? Math.max(0, slideCountNew - Math.ceil(items)) : slideCountNew - 1;\n            }\n          };\n        }\n      })(),\n      index = getStartIndex(getOption('startIndex')),\n      indexCached = index,\n      displayIndex = getCurrentSlide(),\n      indexMin = 0,\n      indexMax = !autoWidth ? getIndexMax() : null,\n      // resize\n      resizeTimer,\n      preventActionWhenRunning = options.preventActionWhenRunning,\n      swipeAngle = options.swipeAngle,\n      moveDirectionExpected = swipeAngle ? '?' : true,\n      running = false,\n      onInit = options.onInit,\n      events = new Events(),\n      // id, class\n      newContainerClasses = ' tns-slider tns-' + options.mode,\n      slideId = container.id || getSlideId(),\n      disable = getOption('disable'),\n      disabled = false,\n      freezable = options.freezable,\n      freeze = freezable && !autoWidth ? getFreeze() : false,\n      frozen = false,\n      controlsEvents = {\n        'click': onControlsClick,\n        'keydown': onControlsKeydown\n      },\n      navEvents = {\n        'click': onNavClick,\n        'keydown': onNavKeydown\n      },\n      hoverEvents = {\n        'mouseover': mouseoverPause,\n        'mouseout': mouseoutRestart\n      },\n      visibilityEvent = {'visibilitychange': onVisibilityChange},\n      docmentKeydownEvent = {'keydown': onDocumentKeydown},\n      touchEvents = {\n        'touchstart': onPanStart,\n        'touchmove': onPanMove,\n        'touchend': onPanEnd,\n        'touchcancel': onPanEnd\n      }, dragEvents = {\n        'mousedown': onPanStart,\n        'mousemove': onPanMove,\n        'mouseup': onPanEnd,\n        'mouseleave': onPanEnd\n      },\n      hasControls = hasOption('controls'),\n      hasNav = hasOption('nav'),\n      navAsThumbnails = autoWidth ? true : options.navAsThumbnails,\n      hasAutoplay = hasOption('autoplay'),\n      hasTouch = hasOption('touch'),\n      hasMouseDrag = hasOption('mouseDrag'),\n      slideActiveClass = 'tns-slide-active',\n      slideClonedClass = 'tns-slide-cloned',\n      imgCompleteClass = 'tns-complete',\n      imgEvents = {\n        'load': onImgLoaded,\n        'error': onImgFailed\n      },\n      imgsComplete,\n      liveregionCurrent,\n      preventScroll = options.preventScrollOnTouch === 'force' ? true : false;\n\n  // controls\n  if (hasControls) {\n    var controlsContainer = options.controlsContainer,\n        controlsContainerHTML = options.controlsContainer ? options.controlsContainer.outerHTML : '',\n        prevButton = options.prevButton,\n        nextButton = options.nextButton,\n        prevButtonHTML = options.prevButton ? options.prevButton.outerHTML : '',\n        nextButtonHTML = options.nextButton ? options.nextButton.outerHTML : '',\n        prevIsButton,\n        nextIsButton;\n  }\n\n  // nav\n  if (hasNav) {\n    var navContainer = options.navContainer,\n        navContainerHTML = options.navContainer ? options.navContainer.outerHTML : '',\n        navItems,\n        pages = autoWidth ? slideCount : getPages(),\n        pagesCached = 0,\n        navClicked = -1,\n        navCurrentIndex = getCurrentNavIndex(),\n        navCurrentIndexCached = navCurrentIndex,\n        navActiveClass = 'tns-nav-active',\n        navStr = 'Carousel Page ',\n        navStrCurrent = ' (Current Slide)';\n  }\n\n  // autoplay\n  if (hasAutoplay) {\n    var autoplayDirection = options.autoplayDirection === 'forward' ? 1 : -1,\n        autoplayButton = options.autoplayButton,\n        autoplayButtonHTML = options.autoplayButton ? options.autoplayButton.outerHTML : '',\n        autoplayHtmlStrings = ['<span class=\\'tns-visually-hidden\\'>', ' animation</span>'],\n        autoplayTimer,\n        animating,\n        autoplayHoverPaused,\n        autoplayUserPaused,\n        autoplayVisibilityPaused;\n  }\n\n  if (hasTouch || hasMouseDrag) {\n    var initPosition = {},\n        lastPosition = {},\n        translateInit,\n        disX,\n        disY,\n        panStart = false,\n        rafIndex,\n        getDist = horizontal ?\n          function(a, b) { return a.x - b.x; } :\n          function(a, b) { return a.y - b.y; };\n  }\n\n  // disable slider when slidecount <= items\n  if (!autoWidth) { resetVariblesWhenDisable(disable || freeze); }\n\n  if (TRANSFORM) {\n    transformAttr = TRANSFORM;\n    transformPrefix = 'translate';\n\n    if (HAS3DTRANSFORMS) {\n      transformPrefix += horizontal ? '3d(' : '3d(0px, ';\n      transformPostfix = horizontal ? ', 0px, 0px)' : ', 0px)';\n    } else {\n      transformPrefix += horizontal ? 'X(' : 'Y(';\n      transformPostfix = ')';\n    }\n\n  }\n\n  if (carousel) { container.className = container.className.replace('tns-vpfix', ''); }\n  initStructure();\n  initSheet();\n  initSliderTransform();\n\n  // === COMMON FUNCTIONS === //\n  function resetVariblesWhenDisable (condition) {\n    if (condition) {\n      controls = nav = touch = mouseDrag = arrowKeys = autoplay = autoplayHoverPause = autoplayResetOnVisibility = false;\n    }\n  }\n\n  function getCurrentSlide () {\n    var tem = carousel ? index - cloneCount : index;\n    while (tem < 0) { tem += slideCount; }\n    return tem%slideCount + 1;\n  }\n\n  function getStartIndex (ind) {\n    ind = ind ? Math.max(0, Math.min(loop ? slideCount - 1 : slideCount - items, ind)) : 0;\n    return carousel ? ind + cloneCount : ind;\n  }\n\n  function getAbsIndex (i) {\n    if (i == null) { i = index; }\n\n    if (carousel) { i -= cloneCount; }\n    while (i < 0) { i += slideCount; }\n\n    return Math.floor(i%slideCount);\n  }\n\n  function getCurrentNavIndex () {\n    var absIndex = getAbsIndex(),\n        result;\n\n    result = navAsThumbnails ? absIndex :\n      fixedWidth || autoWidth ? Math.ceil((absIndex + 1) * pages / slideCount - 1) :\n          Math.floor(absIndex / items);\n\n    // set active nav to the last one when reaches the right edge\n    if (!loop && carousel && index === indexMax) { result = pages - 1; }\n\n    return result;\n  }\n\n  function getItemsMax () {\n    // fixedWidth or autoWidth while viewportMax is not available\n    if (autoWidth || (fixedWidth && !viewportMax)) {\n      return slideCount - 1;\n    // most cases\n    } else {\n      var str = fixedWidth ? 'fixedWidth' : 'items',\n          arr = [];\n\n      if (fixedWidth || options[str] < slideCount) { arr.push(options[str]); }\n\n      if (responsive) {\n        for (var bp in responsive) {\n          var tem = responsive[bp][str];\n          if (tem && (fixedWidth || tem < slideCount)) { arr.push(tem); }\n        }\n      }\n\n      if (!arr.length) { arr.push(0); }\n\n      return Math.ceil(fixedWidth ? viewportMax / Math.min.apply(null, arr) : Math.max.apply(null, arr));\n    }\n  }\n\n  function getCloneCountForLoop () {\n    var itemsMax = getItemsMax(),\n        result = carousel ? Math.ceil((itemsMax * 5 - slideCount)/2) : (itemsMax * 4 - slideCount);\n    result = Math.max(itemsMax, result);\n\n    return hasOption('edgePadding') ? result + 1 : result;\n  }\n\n  function getWindowWidth () {\n    return win.innerWidth || doc.documentElement.clientWidth || doc.body.clientWidth;\n  }\n\n  function getInsertPosition (pos) {\n    return pos === 'top' ? 'afterbegin' : 'beforeend';\n  }\n\n  function getClientWidth (el) {\n    if (el == null) { return; }\n    var div = doc.createElement('div'), rect, width;\n    el.appendChild(div);\n    rect = div.getBoundingClientRect();\n    width = rect.right - rect.left;\n    div.remove();\n    return width || getClientWidth(el.parentNode);\n  }\n\n  function getViewportWidth () {\n    var gap = edgePadding ? edgePadding * 2 - gutter : 0;\n    return getClientWidth(containerParent) - gap;\n  }\n\n  function hasOption (item) {\n    if (options[item]) {\n      return true;\n    } else {\n      if (responsive) {\n        for (var bp in responsive) {\n          if (responsive[bp][item]) { return true; }\n        }\n      }\n      return false;\n    }\n  }\n\n  // get option:\n  // fixed width: viewport, fixedWidth, gutter => items\n  // others: window width => all variables\n  // all: items => slideBy\n  function getOption (item, ww) {\n    if (ww == null) { ww = windowWidth; }\n\n    if (item === 'items' && fixedWidth) {\n      return Math.floor((viewport + gutter) / (fixedWidth + gutter)) || 1;\n\n    } else {\n      var result = options[item];\n\n      if (responsive) {\n        for (var bp in responsive) {\n          // bp: convert string to number\n          if (ww >= parseInt(bp)) {\n            if (item in responsive[bp]) { result = responsive[bp][item]; }\n          }\n        }\n      }\n\n      if (item === 'slideBy' && result === 'page') { result = getOption('items'); }\n      if (!carousel && (item === 'slideBy' || item === 'items')) { result = Math.floor(result); }\n\n      return result;\n    }\n  }\n\n  function getSlideMarginLeft (i) {\n    return CALC ?\n      CALC + '(' + i * 100 + '% / ' + slideCountNew + ')' :\n      i * 100 / slideCountNew + '%';\n  }\n\n  function getInnerWrapperStyles (edgePaddingTem, gutterTem, fixedWidthTem, speedTem, autoHeightBP) {\n    var str = '';\n\n    if (edgePaddingTem !== undefined) {\n      var gap = edgePaddingTem;\n      if (gutterTem) { gap -= gutterTem; }\n      str = horizontal ?\n        'margin: 0 ' + gap + 'px 0 ' + edgePaddingTem + 'px;' :\n        'margin: ' + edgePaddingTem + 'px 0 ' + gap + 'px 0;';\n    } else if (gutterTem && !fixedWidthTem) {\n      var gutterTemUnit = '-' + gutterTem + 'px',\n          dir = horizontal ? gutterTemUnit + ' 0 0' : '0 ' + gutterTemUnit + ' 0';\n      str = 'margin: 0 ' + dir + ';';\n    }\n\n    if (!carousel && autoHeightBP && TRANSITIONDURATION && speedTem) { str += getTransitionDurationStyle(speedTem); }\n    return str;\n  }\n\n  function getContainerWidth (fixedWidthTem, gutterTem, itemsTem) {\n    if (fixedWidthTem) {\n      return (fixedWidthTem + gutterTem) * slideCountNew + 'px';\n    } else {\n      return CALC ?\n        CALC + '(' + slideCountNew * 100 + '% / ' + itemsTem + ')' :\n        slideCountNew * 100 / itemsTem + '%';\n    }\n  }\n\n  function getSlideWidthStyle (fixedWidthTem, gutterTem, itemsTem) {\n    var width;\n\n    if (fixedWidthTem) {\n      width = (fixedWidthTem + gutterTem) + 'px';\n    } else {\n      if (!carousel) { itemsTem = Math.floor(itemsTem); }\n      var dividend = carousel ? slideCountNew : itemsTem;\n      width = CALC ?\n        CALC + '(100% / ' + dividend + ')' :\n        100 / dividend + '%';\n    }\n\n    width = 'width:' + width;\n\n    // inner slider: overwrite outer slider styles\n    return nested !== 'inner' ? width + ';' : width + ' !important;';\n  }\n\n  function getSlideGutterStyle (gutterTem) {\n    var str = '';\n\n    // gutter maybe interger || 0\n    // so can't use 'if (gutter)'\n    if (gutterTem !== false) {\n      var prop = horizontal ? 'padding-' : 'margin-',\n          dir = horizontal ? 'right' : 'bottom';\n      str = prop +  dir + ': ' + gutterTem + 'px;';\n    }\n\n    return str;\n  }\n\n  function getCSSPrefix (name, num) {\n    var prefix = name.substring(0, name.length - num).toLowerCase();\n    if (prefix) { prefix = '-' + prefix + '-'; }\n\n    return prefix;\n  }\n\n  function getTransitionDurationStyle (speed) {\n    return getCSSPrefix(TRANSITIONDURATION, 18) + 'transition-duration:' + speed / 1000 + 's;';\n  }\n\n  function getAnimationDurationStyle (speed) {\n    return getCSSPrefix(ANIMATIONDURATION, 17) + 'animation-duration:' + speed / 1000 + 's;';\n  }\n\n  function initStructure () {\n    var classOuter = 'tns-outer',\n        classInner = 'tns-inner',\n        hasGutter = hasOption('gutter');\n\n    outerWrapper.className = classOuter;\n    innerWrapper.className = classInner;\n    outerWrapper.id = slideId + '-ow';\n    innerWrapper.id = slideId + '-iw';\n\n    // set container properties\n    if (container.id === '') { container.id = slideId; }\n    newContainerClasses += PERCENTAGELAYOUT || autoWidth ? ' tns-subpixel' : ' tns-no-subpixel';\n    newContainerClasses += CALC ? ' tns-calc' : ' tns-no-calc';\n    if (autoWidth) { newContainerClasses += ' tns-autowidth'; }\n    newContainerClasses += ' tns-' + options.axis;\n    container.className += newContainerClasses;\n\n    // add constrain layer for carousel\n    if (carousel) {\n      middleWrapper = doc.createElement('div');\n      middleWrapper.id = slideId + '-mw';\n      middleWrapper.className = 'tns-ovh';\n\n      outerWrapper.appendChild(middleWrapper);\n      middleWrapper.appendChild(innerWrapper);\n    } else {\n      outerWrapper.appendChild(innerWrapper);\n    }\n\n    if (autoHeight) {\n      var wp = middleWrapper ? middleWrapper : innerWrapper;\n      wp.className += ' tns-ah';\n    }\n\n    containerParent.insertBefore(outerWrapper, container);\n    innerWrapper.appendChild(container);\n\n    // add id, class, aria attributes\n    // before clone slides\n    forEach(slideItems, function(item, i) {\n      addClass(item, 'tns-item');\n      if (!item.id) { item.id = slideId + '-item' + i; }\n      if (!carousel && animateNormal) { addClass(item, animateNormal); }\n      setAttrs(item, {\n        'aria-hidden': 'true',\n        'tabindex': '-1'\n      });\n    });\n\n    // ## clone slides\n    // carousel: n + slides + n\n    // gallery:      slides + n\n    if (cloneCount) {\n      var fragmentBefore = doc.createDocumentFragment(),\n          fragmentAfter = doc.createDocumentFragment();\n\n      for (var j = cloneCount; j--;) {\n        var num = j%slideCount,\n            cloneFirst = slideItems[num].cloneNode(true);\n        addClass(cloneFirst, slideClonedClass);\n        removeAttrs(cloneFirst, 'id');\n        fragmentAfter.insertBefore(cloneFirst, fragmentAfter.firstChild);\n\n        if (carousel) {\n          var cloneLast = slideItems[slideCount - 1 - num].cloneNode(true);\n          addClass(cloneLast, slideClonedClass);\n          removeAttrs(cloneLast, 'id');\n          fragmentBefore.appendChild(cloneLast);\n        }\n      }\n\n      container.insertBefore(fragmentBefore, container.firstChild);\n      container.appendChild(fragmentAfter);\n      slideItems = container.children;\n    }\n\n  }\n\n  function initSliderTransform () {\n    // ## images loaded/failed\n    if (hasOption('autoHeight') || autoWidth || !horizontal) {\n      var imgs = container.querySelectorAll('img');\n\n      // add img load event listener\n      forEach(imgs, function(img) {\n        var src = img.src;\n\n        if (!lazyload) {\n          // not data img\n          if (src && src.indexOf('data:image') < 0) {\n            img.src = '';\n            addEvents(img, imgEvents);\n            addClass(img, 'loading');\n\n            img.src = src;\n          // data img\n          } else {\n            imgLoaded(img);\n          }\n        }\n      });\n\n      // set imgsComplete\n      raf(function(){ imgsLoadedCheck(arrayFromNodeList(imgs), function() { imgsComplete = true; }); });\n\n      // reset imgs for auto height: check visible imgs only\n      if (hasOption('autoHeight')) { imgs = getImageArray(index, Math.min(index + items - 1, slideCountNew - 1)); }\n\n      lazyload ? initSliderTransformStyleCheck() : raf(function(){ imgsLoadedCheck(arrayFromNodeList(imgs), initSliderTransformStyleCheck); });\n\n    } else {\n      // set container transform property\n      if (carousel) { doContainerTransformSilent(); }\n\n      // update slider tools and events\n      initTools();\n      initEvents();\n    }\n  }\n\n  function initSliderTransformStyleCheck () {\n    if (autoWidth && slideCount > 1) {\n      // check styles application\n      var num = loop ? index : slideCount - 1;\n\n      (function stylesApplicationCheck() {\n        var left = slideItems[num].getBoundingClientRect().left;\n        var right = slideItems[num - 1].getBoundingClientRect().right;\n\n        (Math.abs(left - right) <= 1) ?\n          initSliderTransformCore() :\n          setTimeout(function(){ stylesApplicationCheck(); }, 16);\n      })();\n\n    } else {\n      initSliderTransformCore();\n    }\n  }\n\n\n  function initSliderTransformCore () {\n    // run Fn()s which are rely on image loading\n    if (!horizontal || autoWidth) {\n      setSlidePositions();\n\n      if (autoWidth) {\n        rightBoundary = getRightBoundary();\n        if (freezable) { freeze = getFreeze(); }\n        indexMax = getIndexMax(); // <= slidePositions, rightBoundary <=\n        resetVariblesWhenDisable(disable || freeze);\n      } else {\n        updateContentWrapperHeight();\n      }\n    }\n\n    // set container transform property\n    if (carousel) { doContainerTransformSilent(); }\n\n    // update slider tools and events\n    initTools();\n    initEvents();\n  }\n\n  function initSheet () {\n    // gallery:\n    // set animation classes and left value for gallery slider\n    if (!carousel) {\n      for (var i = index, l = index + Math.min(slideCount, items); i < l; i++) {\n        var item = slideItems[i];\n        item.style.left = (i - index) * 100 / items + '%';\n        addClass(item, animateIn);\n        removeClass(item, animateNormal);\n      }\n    }\n\n    // #### LAYOUT\n\n    // ## INLINE-BLOCK VS FLOAT\n\n    // ## PercentageLayout:\n    // slides: inline-block\n    // remove blank space between slides by set font-size: 0\n\n    // ## Non PercentageLayout:\n    // slides: float\n    //         margin-right: -100%\n    //         margin-left: ~\n\n    // Resource: https://docs.google.com/spreadsheets/d/147up245wwTXeQYve3BRSAD4oVcvQmuGsFteJOeA5xNQ/edit?usp=sharing\n    if (horizontal) {\n      if (PERCENTAGELAYOUT || autoWidth) {\n        addCSSRule(sheet, '#' + slideId + ' > .tns-item', 'font-size:' + win.getComputedStyle(slideItems[0]).fontSize + ';', getCssRulesLength(sheet));\n        addCSSRule(sheet, '#' + slideId, 'font-size:0;', getCssRulesLength(sheet));\n      } else if (carousel) {\n        forEach(slideItems, function (slide, i) {\n          slide.style.marginLeft = getSlideMarginLeft(i);\n        });\n      }\n    }\n\n\n    // ## BASIC STYLES\n    if (CSSMQ) {\n      // middle wrapper style\n      if (TRANSITIONDURATION) {\n        var str = middleWrapper && options.autoHeight ? getTransitionDurationStyle(options.speed) : '';\n        addCSSRule(sheet, '#' + slideId + '-mw', str, getCssRulesLength(sheet));\n      }\n\n      // inner wrapper styles\n      str = getInnerWrapperStyles(options.edgePadding, options.gutter, options.fixedWidth, options.speed, options.autoHeight);\n      addCSSRule(sheet, '#' + slideId + '-iw', str, getCssRulesLength(sheet));\n\n      // container styles\n      if (carousel) {\n        str = horizontal && !autoWidth ? 'width:' + getContainerWidth(options.fixedWidth, options.gutter, options.items) + ';' : '';\n        if (TRANSITIONDURATION) { str += getTransitionDurationStyle(speed); }\n        addCSSRule(sheet, '#' + slideId, str, getCssRulesLength(sheet));\n      }\n\n      // slide styles\n      str = horizontal && !autoWidth ? getSlideWidthStyle(options.fixedWidth, options.gutter, options.items) : '';\n      if (options.gutter) { str += getSlideGutterStyle(options.gutter); }\n      // set gallery items transition-duration\n      if (!carousel) {\n        if (TRANSITIONDURATION) { str += getTransitionDurationStyle(speed); }\n        if (ANIMATIONDURATION) { str += getAnimationDurationStyle(speed); }\n      }\n      if (str) { addCSSRule(sheet, '#' + slideId + ' > .tns-item', str, getCssRulesLength(sheet)); }\n\n    // non CSS mediaqueries: IE8\n    // ## update inner wrapper, container, slides if needed\n    // set inline styles for inner wrapper & container\n    // insert stylesheet (one line) for slides only (since slides are many)\n    } else {\n      // middle wrapper styles\n      update_carousel_transition_duration();\n\n      // inner wrapper styles\n      innerWrapper.style.cssText = getInnerWrapperStyles(edgePadding, gutter, fixedWidth, autoHeight);\n\n      // container styles\n      if (carousel && horizontal && !autoWidth) {\n        container.style.width = getContainerWidth(fixedWidth, gutter, items);\n      }\n\n      // slide styles\n      var str = horizontal && !autoWidth ? getSlideWidthStyle(fixedWidth, gutter, items) : '';\n      if (gutter) { str += getSlideGutterStyle(gutter); }\n\n      // append to the last line\n      if (str) { addCSSRule(sheet, '#' + slideId + ' > .tns-item', str, getCssRulesLength(sheet)); }\n    }\n\n    // ## MEDIAQUERIES\n    if (responsive && CSSMQ) {\n      for (var bp in responsive) {\n        // bp: convert string to number\n        bp = parseInt(bp);\n\n        var opts = responsive[bp],\n            str = '',\n            middleWrapperStr = '',\n            innerWrapperStr = '',\n            containerStr = '',\n            slideStr = '',\n            itemsBP = !autoWidth ? getOption('items', bp) : null,\n            fixedWidthBP = getOption('fixedWidth', bp),\n            speedBP = getOption('speed', bp),\n            edgePaddingBP = getOption('edgePadding', bp),\n            autoHeightBP = getOption('autoHeight', bp),\n            gutterBP = getOption('gutter', bp);\n\n        // middle wrapper string\n        if (TRANSITIONDURATION && middleWrapper && getOption('autoHeight', bp) && 'speed' in opts) {\n          middleWrapperStr = '#' + slideId + '-mw{' + getTransitionDurationStyle(speedBP) + '}';\n        }\n\n        // inner wrapper string\n        if ('edgePadding' in opts || 'gutter' in opts) {\n          innerWrapperStr = '#' + slideId + '-iw{' + getInnerWrapperStyles(edgePaddingBP, gutterBP, fixedWidthBP, speedBP, autoHeightBP) + '}';\n        }\n\n        // container string\n        if (carousel && horizontal && !autoWidth && ('fixedWidth' in opts || 'items' in opts || (fixedWidth && 'gutter' in opts))) {\n          containerStr = 'width:' + getContainerWidth(fixedWidthBP, gutterBP, itemsBP) + ';';\n        }\n        if (TRANSITIONDURATION && 'speed' in opts) {\n          containerStr += getTransitionDurationStyle(speedBP);\n        }\n        if (containerStr) {\n          containerStr = '#' + slideId + '{' + containerStr + '}';\n        }\n\n        // slide string\n        if ('fixedWidth' in opts || (fixedWidth && 'gutter' in opts) || !carousel && 'items' in opts) {\n          slideStr += getSlideWidthStyle(fixedWidthBP, gutterBP, itemsBP);\n        }\n        if ('gutter' in opts) {\n          slideStr += getSlideGutterStyle(gutterBP);\n        }\n        // set gallery items transition-duration\n        if (!carousel && 'speed' in opts) {\n          if (TRANSITIONDURATION) { slideStr += getTransitionDurationStyle(speedBP); }\n          if (ANIMATIONDURATION) { slideStr += getAnimationDurationStyle(speedBP); }\n        }\n        if (slideStr) { slideStr = '#' + slideId + ' > .tns-item{' + slideStr + '}'; }\n\n        // add up\n        str = middleWrapperStr + innerWrapperStr + containerStr + slideStr;\n\n        if (str) {\n          sheet.insertRule('@media (min-width: ' + bp / 16 + 'em) {' + str + '}', sheet.cssRules.length);\n        }\n      }\n    }\n  }\n\n  function initTools () {\n    // == slides ==\n    updateSlideStatus();\n\n    // == live region ==\n    outerWrapper.insertAdjacentHTML('afterbegin', '<div class=\"tns-liveregion tns-visually-hidden\" aria-live=\"polite\" aria-atomic=\"true\">slide <span class=\"current\">' + getLiveRegionStr() + '</span>  of ' + slideCount + '</div>');\n    liveregionCurrent = outerWrapper.querySelector('.tns-liveregion .current');\n\n    // == autoplayInit ==\n    if (hasAutoplay) {\n      var txt = autoplay ? 'stop' : 'start';\n      if (autoplayButton) {\n        setAttrs(autoplayButton, {'data-action': txt});\n      } else if (options.autoplayButtonOutput) {\n        outerWrapper.insertAdjacentHTML(getInsertPosition(options.autoplayPosition), '<button type=\"button\" data-action=\"' + txt + '\">' + autoplayHtmlStrings[0] + txt + autoplayHtmlStrings[1] + autoplayText[0] + '</button>');\n        autoplayButton = outerWrapper.querySelector('[data-action]');\n      }\n\n      // add event\n      if (autoplayButton) {\n        addEvents(autoplayButton, {'click': toggleAutoplay});\n      }\n\n      if (autoplay) {\n        startAutoplay();\n        if (autoplayHoverPause) { addEvents(container, hoverEvents); }\n        if (autoplayResetOnVisibility) { addEvents(container, visibilityEvent); }\n      }\n    }\n\n    // == navInit ==\n    if (hasNav) {\n      var initIndex = !carousel ? 0 : cloneCount;\n      // customized nav\n      // will not hide the navs in case they're thumbnails\n      if (navContainer) {\n        setAttrs(navContainer, {'aria-label': 'Carousel Pagination'});\n        navItems = navContainer.children;\n        forEach(navItems, function(item, i) {\n          setAttrs(item, {\n            'data-nav': i,\n            'tabindex': '-1',\n            'aria-label': navStr + (i + 1),\n            'aria-controls': slideId,\n          });\n        });\n\n      // generated nav\n      } else {\n        var navHtml = '',\n            hiddenStr = navAsThumbnails ? '' : 'style=\"display:none\"';\n        for (var i = 0; i < slideCount; i++) {\n          // hide nav items by default\n          navHtml += '<button type=\"button\" data-nav=\"' + i +'\" tabindex=\"-1\" aria-controls=\"' + slideId + '\" ' + hiddenStr + ' aria-label=\"' + navStr + (i + 1) +'\"></button>';\n        }\n        navHtml = '<div class=\"tns-nav\" aria-label=\"Carousel Pagination\">' + navHtml + '</div>';\n        outerWrapper.insertAdjacentHTML(getInsertPosition(options.navPosition), navHtml);\n\n        navContainer = outerWrapper.querySelector('.tns-nav');\n        navItems = navContainer.children;\n      }\n\n      updateNavVisibility();\n\n      // add transition\n      if (TRANSITIONDURATION) {\n        var prefix = TRANSITIONDURATION.substring(0, TRANSITIONDURATION.length - 18).toLowerCase(),\n            str = 'transition: all ' + speed / 1000 + 's';\n\n        if (prefix) {\n          str = '-' + prefix + '-' + str;\n        }\n\n        addCSSRule(sheet, '[aria-controls^=' + slideId + '-item]', str, getCssRulesLength(sheet));\n      }\n\n      setAttrs(navItems[navCurrentIndex], {'aria-label': navStr + (navCurrentIndex + 1) + navStrCurrent});\n      removeAttrs(navItems[navCurrentIndex], 'tabindex');\n      addClass(navItems[navCurrentIndex], navActiveClass);\n\n      // add events\n      addEvents(navContainer, navEvents);\n    }\n\n\n\n    // == controlsInit ==\n    if (hasControls) {\n      if (!controlsContainer && (!prevButton || !nextButton)) {\n        outerWrapper.insertAdjacentHTML(getInsertPosition(options.controlsPosition), '<div class=\"tns-controls\" aria-label=\"Carousel Navigation\" tabindex=\"0\"><button type=\"button\" data-controls=\"prev\" tabindex=\"-1\" aria-controls=\"' + slideId +'\">' + controlsText[0] + '</button><button type=\"button\" data-controls=\"next\" tabindex=\"-1\" aria-controls=\"' + slideId +'\">' + controlsText[1] + '</button></div>');\n\n        controlsContainer = outerWrapper.querySelector('.tns-controls');\n      }\n\n      if (!prevButton || !nextButton) {\n        prevButton = controlsContainer.children[0];\n        nextButton = controlsContainer.children[1];\n      }\n\n      if (options.controlsContainer) {\n        setAttrs(controlsContainer, {\n          'aria-label': 'Carousel Navigation',\n          'tabindex': '0'\n        });\n      }\n\n      if (options.controlsContainer || (options.prevButton && options.nextButton)) {\n        setAttrs([prevButton, nextButton], {\n          'aria-controls': slideId,\n          'tabindex': '-1',\n        });\n      }\n\n      if (options.controlsContainer || (options.prevButton && options.nextButton)) {\n        setAttrs(prevButton, {'data-controls' : 'prev'});\n        setAttrs(nextButton, {'data-controls' : 'next'});\n      }\n\n      prevIsButton = isButton(prevButton);\n      nextIsButton = isButton(nextButton);\n\n      updateControlsStatus();\n\n      // add events\n      if (controlsContainer) {\n        addEvents(controlsContainer, controlsEvents);\n      } else {\n        addEvents(prevButton, controlsEvents);\n        addEvents(nextButton, controlsEvents);\n      }\n    }\n\n    // hide tools if needed\n    disableUI();\n  }\n\n  function initEvents () {\n    // add events\n    if (carousel && TRANSITIONEND) {\n      var eve = {};\n      eve[TRANSITIONEND] = onTransitionEnd;\n      addEvents(container, eve);\n    }\n\n    if (touch) { addEvents(container, touchEvents, options.preventScrollOnTouch); }\n    if (mouseDrag) { addEvents(container, dragEvents); }\n    if (arrowKeys) { addEvents(doc, docmentKeydownEvent); }\n\n    if (nested === 'inner') {\n      events.on('outerResized', function () {\n        resizeTasks();\n        events.emit('innerLoaded', info());\n      });\n    } else if (responsive || fixedWidth || autoWidth || autoHeight || !horizontal) {\n      addEvents(win, {'resize': onResize});\n    }\n\n    if (autoHeight) {\n      if (nested === 'outer') {\n        events.on('innerLoaded', doAutoHeight);\n      } else if (!disable) { doAutoHeight(); }\n    }\n\n    doLazyLoad();\n    if (disable) { disableSlider(); } else if (freeze) { freezeSlider(); }\n\n    events.on('indexChanged', additionalUpdates);\n    if (nested === 'inner') { events.emit('innerLoaded', info()); }\n    if (typeof onInit === 'function') { onInit(info()); }\n    isOn = true;\n  }\n\n  function destroy () {\n    // sheet\n    sheet.disabled = true;\n    if (sheet.ownerNode) { sheet.ownerNode.remove(); }\n\n    // remove win event listeners\n    removeEvents(win, {'resize': onResize});\n\n    // arrowKeys, controls, nav\n    if (arrowKeys) { removeEvents(doc, docmentKeydownEvent); }\n    if (controlsContainer) { removeEvents(controlsContainer, controlsEvents); }\n    if (navContainer) { removeEvents(navContainer, navEvents); }\n\n    // autoplay\n    removeEvents(container, hoverEvents);\n    removeEvents(container, visibilityEvent);\n    if (autoplayButton) { removeEvents(autoplayButton, {'click': toggleAutoplay}); }\n    if (autoplay) { clearInterval(autoplayTimer); }\n\n    // container\n    if (carousel && TRANSITIONEND) {\n      var eve = {};\n      eve[TRANSITIONEND] = onTransitionEnd;\n      removeEvents(container, eve);\n    }\n    if (touch) { removeEvents(container, touchEvents); }\n    if (mouseDrag) { removeEvents(container, dragEvents); }\n\n    // cache Object values in options && reset HTML\n    var htmlList = [containerHTML, controlsContainerHTML, prevButtonHTML, nextButtonHTML, navContainerHTML, autoplayButtonHTML];\n\n    tnsList.forEach(function(item, i) {\n      var el = item === 'container' ? outerWrapper : options[item];\n\n      if (typeof el === 'object' && el) {\n        var prevEl = el.previousElementSibling ? el.previousElementSibling : false,\n            parentEl = el.parentNode;\n        el.outerHTML = htmlList[i];\n        options[item] = prevEl ? prevEl.nextElementSibling : parentEl.firstElementChild;\n      }\n    });\n\n\n    // reset variables\n    tnsList = animateIn = animateOut = animateDelay = animateNormal = horizontal = outerWrapper = innerWrapper = container = containerParent = containerHTML = slideItems = slideCount = breakpointZone = windowWidth = autoWidth = fixedWidth = edgePadding = gutter = viewport = items = slideBy = viewportMax = arrowKeys = speed = rewind = loop = autoHeight = sheet = lazyload = slidePositions = slideItemsOut = cloneCount = slideCountNew = hasRightDeadZone = rightBoundary = updateIndexBeforeTransform = transformAttr = transformPrefix = transformPostfix = getIndexMax = index = indexCached = indexMin = indexMax = resizeTimer = swipeAngle = moveDirectionExpected = running = onInit = events = newContainerClasses = slideId = disable = disabled = freezable = freeze = frozen = controlsEvents = navEvents = hoverEvents = visibilityEvent = docmentKeydownEvent = touchEvents = dragEvents = hasControls = hasNav = navAsThumbnails = hasAutoplay = hasTouch = hasMouseDrag = slideActiveClass = imgCompleteClass = imgEvents = imgsComplete = controls = controlsText = controlsContainer = controlsContainerHTML = prevButton = nextButton = prevIsButton = nextIsButton = nav = navContainer = navContainerHTML = navItems = pages = pagesCached = navClicked = navCurrentIndex = navCurrentIndexCached = navActiveClass = navStr = navStrCurrent = autoplay = autoplayTimeout = autoplayDirection = autoplayText = autoplayHoverPause = autoplayButton = autoplayButtonHTML = autoplayResetOnVisibility = autoplayHtmlStrings = autoplayTimer = animating = autoplayHoverPaused = autoplayUserPaused = autoplayVisibilityPaused = initPosition = lastPosition = translateInit = disX = disY = panStart = rafIndex = getDist = touch = mouseDrag = null;\n    // check variables\n    // [animateIn, animateOut, animateDelay, animateNormal, horizontal, outerWrapper, innerWrapper, container, containerParent, containerHTML, slideItems, slideCount, breakpointZone, windowWidth, autoWidth, fixedWidth, edgePadding, gutter, viewport, items, slideBy, viewportMax, arrowKeys, speed, rewind, loop, autoHeight, sheet, lazyload, slidePositions, slideItemsOut, cloneCount, slideCountNew, hasRightDeadZone, rightBoundary, updateIndexBeforeTransform, transformAttr, transformPrefix, transformPostfix, getIndexMax, index, indexCached, indexMin, indexMax, resizeTimer, swipeAngle, moveDirectionExpected, running, onInit, events, newContainerClasses, slideId, disable, disabled, freezable, freeze, frozen, controlsEvents, navEvents, hoverEvents, visibilityEvent, docmentKeydownEvent, touchEvents, dragEvents, hasControls, hasNav, navAsThumbnails, hasAutoplay, hasTouch, hasMouseDrag, slideActiveClass, imgCompleteClass, imgEvents, imgsComplete, controls, controlsText, controlsContainer, controlsContainerHTML, prevButton, nextButton, prevIsButton, nextIsButton, nav, navContainer, navContainerHTML, navItems, pages, pagesCached, navClicked, navCurrentIndex, navCurrentIndexCached, navActiveClass, navStr, navStrCurrent, autoplay, autoplayTimeout, autoplayDirection, autoplayText, autoplayHoverPause, autoplayButton, autoplayButtonHTML, autoplayResetOnVisibility, autoplayHtmlStrings, autoplayTimer, animating, autoplayHoverPaused, autoplayUserPaused, autoplayVisibilityPaused, initPosition, lastPosition, translateInit, disX, disY, panStart, rafIndex, getDist, touch, mouseDrag ].forEach(function(item) { if (item !== null) { console.log(item); } });\n\n    for (var a in this) {\n      if (a !== 'rebuild') { this[a] = null; }\n    }\n    isOn = false;\n  }\n\n// === ON RESIZE ===\n  // responsive || fixedWidth || autoWidth || !horizontal\n  function onResize (e) {\n    raf(function(){ resizeTasks(getEvent(e)); });\n  }\n\n  function resizeTasks (e) {\n    if (!isOn) { return; }\n    if (nested === 'outer') { events.emit('outerResized', info(e)); }\n    windowWidth = getWindowWidth();\n    var bpChanged,\n        breakpointZoneTem = breakpointZone,\n        needContainerTransform = false;\n\n    if (responsive) {\n      setBreakpointZone();\n      bpChanged = breakpointZoneTem !== breakpointZone;\n      // if (hasRightDeadZone) { needContainerTransform = true; } // *?\n      if (bpChanged) { events.emit('newBreakpointStart', info(e)); }\n    }\n\n    var indChanged,\n        itemsChanged,\n        itemsTem = items,\n        disableTem = disable,\n        freezeTem = freeze,\n        arrowKeysTem = arrowKeys,\n        controlsTem = controls,\n        navTem = nav,\n        touchTem = touch,\n        mouseDragTem = mouseDrag,\n        autoplayTem = autoplay,\n        autoplayHoverPauseTem = autoplayHoverPause,\n        autoplayResetOnVisibilityTem = autoplayResetOnVisibility,\n        indexTem = index;\n\n    if (bpChanged) {\n      var fixedWidthTem = fixedWidth,\n          autoHeightTem = autoHeight,\n          controlsTextTem = controlsText,\n          centerTem = center,\n          autoplayTextTem = autoplayText;\n\n      if (!CSSMQ) {\n        var gutterTem = gutter,\n            edgePaddingTem = edgePadding;\n      }\n    }\n\n    // get option:\n    // fixed width: viewport, fixedWidth, gutter => items\n    // others: window width => all variables\n    // all: items => slideBy\n    arrowKeys = getOption('arrowKeys');\n    controls = getOption('controls');\n    nav = getOption('nav');\n    touch = getOption('touch');\n    center = getOption('center');\n    mouseDrag = getOption('mouseDrag');\n    autoplay = getOption('autoplay');\n    autoplayHoverPause = getOption('autoplayHoverPause');\n    autoplayResetOnVisibility = getOption('autoplayResetOnVisibility');\n\n    if (bpChanged) {\n      disable = getOption('disable');\n      fixedWidth = getOption('fixedWidth');\n      speed = getOption('speed');\n      autoHeight = getOption('autoHeight');\n      controlsText = getOption('controlsText');\n      autoplayText = getOption('autoplayText');\n      autoplayTimeout = getOption('autoplayTimeout');\n\n      if (!CSSMQ) {\n        edgePadding = getOption('edgePadding');\n        gutter = getOption('gutter');\n      }\n    }\n    // update options\n    resetVariblesWhenDisable(disable);\n\n    viewport = getViewportWidth(); // <= edgePadding, gutter\n    if ((!horizontal || autoWidth) && !disable) {\n      setSlidePositions();\n      if (!horizontal) {\n        updateContentWrapperHeight(); // <= setSlidePositions\n        needContainerTransform = true;\n      }\n    }\n    if (fixedWidth || autoWidth) {\n      rightBoundary = getRightBoundary(); // autoWidth: <= viewport, slidePositions, gutter\n                                          // fixedWidth: <= viewport, fixedWidth, gutter\n      indexMax = getIndexMax(); // autoWidth: <= rightBoundary, slidePositions\n                                // fixedWidth: <= rightBoundary, fixedWidth, gutter\n    }\n\n    if (bpChanged || fixedWidth) {\n      items = getOption('items');\n      slideBy = getOption('slideBy');\n      itemsChanged = items !== itemsTem;\n\n      if (itemsChanged) {\n        if (!fixedWidth && !autoWidth) { indexMax = getIndexMax(); } // <= items\n        // check index before transform in case\n        // slider reach the right edge then items become bigger\n        updateIndex();\n      }\n    }\n\n    if (bpChanged) {\n      if (disable !== disableTem) {\n        if (disable) {\n          disableSlider();\n        } else {\n          enableSlider(); // <= slidePositions, rightBoundary, indexMax\n        }\n      }\n    }\n\n    if (freezable && (bpChanged || fixedWidth || autoWidth)) {\n      freeze = getFreeze(); // <= autoWidth: slidePositions, gutter, viewport, rightBoundary\n                            // <= fixedWidth: fixedWidth, gutter, rightBoundary\n                            // <= others: items\n\n      if (freeze !== freezeTem) {\n        if (freeze) {\n          doContainerTransform(getContainerTransformValue(getStartIndex(0)));\n          freezeSlider();\n        } else {\n          unfreezeSlider();\n          needContainerTransform = true;\n        }\n      }\n    }\n\n    resetVariblesWhenDisable(disable || freeze); // controls, nav, touch, mouseDrag, arrowKeys, autoplay, autoplayHoverPause, autoplayResetOnVisibility\n    if (!autoplay) { autoplayHoverPause = autoplayResetOnVisibility = false; }\n\n    if (arrowKeys !== arrowKeysTem) {\n      arrowKeys ?\n        addEvents(doc, docmentKeydownEvent) :\n        removeEvents(doc, docmentKeydownEvent);\n    }\n    if (controls !== controlsTem) {\n      if (controls) {\n        if (controlsContainer) {\n          showElement(controlsContainer);\n        } else {\n          if (prevButton) { showElement(prevButton); }\n          if (nextButton) { showElement(nextButton); }\n        }\n      } else {\n        if (controlsContainer) {\n          hideElement(controlsContainer);\n        } else {\n          if (prevButton) { hideElement(prevButton); }\n          if (nextButton) { hideElement(nextButton); }\n        }\n      }\n    }\n    if (nav !== navTem) {\n      if (nav) {\n        showElement(navContainer);\n        updateNavVisibility();\n      } else {\n        hideElement(navContainer);\n      }\n    }\n    if (touch !== touchTem) {\n      touch ?\n        addEvents(container, touchEvents, options.preventScrollOnTouch) :\n        removeEvents(container, touchEvents);\n    }\n    if (mouseDrag !== mouseDragTem) {\n      mouseDrag ?\n        addEvents(container, dragEvents) :\n        removeEvents(container, dragEvents);\n    }\n    if (autoplay !== autoplayTem) {\n      if (autoplay) {\n        if (autoplayButton) { showElement(autoplayButton); }\n        if (!animating && !autoplayUserPaused) { startAutoplay(); }\n      } else {\n        if (autoplayButton) { hideElement(autoplayButton); }\n        if (animating) { stopAutoplay(); }\n      }\n    }\n    if (autoplayHoverPause !== autoplayHoverPauseTem) {\n      autoplayHoverPause ?\n        addEvents(container, hoverEvents) :\n        removeEvents(container, hoverEvents);\n    }\n    if (autoplayResetOnVisibility !== autoplayResetOnVisibilityTem) {\n      autoplayResetOnVisibility ?\n        addEvents(doc, visibilityEvent) :\n        removeEvents(doc, visibilityEvent);\n    }\n\n    if (bpChanged) {\n      if (fixedWidth !== fixedWidthTem || center !== centerTem) { needContainerTransform = true; }\n\n      if (autoHeight !== autoHeightTem) {\n        if (!autoHeight) { innerWrapper.style.height = ''; }\n      }\n\n      if (controls && controlsText !== controlsTextTem) {\n        prevButton.innerHTML = controlsText[0];\n        nextButton.innerHTML = controlsText[1];\n      }\n\n      if (autoplayButton && autoplayText !== autoplayTextTem) {\n        var i = autoplay ? 1 : 0,\n            html = autoplayButton.innerHTML,\n            len = html.length - autoplayTextTem[i].length;\n        if (html.substring(len) === autoplayTextTem[i]) {\n          autoplayButton.innerHTML = html.substring(0, len) + autoplayText[i];\n        }\n      }\n    } else {\n      if (center && (fixedWidth || autoWidth)) { needContainerTransform = true; }\n    }\n\n    if (itemsChanged || fixedWidth && !autoWidth) {\n      pages = getPages();\n      updateNavVisibility();\n    }\n\n    indChanged = index !== indexTem;\n    if (indChanged) {\n      events.emit('indexChanged', info());\n      needContainerTransform = true;\n    } else if (itemsChanged) {\n      if (!indChanged) { additionalUpdates(); }\n    } else if (fixedWidth || autoWidth) {\n      doLazyLoad();\n      updateSlideStatus();\n      updateLiveRegion();\n    }\n\n    if (itemsChanged && !carousel) { updateGallerySlidePositions(); }\n\n    if (!disable && !freeze) {\n      // non-mediaqueries: IE8\n      if (bpChanged && !CSSMQ) {\n        // middle wrapper styles\n\n        // inner wrapper styles\n        if (edgePadding !== edgePaddingTem || gutter !== gutterTem) {\n          innerWrapper.style.cssText = getInnerWrapperStyles(edgePadding, gutter, fixedWidth, speed, autoHeight);\n        }\n\n        if (horizontal) {\n          // container styles\n          if (carousel) {\n            container.style.width = getContainerWidth(fixedWidth, gutter, items);\n          }\n\n          // slide styles\n          var str = getSlideWidthStyle(fixedWidth, gutter, items) +\n                    getSlideGutterStyle(gutter);\n\n          // remove the last line and\n          // add new styles\n          removeCSSRule(sheet, getCssRulesLength(sheet) - 1);\n          addCSSRule(sheet, '#' + slideId + ' > .tns-item', str, getCssRulesLength(sheet));\n        }\n      }\n\n      // auto height\n      if (autoHeight) { doAutoHeight(); }\n\n      if (needContainerTransform) {\n        doContainerTransformSilent();\n        indexCached = index;\n      }\n    }\n\n    if (bpChanged) { events.emit('newBreakpointEnd', info(e)); }\n  }\n\n\n\n\n\n  // === INITIALIZATION FUNCTIONS === //\n  function getFreeze () {\n    if (!fixedWidth && !autoWidth) {\n      var a = center ? items - (items - 1) / 2 : items;\n      return  slideCount <= a;\n    }\n\n    var width = fixedWidth ? (fixedWidth + gutter) * slideCount : slidePositions[slideCount],\n        vp = edgePadding ? viewport + edgePadding * 2 : viewport + gutter;\n\n    if (center) {\n      vp -= fixedWidth ? (viewport - fixedWidth) / 2 : (viewport - (slidePositions[index + 1] - slidePositions[index] - gutter)) / 2;\n    }\n\n    return width <= vp;\n  }\n\n  function setBreakpointZone () {\n    breakpointZone = 0;\n    for (var bp in responsive) {\n      bp = parseInt(bp); // convert string to number\n      if (windowWidth >= bp) { breakpointZone = bp; }\n    }\n  }\n\n  // (slideBy, indexMin, indexMax) => index\n  var updateIndex = (function () {\n    return loop ?\n      carousel ?\n        // loop + carousel\n        function () {\n          var leftEdge = indexMin,\n              rightEdge = indexMax;\n\n          leftEdge += slideBy;\n          rightEdge -= slideBy;\n\n          // adjust edges when has edge paddings\n          // or fixed-width slider with extra space on the right side\n          if (edgePadding) {\n            leftEdge += 1;\n            rightEdge -= 1;\n          } else if (fixedWidth) {\n            if ((viewport + gutter)%(fixedWidth + gutter)) { rightEdge -= 1; }\n          }\n\n          if (cloneCount) {\n            if (index > rightEdge) {\n              index -= slideCount;\n            } else if (index < leftEdge) {\n              index += slideCount;\n            }\n          }\n        } :\n        // loop + gallery\n        function() {\n          if (index > indexMax) {\n            while (index >= indexMin + slideCount) { index -= slideCount; }\n          } else if (index < indexMin) {\n            while (index <= indexMax - slideCount) { index += slideCount; }\n          }\n        } :\n      // non-loop\n      function() {\n        index = Math.max(indexMin, Math.min(indexMax, index));\n      };\n  })();\n\n  function disableUI () {\n    if (!autoplay && autoplayButton) { hideElement(autoplayButton); }\n    if (!nav && navContainer) { hideElement(navContainer); }\n    if (!controls) {\n      if (controlsContainer) {\n        hideElement(controlsContainer);\n      } else {\n        if (prevButton) { hideElement(prevButton); }\n        if (nextButton) { hideElement(nextButton); }\n      }\n    }\n  }\n\n  function enableUI () {\n    if (autoplay && autoplayButton) { showElement(autoplayButton); }\n    if (nav && navContainer) { showElement(navContainer); }\n    if (controls) {\n      if (controlsContainer) {\n        showElement(controlsContainer);\n      } else {\n        if (prevButton) { showElement(prevButton); }\n        if (nextButton) { showElement(nextButton); }\n      }\n    }\n  }\n\n  function freezeSlider () {\n    if (frozen) { return; }\n\n    // remove edge padding from inner wrapper\n    if (edgePadding) { innerWrapper.style.margin = '0px'; }\n\n    // add class tns-transparent to cloned slides\n    if (cloneCount) {\n      var str = 'tns-transparent';\n      for (var i = cloneCount; i--;) {\n        if (carousel) { addClass(slideItems[i], str); }\n        addClass(slideItems[slideCountNew - i - 1], str);\n      }\n    }\n\n    // update tools\n    disableUI();\n\n    frozen = true;\n  }\n\n  function unfreezeSlider () {\n    if (!frozen) { return; }\n\n    // restore edge padding for inner wrapper\n    // for mordern browsers\n    if (edgePadding && CSSMQ) { innerWrapper.style.margin = ''; }\n\n    // remove class tns-transparent to cloned slides\n    if (cloneCount) {\n      var str = 'tns-transparent';\n      for (var i = cloneCount; i--;) {\n        if (carousel) { removeClass(slideItems[i], str); }\n        removeClass(slideItems[slideCountNew - i - 1], str);\n      }\n    }\n\n    // update tools\n    enableUI();\n\n    frozen = false;\n  }\n\n  function disableSlider () {\n    if (disabled) { return; }\n\n    sheet.disabled = true;\n    container.className = container.className.replace(newContainerClasses.substring(1), '');\n    removeAttrs(container, ['style']);\n    if (loop) {\n      for (var j = cloneCount; j--;) {\n        if (carousel) { hideElement(slideItems[j]); }\n        hideElement(slideItems[slideCountNew - j - 1]);\n      }\n    }\n\n    // vertical slider\n    if (!horizontal || !carousel) { removeAttrs(innerWrapper, ['style']); }\n\n    // gallery\n    if (!carousel) {\n      for (var i = index, l = index + slideCount; i < l; i++) {\n        var item = slideItems[i];\n        removeAttrs(item, ['style']);\n        removeClass(item, animateIn);\n        removeClass(item, animateNormal);\n      }\n    }\n\n    // update tools\n    disableUI();\n\n    disabled = true;\n  }\n\n  function enableSlider () {\n    if (!disabled) { return; }\n\n    sheet.disabled = false;\n    container.className += newContainerClasses;\n    doContainerTransformSilent();\n\n    if (loop) {\n      for (var j = cloneCount; j--;) {\n        if (carousel) { showElement(slideItems[j]); }\n        showElement(slideItems[slideCountNew - j - 1]);\n      }\n    }\n\n    // gallery\n    if (!carousel) {\n      for (var i = index, l = index + slideCount; i < l; i++) {\n        var item = slideItems[i],\n            classN = i < index + items ? animateIn : animateNormal;\n        item.style.left = (i - index) * 100 / items + '%';\n        addClass(item, classN);\n      }\n    }\n\n    // update tools\n    enableUI();\n\n    disabled = false;\n  }\n\n  function updateLiveRegion () {\n    var str = getLiveRegionStr();\n    if (liveregionCurrent.innerHTML !== str) { liveregionCurrent.innerHTML = str; }\n  }\n\n  function getLiveRegionStr () {\n    var arr = getVisibleSlideRange(),\n        start = arr[0] + 1,\n        end = arr[1] + 1;\n    return start === end ? start + '' : start + ' to ' + end;\n  }\n\n  function getVisibleSlideRange (val) {\n    if (val == null) { val = getContainerTransformValue(); }\n    var start = index, end, rangestart, rangeend;\n\n    // get range start, range end for autoWidth and fixedWidth\n    if (center || edgePadding) {\n      if (autoWidth || fixedWidth) {\n        rangestart = - (parseFloat(val) + edgePadding);\n        rangeend = rangestart + viewport + edgePadding * 2;\n      }\n    } else {\n      if (autoWidth) {\n        rangestart = slidePositions[index];\n        rangeend = rangestart + viewport;\n      }\n    }\n\n    // get start, end\n    // - check auto width\n    if (autoWidth) {\n      slidePositions.forEach(function(point, i) {\n        if (i < slideCountNew) {\n          if ((center || edgePadding) && point <= rangestart + 0.5) { start = i; }\n          if (rangeend - point >= 0.5) { end = i; }\n        }\n      });\n\n    // - check percentage width, fixed width\n    } else {\n\n      if (fixedWidth) {\n        var cell = fixedWidth + gutter;\n        if (center || edgePadding) {\n          start = Math.floor(rangestart/cell);\n          end = Math.ceil(rangeend/cell - 1);\n        } else {\n          end = start + Math.ceil(viewport/cell) - 1;\n        }\n\n      } else {\n        if (center || edgePadding) {\n          var a = items - 1;\n          if (center) {\n            start -= a / 2;\n            end = index + a / 2;\n          } else {\n            end = index + a;\n          }\n\n          if (edgePadding) {\n            var b = edgePadding * items / viewport;\n            start -= b;\n            end += b;\n          }\n\n          start = Math.floor(start);\n          end = Math.ceil(end);\n        } else {\n          end = start + items - 1;\n        }\n      }\n\n      start = Math.max(start, 0);\n      end = Math.min(end, slideCountNew - 1);\n    }\n\n    return [start, end];\n  }\n\n  function doLazyLoad () {\n    if (lazyload && !disable) {\n      var arg = getVisibleSlideRange();\n      arg.push(lazyloadSelector);\n\n      getImageArray.apply(null, arg).forEach(function (img) {\n        if (!hasClass(img, imgCompleteClass)) {\n          // stop propagation transitionend event to container\n          var eve = {};\n          eve[TRANSITIONEND] = function (e) { e.stopPropagation(); };\n          addEvents(img, eve);\n\n          addEvents(img, imgEvents);\n\n          // update src\n          img.src = getAttr(img, 'data-src');\n\n          // update srcset\n          var srcset = getAttr(img, 'data-srcset');\n          if (srcset) { img.srcset = srcset; }\n\n          addClass(img, 'loading');\n        }\n      });\n    }\n  }\n\n  function onImgLoaded (e) {\n    imgLoaded(getTarget(e));\n  }\n\n  function onImgFailed (e) {\n    imgFailed(getTarget(e));\n  }\n\n  function imgLoaded (img) {\n    addClass(img, 'loaded');\n    imgCompleted(img);\n  }\n\n  function imgFailed (img) {\n    addClass(img, 'failed');\n    imgCompleted(img);\n  }\n\n  function imgCompleted (img) {\n    addClass(img, imgCompleteClass);\n    removeClass(img, 'loading');\n    removeEvents(img, imgEvents);\n  }\n\n  function getImageArray (start, end, imgSelector) {\n    var imgs = [];\n    if (!imgSelector) { imgSelector = 'img'; }\n\n    while (start <= end) {\n      forEach(slideItems[start].querySelectorAll(imgSelector), function (img) { imgs.push(img); });\n      start++;\n    }\n\n    return imgs;\n  }\n\n  // check if all visible images are loaded\n  // and update container height if it's done\n  function doAutoHeight () {\n    var imgs = getImageArray.apply(null, getVisibleSlideRange());\n    raf(function(){ imgsLoadedCheck(imgs, updateInnerWrapperHeight); });\n  }\n\n  function imgsLoadedCheck (imgs, cb) {\n    // execute callback function if all images are complete\n    if (imgsComplete) { return cb(); }\n\n    // check image classes\n    imgs.forEach(function (img, index) {\n      if (!lazyload && img.complete) { imgCompleted(img); } // Check image.complete\n      if (hasClass(img, imgCompleteClass)) { imgs.splice(index, 1); }\n    });\n\n    // execute callback function if selected images are all complete\n    if (!imgs.length) { return cb(); }\n\n    // otherwise execute this functiona again\n    raf(function(){ imgsLoadedCheck(imgs, cb); });\n  }\n\n  function additionalUpdates () {\n    doLazyLoad();\n    updateSlideStatus();\n    updateLiveRegion();\n    updateControlsStatus();\n    updateNavStatus();\n  }\n\n\n  function update_carousel_transition_duration () {\n    if (carousel && autoHeight) {\n      middleWrapper.style[TRANSITIONDURATION] = speed / 1000 + 's';\n    }\n  }\n\n  function getMaxSlideHeight (slideStart, slideRange) {\n    var heights = [];\n    for (var i = slideStart, l = Math.min(slideStart + slideRange, slideCountNew); i < l; i++) {\n      heights.push(slideItems[i].offsetHeight);\n    }\n\n    return Math.max.apply(null, heights);\n  }\n\n  // update inner wrapper height\n  // 1. get the max-height of the visible slides\n  // 2. set transitionDuration to speed\n  // 3. update inner wrapper height to max-height\n  // 4. set transitionDuration to 0s after transition done\n  function updateInnerWrapperHeight () {\n    var maxHeight = autoHeight ? getMaxSlideHeight(index, items) : getMaxSlideHeight(cloneCount, slideCount),\n        wp = middleWrapper ? middleWrapper : innerWrapper;\n\n    if (wp.style.height !== maxHeight) { wp.style.height = maxHeight + 'px'; }\n  }\n\n  // get the distance from the top edge of the first slide to each slide\n  // (init) => slidePositions\n  function setSlidePositions () {\n    slidePositions = [0];\n    var attr = horizontal ? 'left' : 'top',\n        attr2 = horizontal ? 'right' : 'bottom',\n        base = slideItems[0].getBoundingClientRect()[attr];\n\n    forEach(slideItems, function(item, i) {\n      // skip the first slide\n      if (i) { slidePositions.push(item.getBoundingClientRect()[attr] - base); }\n      // add the end edge\n      if (i === slideCountNew - 1) { slidePositions.push(item.getBoundingClientRect()[attr2] - base); }\n    });\n  }\n\n  // update slide\n  function updateSlideStatus () {\n    var range = getVisibleSlideRange(),\n        start = range[0],\n        end = range[1];\n\n    forEach(slideItems, function(item, i) {\n      // show slides\n      if (i >= start && i <= end) {\n        if (hasAttr(item, 'aria-hidden')) {\n          removeAttrs(item, ['aria-hidden', 'tabindex']);\n          addClass(item, slideActiveClass);\n        }\n      // hide slides\n      } else {\n        if (!hasAttr(item, 'aria-hidden')) {\n          setAttrs(item, {\n            'aria-hidden': 'true',\n            'tabindex': '-1'\n          });\n          removeClass(item, slideActiveClass);\n        }\n      }\n    });\n  }\n\n  // gallery: update slide position\n  function updateGallerySlidePositions () {\n    var l = index + Math.min(slideCount, items);\n    for (var i = slideCountNew; i--;) {\n      var item = slideItems[i];\n\n      if (i >= index && i < l) {\n        // add transitions to visible slides when adjusting their positions\n        addClass(item, 'tns-moving');\n\n        item.style.left = (i - index) * 100 / items + '%';\n        addClass(item, animateIn);\n        removeClass(item, animateNormal);\n      } else if (item.style.left) {\n        item.style.left = '';\n        addClass(item, animateNormal);\n        removeClass(item, animateIn);\n      }\n\n      // remove outlet animation\n      removeClass(item, animateOut);\n    }\n\n    // removing '.tns-moving'\n    setTimeout(function() {\n      forEach(slideItems, function(el) {\n        removeClass(el, 'tns-moving');\n      });\n    }, 300);\n  }\n\n  // set tabindex on Nav\n  function updateNavStatus () {\n    // get current nav\n    if (nav) {\n      navCurrentIndex = navClicked >= 0 ? navClicked : getCurrentNavIndex();\n      navClicked = -1;\n\n      if (navCurrentIndex !== navCurrentIndexCached) {\n        var navPrev = navItems[navCurrentIndexCached],\n            navCurrent = navItems[navCurrentIndex];\n\n        setAttrs(navPrev, {\n          'tabindex': '-1',\n          'aria-label': navStr + (navCurrentIndexCached + 1)\n        });\n        removeClass(navPrev, navActiveClass);\n\n        setAttrs(navCurrent, {'aria-label': navStr + (navCurrentIndex + 1) + navStrCurrent});\n        removeAttrs(navCurrent, 'tabindex');\n        addClass(navCurrent, navActiveClass);\n\n        navCurrentIndexCached = navCurrentIndex;\n      }\n    }\n  }\n\n  function getLowerCaseNodeName (el) {\n    return el.nodeName.toLowerCase();\n  }\n\n  function isButton (el) {\n    return getLowerCaseNodeName(el) === 'button';\n  }\n\n  function isAriaDisabled (el) {\n    return el.getAttribute('aria-disabled') === 'true';\n  }\n\n  function disEnableElement (isButton, el, val) {\n    if (isButton) {\n      el.disabled = val;\n    } else {\n      el.setAttribute('aria-disabled', val.toString());\n    }\n  }\n\n  // set 'disabled' to true on controls when reach the edges\n  function updateControlsStatus () {\n    if (!controls || rewind || loop) { return; }\n\n    var prevDisabled = (prevIsButton) ? prevButton.disabled : isAriaDisabled(prevButton),\n        nextDisabled = (nextIsButton) ? nextButton.disabled : isAriaDisabled(nextButton),\n        disablePrev = (index <= indexMin) ? true : false,\n        disableNext = (!rewind && index >= indexMax) ? true : false;\n\n    if (disablePrev && !prevDisabled) {\n      disEnableElement(prevIsButton, prevButton, true);\n    }\n    if (!disablePrev && prevDisabled) {\n      disEnableElement(prevIsButton, prevButton, false);\n    }\n    if (disableNext && !nextDisabled) {\n      disEnableElement(nextIsButton, nextButton, true);\n    }\n    if (!disableNext && nextDisabled) {\n      disEnableElement(nextIsButton, nextButton, false);\n    }\n  }\n\n  // set duration\n  function resetDuration (el, str) {\n    if (TRANSITIONDURATION) { el.style[TRANSITIONDURATION] = str; }\n  }\n\n  function getSliderWidth () {\n    return fixedWidth ? (fixedWidth + gutter) * slideCountNew : slidePositions[slideCountNew];\n  }\n\n  function getCenterGap (num) {\n    if (num == null) { num = index; }\n\n    var gap = edgePadding ? gutter : 0;\n    return autoWidth ? ((viewport - gap) - (slidePositions[num + 1] - slidePositions[num] - gutter))/2 :\n      fixedWidth ? (viewport - fixedWidth) / 2 :\n        (items - 1) / 2;\n  }\n\n  function getRightBoundary () {\n    var gap = edgePadding ? gutter : 0,\n        result = (viewport + gap) - getSliderWidth();\n\n    if (center && !loop) {\n      result = fixedWidth ? - (fixedWidth + gutter) * (slideCountNew - 1) - getCenterGap() :\n        getCenterGap(slideCountNew - 1) - slidePositions[slideCountNew - 1];\n    }\n    if (result > 0) { result = 0; }\n\n    return result;\n  }\n\n  function getContainerTransformValue (num) {\n    if (num == null) { num = index; }\n\n    var val;\n    if (horizontal && !autoWidth) {\n      if (fixedWidth) {\n        val = - (fixedWidth + gutter) * num;\n        if (center) { val += getCenterGap(); }\n      } else {\n        var denominator = TRANSFORM ? slideCountNew : items;\n        if (center) { num -= getCenterGap(); }\n        val = - num * 100 / denominator;\n      }\n    } else {\n      val = - slidePositions[num];\n      if (center && autoWidth) {\n        val += getCenterGap();\n      }\n    }\n\n    if (hasRightDeadZone) { val = Math.max(val, rightBoundary); }\n\n    val += (horizontal && !autoWidth && !fixedWidth) ? '%' : 'px';\n\n    return val;\n  }\n\n  function doContainerTransformSilent (val) {\n    resetDuration(container, '0s');\n    doContainerTransform(val);\n  }\n\n  function doContainerTransform (val) {\n    if (val == null) { val = getContainerTransformValue(); }\n    container.style[transformAttr] = transformPrefix + val + transformPostfix;\n  }\n\n  function animateSlide (number, classOut, classIn, isOut) {\n    var l = number + items;\n    if (!loop) { l = Math.min(l, slideCountNew); }\n\n    for (var i = number; i < l; i++) {\n        var item = slideItems[i];\n\n      // set item positions\n      if (!isOut) { item.style.left = (i - index) * 100 / items + '%'; }\n\n      if (animateDelay && TRANSITIONDELAY) {\n        item.style[TRANSITIONDELAY] = item.style[ANIMATIONDELAY] = animateDelay * (i - number) / 1000 + 's';\n      }\n      removeClass(item, classOut);\n      addClass(item, classIn);\n\n      if (isOut) { slideItemsOut.push(item); }\n    }\n  }\n\n  // make transfer after click/drag:\n  // 1. change 'transform' property for mordern browsers\n  // 2. change 'left' property for legacy browsers\n  var transformCore = (function () {\n    return carousel ?\n      function () {\n        resetDuration(container, '');\n        if (TRANSITIONDURATION || !speed) {\n          // for morden browsers with non-zero duration or\n          // zero duration for all browsers\n          doContainerTransform();\n          // run fallback function manually\n          // when duration is 0 / container is hidden\n          if (!speed || !isVisible(container)) { onTransitionEnd(); }\n\n        } else {\n          // for old browser with non-zero duration\n          jsTransform(container, transformAttr, transformPrefix, transformPostfix, getContainerTransformValue(), speed, onTransitionEnd);\n        }\n\n        if (!horizontal) { updateContentWrapperHeight(); }\n      } :\n      function () {\n        slideItemsOut = [];\n\n        var eve = {};\n        eve[TRANSITIONEND] = eve[ANIMATIONEND] = onTransitionEnd;\n        removeEvents(slideItems[indexCached], eve);\n        addEvents(slideItems[index], eve);\n\n        animateSlide(indexCached, animateIn, animateOut, true);\n        animateSlide(index, animateNormal, animateIn);\n\n        // run fallback function manually\n        // when transition or animation not supported / duration is 0\n        if (!TRANSITIONEND || !ANIMATIONEND || !speed || !isVisible(container)) { onTransitionEnd(); }\n      };\n  })();\n\n  function render (e, sliderMoved) {\n    if (updateIndexBeforeTransform) { updateIndex(); }\n\n    // render when slider was moved (touch or drag) even though index may not change\n    if (index !== indexCached || sliderMoved) {\n      // events\n      events.emit('indexChanged', info());\n      events.emit('transitionStart', info());\n      if (autoHeight) { doAutoHeight(); }\n\n      // pause autoplay when click or keydown from user\n      if (animating && e && ['click', 'keydown'].indexOf(e.type) >= 0) { stopAutoplay(); }\n\n      running = true;\n      transformCore();\n    }\n  }\n\n  /*\n   * Transfer prefixed properties to the same format\n   * CSS: -Webkit-Transform => webkittransform\n   * JS: WebkitTransform => webkittransform\n   * @param {string} str - property\n   *\n   */\n  function strTrans (str) {\n    return str.toLowerCase().replace(/-/g, '');\n  }\n\n  // AFTER TRANSFORM\n  // Things need to be done after a transfer:\n  // 1. check index\n  // 2. add classes to visible slide\n  // 3. disable controls buttons when reach the first/last slide in non-loop slider\n  // 4. update nav status\n  // 5. lazyload images\n  // 6. update container height\n  function onTransitionEnd (event) {\n    // check running on gallery mode\n    // make sure trantionend/animationend events run only once\n    if (carousel || running) {\n      events.emit('transitionEnd', info(event));\n\n      if (!carousel && slideItemsOut.length > 0) {\n        for (var i = 0; i < slideItemsOut.length; i++) {\n          var item = slideItemsOut[i];\n          // set item positions\n          item.style.left = '';\n\n          if (ANIMATIONDELAY && TRANSITIONDELAY) {\n            item.style[ANIMATIONDELAY] = '';\n            item.style[TRANSITIONDELAY] = '';\n          }\n          removeClass(item, animateOut);\n          addClass(item, animateNormal);\n        }\n      }\n\n      /* update slides, nav, controls after checking ...\n       * => legacy browsers who don't support 'event'\n       *    have to check event first, otherwise event.target will cause an error\n       * => or 'gallery' mode:\n       *   + event target is slide item\n       * => or 'carousel' mode:\n       *   + event target is container,\n       *   + event.property is the same with transform attribute\n       */\n      if (!event ||\n          !carousel && event.target.parentNode === container ||\n          event.target === container && strTrans(event.propertyName) === strTrans(transformAttr)) {\n\n        if (!updateIndexBeforeTransform) {\n          var indexTem = index;\n          updateIndex();\n          if (index !== indexTem) {\n            events.emit('indexChanged', info());\n\n            doContainerTransformSilent();\n          }\n        }\n\n        if (nested === 'inner') { events.emit('innerLoaded', info()); }\n        running = false;\n        indexCached = index;\n      }\n    }\n\n  }\n\n  // # ACTIONS\n  function goTo (targetIndex, e) {\n    if (freeze) { return; }\n\n    // prev slideBy\n    if (targetIndex === 'prev') {\n      onControlsClick(e, -1);\n\n    // next slideBy\n    } else if (targetIndex === 'next') {\n      onControlsClick(e, 1);\n\n    // go to exact slide\n    } else {\n      if (running) {\n        if (preventActionWhenRunning) { return; } else { onTransitionEnd(); }\n      }\n\n      var absIndex = getAbsIndex(),\n          indexGap = 0;\n\n      if (targetIndex === 'first') {\n        indexGap = - absIndex;\n      } else if (targetIndex === 'last') {\n        indexGap = carousel ? slideCount - items - absIndex : slideCount - 1 - absIndex;\n      } else {\n        if (typeof targetIndex !== 'number') { targetIndex = parseInt(targetIndex); }\n\n        if (!isNaN(targetIndex)) {\n          // from directly called goTo function\n          if (!e) { targetIndex = Math.max(0, Math.min(slideCount - 1, targetIndex)); }\n\n          indexGap = targetIndex - absIndex;\n        }\n      }\n\n      // gallery: make sure new page won't overlap with current page\n      if (!carousel && indexGap && Math.abs(indexGap) < items) {\n        var factor = indexGap > 0 ? 1 : -1;\n        indexGap += (index + indexGap - slideCount) >= indexMin ? slideCount * factor : slideCount * 2 * factor * -1;\n      }\n\n      index += indexGap;\n\n      // make sure index is in range\n      if (carousel && loop) {\n        if (index < indexMin) { index += slideCount; }\n        if (index > indexMax) { index -= slideCount; }\n      }\n\n      // if index is changed, start rendering\n      if (getAbsIndex(index) !== getAbsIndex(indexCached)) {\n        render(e);\n      }\n\n    }\n  }\n\n  // on controls click\n  function onControlsClick (e, dir) {\n    if (running) {\n      if (preventActionWhenRunning) { return; } else { onTransitionEnd(); }\n    }\n    var passEventObject;\n\n    if (!dir) {\n      e = getEvent(e);\n      var target = getTarget(e);\n\n      while (target !== controlsContainer && [prevButton, nextButton].indexOf(target) < 0) { target = target.parentNode; }\n\n      var targetIn = [prevButton, nextButton].indexOf(target);\n      if (targetIn >= 0) {\n        passEventObject = true;\n        dir = targetIn === 0 ? -1 : 1;\n      }\n    }\n\n    if (rewind) {\n      if (index === indexMin && dir === -1) {\n        goTo('last', e);\n        return;\n      } else if (index === indexMax && dir === 1) {\n        goTo('first', e);\n        return;\n      }\n    }\n\n    if (dir) {\n      index += slideBy * dir;\n      if (autoWidth) { index = Math.floor(index); }\n      // pass e when click control buttons or keydown\n      render((passEventObject || (e && e.type === 'keydown')) ? e : null);\n    }\n  }\n\n  // on nav click\n  function onNavClick (e) {\n    if (running) {\n      if (preventActionWhenRunning) { return; } else { onTransitionEnd(); }\n    }\n\n    e = getEvent(e);\n    var target = getTarget(e), navIndex;\n\n    // find the clicked nav item\n    while (target !== navContainer && !hasAttr(target, 'data-nav')) { target = target.parentNode; }\n    if (hasAttr(target, 'data-nav')) {\n      var navIndex = navClicked = Number(getAttr(target, 'data-nav')),\n          targetIndexBase = fixedWidth || autoWidth ? navIndex * slideCount / pages : navIndex * items,\n          targetIndex = navAsThumbnails ? navIndex : Math.min(Math.ceil(targetIndexBase), slideCount - 1);\n      goTo(targetIndex, e);\n\n      if (navCurrentIndex === navIndex) {\n        if (animating) { stopAutoplay(); }\n        navClicked = -1; // reset navClicked\n      }\n    }\n  }\n\n  // autoplay functions\n  function setAutoplayTimer () {\n    autoplayTimer = setInterval(function () {\n      onControlsClick(null, autoplayDirection);\n    }, autoplayTimeout);\n\n    animating = true;\n  }\n\n  function stopAutoplayTimer () {\n    clearInterval(autoplayTimer);\n    animating = false;\n  }\n\n  function updateAutoplayButton (action, txt) {\n    setAttrs(autoplayButton, {'data-action': action});\n    autoplayButton.innerHTML = autoplayHtmlStrings[0] + action + autoplayHtmlStrings[1] + txt;\n  }\n\n  function startAutoplay () {\n    setAutoplayTimer();\n    if (autoplayButton) { updateAutoplayButton('stop', autoplayText[1]); }\n  }\n\n  function stopAutoplay () {\n    stopAutoplayTimer();\n    if (autoplayButton) { updateAutoplayButton('start', autoplayText[0]); }\n  }\n\n  // programaitcally play/pause the slider\n  function play () {\n    if (autoplay && !animating) {\n      startAutoplay();\n      autoplayUserPaused = false;\n    }\n  }\n  function pause () {\n    if (animating) {\n      stopAutoplay();\n      autoplayUserPaused = true;\n    }\n  }\n\n  function toggleAutoplay () {\n    if (animating) {\n      stopAutoplay();\n      autoplayUserPaused = true;\n    } else {\n      startAutoplay();\n      autoplayUserPaused = false;\n    }\n  }\n\n  function onVisibilityChange () {\n    if (doc.hidden) {\n      if (animating) {\n        stopAutoplayTimer();\n        autoplayVisibilityPaused = true;\n      }\n    } else if (autoplayVisibilityPaused) {\n      setAutoplayTimer();\n      autoplayVisibilityPaused = false;\n    }\n  }\n\n  function mouseoverPause () {\n    if (animating) {\n      stopAutoplayTimer();\n      autoplayHoverPaused = true;\n    }\n  }\n\n  function mouseoutRestart () {\n    if (autoplayHoverPaused) {\n      setAutoplayTimer();\n      autoplayHoverPaused = false;\n    }\n  }\n\n  // keydown events on document\n  function onDocumentKeydown (e) {\n    e = getEvent(e);\n    var keyIndex = [KEYS.LEFT, KEYS.RIGHT].indexOf(e.keyCode);\n\n    if (keyIndex >= 0) {\n      onControlsClick(e, keyIndex === 0 ? -1 : 1);\n    }\n  }\n\n  // on key control\n  function onControlsKeydown (e) {\n    e = getEvent(e);\n    var keyIndex = [KEYS.LEFT, KEYS.RIGHT].indexOf(e.keyCode);\n\n    if (keyIndex >= 0) {\n      if (keyIndex === 0) {\n        if (!prevButton.disabled) { onControlsClick(e, -1); }\n      } else if (!nextButton.disabled) {\n        onControlsClick(e, 1);\n      }\n    }\n  }\n\n  // set focus\n  function setFocus (el) {\n    el.focus();\n  }\n\n  // on key nav\n  function onNavKeydown (e) {\n    e = getEvent(e);\n    var curElement = doc.activeElement;\n    if (!hasAttr(curElement, 'data-nav')) { return; }\n\n    // var code = e.keyCode,\n    var keyIndex = [KEYS.LEFT, KEYS.RIGHT, KEYS.ENTER, KEYS.SPACE].indexOf(e.keyCode),\n        navIndex = Number(getAttr(curElement, 'data-nav'));\n\n    if (keyIndex >= 0) {\n      if (keyIndex === 0) {\n        if (navIndex > 0) { setFocus(navItems[navIndex - 1]); }\n      } else if (keyIndex === 1) {\n        if (navIndex < pages - 1) { setFocus(navItems[navIndex + 1]); }\n      } else {\n        navClicked = navIndex;\n        goTo(navIndex, e);\n      }\n    }\n  }\n\n  function getEvent (e) {\n    e = e || win.event;\n    return isTouchEvent(e) ? e.changedTouches[0] : e;\n  }\n  function getTarget (e) {\n    return e.target || win.event.srcElement;\n  }\n\n  function isTouchEvent (e) {\n    return e.type.indexOf('touch') >= 0;\n  }\n\n  function preventDefaultBehavior (e) {\n    e.preventDefault ? e.preventDefault() : e.returnValue = false;\n  }\n\n  function getMoveDirectionExpected () {\n    return getTouchDirection(toDegree(lastPosition.y - initPosition.y, lastPosition.x - initPosition.x), swipeAngle) === options.axis;\n  }\n\n  function onPanStart (e) {\n    if (running) {\n      if (preventActionWhenRunning) { return; } else { onTransitionEnd(); }\n    }\n\n    if (autoplay && animating) { stopAutoplayTimer(); }\n\n    panStart = true;\n    if (rafIndex) {\n      caf(rafIndex);\n      rafIndex = null;\n    }\n\n    var $ = getEvent(e);\n    events.emit(isTouchEvent(e) ? 'touchStart' : 'dragStart', info(e));\n\n    if (!isTouchEvent(e) && ['img', 'a'].indexOf(getLowerCaseNodeName(getTarget(e))) >= 0) {\n      preventDefaultBehavior(e);\n    }\n\n    lastPosition.x = initPosition.x = $.clientX;\n    lastPosition.y = initPosition.y = $.clientY;\n    if (carousel) {\n      translateInit = parseFloat(container.style[transformAttr].replace(transformPrefix, ''));\n      resetDuration(container, '0s');\n    }\n  }\n\n  function onPanMove (e) {\n    if (panStart) {\n      var $ = getEvent(e);\n      lastPosition.x = $.clientX;\n      lastPosition.y = $.clientY;\n\n      if (carousel) {\n        if (!rafIndex) { rafIndex = raf(function(){ panUpdate(e); }); }\n      } else {\n        if (moveDirectionExpected === '?') { moveDirectionExpected = getMoveDirectionExpected(); }\n        if (moveDirectionExpected) { preventScroll = true; }\n      }\n\n      if ((typeof e.cancelable !== 'boolean' || e.cancelable) && preventScroll) {\n        e.preventDefault();\n      }\n    }\n  }\n\n  function panUpdate (e) {\n    if (!moveDirectionExpected) {\n      panStart = false;\n      return;\n    }\n    caf(rafIndex);\n    if (panStart) { rafIndex = raf(function(){ panUpdate(e); }); }\n\n    if (moveDirectionExpected === '?') { moveDirectionExpected = getMoveDirectionExpected(); }\n    if (moveDirectionExpected) {\n      if (!preventScroll && isTouchEvent(e)) { preventScroll = true; }\n\n      try {\n        if (e.type) { events.emit(isTouchEvent(e) ? 'touchMove' : 'dragMove', info(e)); }\n      } catch(err) {}\n\n      var x = translateInit,\n          dist = getDist(lastPosition, initPosition);\n      if (!horizontal || fixedWidth || autoWidth) {\n        x += dist;\n        x += 'px';\n      } else {\n        var percentageX = TRANSFORM ? dist * items * 100 / ((viewport + gutter) * slideCountNew): dist * 100 / (viewport + gutter);\n        x += percentageX;\n        x += '%';\n      }\n\n      container.style[transformAttr] = transformPrefix + x + transformPostfix;\n    }\n  }\n\n  function onPanEnd (e) {\n    if (panStart) {\n      if (rafIndex) {\n        caf(rafIndex);\n        rafIndex = null;\n      }\n      if (carousel) { resetDuration(container, ''); }\n      panStart = false;\n\n      var $ = getEvent(e);\n      lastPosition.x = $.clientX;\n      lastPosition.y = $.clientY;\n      var dist = getDist(lastPosition, initPosition);\n\n      if (Math.abs(dist)) {\n        // drag vs click\n        if (!isTouchEvent(e)) {\n          // prevent \"click\"\n          var target = getTarget(e);\n          addEvents(target, {'click': function preventClick (e) {\n            preventDefaultBehavior(e);\n            removeEvents(target, {'click': preventClick});\n          }});\n        }\n\n        if (carousel) {\n          rafIndex = raf(function() {\n            if (horizontal && !autoWidth) {\n              var indexMoved = - dist * items / (viewport + gutter);\n              indexMoved = dist > 0 ? Math.floor(indexMoved) : Math.ceil(indexMoved);\n              index += indexMoved;\n            } else {\n              var moved = - (translateInit + dist);\n              if (moved <= 0) {\n                index = indexMin;\n              } else if (moved >= slidePositions[slideCountNew - 1]) {\n                index = indexMax;\n              } else {\n                var i = 0;\n                while (i < slideCountNew && moved >= slidePositions[i]) {\n                  index = i;\n                  if (moved > slidePositions[i] && dist < 0) { index += 1; }\n                  i++;\n                }\n              }\n            }\n\n            render(e, dist);\n            events.emit(isTouchEvent(e) ? 'touchEnd' : 'dragEnd', info(e));\n          });\n        } else {\n          if (moveDirectionExpected) {\n            onControlsClick(e, dist > 0 ? -1 : 1);\n          }\n        }\n      }\n    }\n\n    // reset\n    if (options.preventScrollOnTouch === 'auto') { preventScroll = false; }\n    if (swipeAngle) { moveDirectionExpected = '?'; }\n    if (autoplay && !animating) { setAutoplayTimer(); }\n  }\n\n  // === RESIZE FUNCTIONS === //\n  // (slidePositions, index, items) => vertical_conentWrapper.height\n  function updateContentWrapperHeight () {\n    var wp = middleWrapper ? middleWrapper : innerWrapper;\n    wp.style.height = slidePositions[index + items] - slidePositions[index] + 'px';\n  }\n\n  function getPages () {\n    var rough = fixedWidth ? (fixedWidth + gutter) * slideCount / viewport : slideCount / items;\n    return Math.min(Math.ceil(rough), slideCount);\n  }\n\n  /*\n   * 1. update visible nav items list\n   * 2. add \"hidden\" attributes to previous visible nav items\n   * 3. remove \"hidden\" attrubutes to new visible nav items\n   */\n  function updateNavVisibility () {\n    if (!nav || navAsThumbnails) { return; }\n\n    if (pages !== pagesCached) {\n      var min = pagesCached,\n          max = pages,\n          fn = showElement;\n\n      if (pagesCached > pages) {\n        min = pages;\n        max = pagesCached;\n        fn = hideElement;\n      }\n\n      while (min < max) {\n        fn(navItems[min]);\n        min++;\n      }\n\n      // cache pages\n      pagesCached = pages;\n    }\n  }\n\n  function info (e) {\n    return {\n      container: container,\n      slideItems: slideItems,\n      navContainer: navContainer,\n      navItems: navItems,\n      controlsContainer: controlsContainer,\n      hasControls: hasControls,\n      prevButton: prevButton,\n      nextButton: nextButton,\n      items: items,\n      slideBy: slideBy,\n      cloneCount: cloneCount,\n      slideCount: slideCount,\n      slideCountNew: slideCountNew,\n      index: index,\n      indexCached: indexCached,\n      displayIndex: getCurrentSlide(),\n      navCurrentIndex: navCurrentIndex,\n      navCurrentIndexCached: navCurrentIndexCached,\n      pages: pages,\n      pagesCached: pagesCached,\n      sheet: sheet,\n      isOn: isOn,\n      event: e || {},\n    };\n  }\n\n  return {\n    version: '2.9.3',\n    getInfo: info,\n    events: events,\n    goTo: goTo,\n    play: play,\n    pause: pause,\n    isOn: isOn,\n    updateSliderHeight: updateInnerWrapperHeight,\n    refresh: initSliderTransform,\n    destroy: destroy,\n    rebuild: function() {\n      return tns(extend(options, optionsElements));\n    }\n  };\n};\n\nreturn tns;\n})();"]},"metadata":{},"sourceType":"script"}